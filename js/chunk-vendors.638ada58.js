"use strict";(self["webpackChunktelem"]=self["webpackChunktelem"]||[]).push([[504],{953:function(t,e,i){i.d(e,{C4:function(){return v},EW:function(){return Tt},Gc:function(){return gt},IG:function(){return wt},KR:function(){return Lt},Kh:function(){return ft},Pr:function(){return Ft},R1:function(){return Pt},X2:function(){return c},bl:function(){return b},fE:function(){return At},g8:function(){return bt},hZ:function(){return I},i9:function(){return Mt},ju:function(){return _t},o5:function(){return l},u4:function(){return k},ux:function(){return Et},yC:function(){return a}});var n=i(33);
/**
* @vue/reactivity v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let s,r;class a{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=s,!t&&s&&(this.index=(s.scopes||(s.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const e=s;try{return s=this,t()}finally{s=e}}else 0}on(){s=this}off(){s=this.parent}stop(t){if(this._active){let e,i;for(e=0,i=this.effects.length;e<i;e++)this.effects[e].stop();for(e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.parent=void 0,this._active=!1}}}function o(t,e=s){e&&e.active&&e.effects.push(t)}function l(){return s}class c{constructor(t,e,i,n){this.fn=t,this.trigger=e,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,o(this,n)}get dirty(){if(2===this._dirtyLevel||3===this._dirtyLevel){this._dirtyLevel=1,v();for(let t=0;t<this._depsLength;t++){const e=this.deps[t];if(e.computed&&(h(e.computed),this._dirtyLevel>=4))break}1===this._dirtyLevel&&(this._dirtyLevel=0),b()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=f,e=r;try{return f=!0,r=this,this._runnings++,d(this),this.fn()}finally{u(this),this._runnings--,r=e,f=t}}stop(){this.active&&(d(this),u(this),this.onStop&&this.onStop(),this.active=!1)}}function h(t){return t.value}function d(t){t._trackId++,t._depsLength=0}function u(t){if(t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)p(t.deps[e],t);t.deps.length=t._depsLength}}function p(t,e){const i=t.get(e);void 0!==i&&e._trackId!==i&&(t.delete(e),0===t.size&&t.cleanup())}let f=!0,g=0;const m=[];function v(){m.push(f),f=!1}function b(){const t=m.pop();f=void 0===t||t}function y(){g++}function A(){g--;while(!g&&E.length)E.shift()()}function _(t,e,i){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const i=t.deps[t._depsLength];i!==e?(i&&p(i,t),t.deps[t._depsLength++]=e):t._depsLength++}}const E=[];function w(t,e,i){y();for(const n of t.keys()){let i;n._dirtyLevel<e&&(null!=i?i:i=t.get(n)===n._trackId)&&(n._shouldSchedule||(n._shouldSchedule=0===n._dirtyLevel),n._dirtyLevel=e),n._shouldSchedule&&(null!=i?i:i=t.get(n)===n._trackId)&&(n.trigger(),n._runnings&&!n.allowRecurse||2===n._dirtyLevel||(n._shouldSchedule=!1,n.scheduler&&E.push(n.scheduler)))}A()}const x=(t,e)=>{const i=new Map;return i.cleanup=t,i.computed=e,i},C=new WeakMap,S=Symbol(""),T=Symbol("");function k(t,e,i){if(f&&r){let e=C.get(t);e||C.set(t,e=new Map);let n=e.get(i);n||e.set(i,n=x((()=>e.delete(i)))),_(r,n,void 0)}}function I(t,e,i,s,r,a){const o=C.get(t);if(!o)return;let l=[];if("clear"===e)l=[...o.values()];else if("length"===i&&(0,n.cy)(t)){const t=Number(s);o.forEach(((e,i)=>{("length"===i||!(0,n.Bm)(i)&&i>=t)&&l.push(e)}))}else switch(void 0!==i&&l.push(o.get(i)),e){case"add":(0,n.cy)(t)?(0,n.yI)(i)&&l.push(o.get("length")):(l.push(o.get(S)),(0,n.CE)(t)&&l.push(o.get(T)));break;case"delete":(0,n.cy)(t)||(l.push(o.get(S)),(0,n.CE)(t)&&l.push(o.get(T)));break;case"set":(0,n.CE)(t)&&l.push(o.get(S));break}y();for(const n of l)n&&w(n,4,void 0);A()}const M=(0,n.pD)("__proto__,__v_isRef,__isVue"),L=new Set(Object.getOwnPropertyNames(Symbol).filter((t=>"arguments"!==t&&"caller"!==t)).map((t=>Symbol[t])).filter(n.Bm)),R=D();function D(){const t={};return["includes","indexOf","lastIndexOf"].forEach((e=>{t[e]=function(...t){const i=Et(this);for(let e=0,s=this.length;e<s;e++)k(i,"get",e+"");const n=i[e](...t);return-1===n||!1===n?i[e](...t.map(Et)):n}})),["push","pop","shift","unshift","splice"].forEach((e=>{t[e]=function(...t){v(),y();const i=Et(this)[e].apply(this,t);return A(),b(),i}})),t}function P(t){(0,n.Bm)(t)||(t=String(t));const e=Et(this);return k(e,"has",t),e.hasOwnProperty(t)}class O{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,i){const s=this._isReadonly,r=this._isShallow;if("__v_isReactive"===e)return!s;if("__v_isReadonly"===e)return s;if("__v_isShallow"===e)return r;if("__v_raw"===e)return i===(s?r?dt:ht:r?ct:lt).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const a=(0,n.cy)(t);if(!s){if(a&&(0,n.$3)(R,e))return Reflect.get(R,e,i);if("hasOwnProperty"===e)return P}const o=Reflect.get(t,e,i);return((0,n.Bm)(e)?L.has(e):M(e))?o:(s||k(t,"get",e),r?o:Mt(o)?a&&(0,n.yI)(e)?o:o.value:(0,n.Gv)(o)?s?mt(o):ft(o):o)}}class F extends O{constructor(t=!1){super(!1,t)}set(t,e,i,s){let r=t[e];if(!this._isShallow){const e=yt(r);if(At(i)||yt(i)||(r=Et(r),i=Et(i)),!(0,n.cy)(t)&&Mt(r)&&!Mt(i))return!e&&(r.value=i,!0)}const a=(0,n.cy)(t)&&(0,n.yI)(e)?Number(e)<t.length:(0,n.$3)(t,e),o=Reflect.set(t,e,i,s);return t===Et(s)&&(a?(0,n.$H)(i,r)&&I(t,"set",e,i,r):I(t,"add",e,i)),o}deleteProperty(t,e){const i=(0,n.$3)(t,e),s=t[e],r=Reflect.deleteProperty(t,e);return r&&i&&I(t,"delete",e,void 0,s),r}has(t,e){const i=Reflect.has(t,e);return(0,n.Bm)(e)&&L.has(e)||k(t,"has",e),i}ownKeys(t){return k(t,"iterate",(0,n.cy)(t)?"length":S),Reflect.ownKeys(t)}}class N extends O{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const B=new F,U=new N,j=new F(!0),H=t=>t,$=t=>Reflect.getPrototypeOf(t);function z(t,e,i=!1,s=!1){t=t["__v_raw"];const r=Et(t),a=Et(e);i||((0,n.$H)(e,a)&&k(r,"get",e),k(r,"get",a));const{has:o}=$(r),l=s?H:i?Ct:xt;return o.call(r,e)?l(t.get(e)):o.call(r,a)?l(t.get(a)):void(t!==r&&t.get(e))}function V(t,e=!1){const i=this["__v_raw"],s=Et(i),r=Et(t);return e||((0,n.$H)(t,r)&&k(s,"has",t),k(s,"has",r)),t===r?i.has(t):i.has(t)||i.has(r)}function G(t,e=!1){return t=t["__v_raw"],!e&&k(Et(t),"iterate",S),Reflect.get(t,"size",t)}function K(t){t=Et(t);const e=Et(this),i=$(e),n=i.has.call(e,t);return n||(e.add(t),I(e,"add",t,t)),this}function W(t,e){e=Et(e);const i=Et(this),{has:s,get:r}=$(i);let a=s.call(i,t);a||(t=Et(t),a=s.call(i,t));const o=r.call(i,t);return i.set(t,e),a?(0,n.$H)(e,o)&&I(i,"set",t,e,o):I(i,"add",t,e),this}function q(t){const e=Et(this),{has:i,get:n}=$(e);let s=i.call(e,t);s||(t=Et(t),s=i.call(e,t));const r=n?n.call(e,t):void 0,a=e.delete(t);return s&&I(e,"delete",t,void 0,r),a}function X(){const t=Et(this),e=0!==t.size,i=void 0,n=t.clear();return e&&I(t,"clear",void 0,void 0,i),n}function Y(t,e){return function(i,n){const s=this,r=s["__v_raw"],a=Et(r),o=e?H:t?Ct:xt;return!t&&k(a,"iterate",S),r.forEach(((t,e)=>i.call(n,o(t),o(e),s)))}}function Q(t,e,i){return function(...s){const r=this["__v_raw"],a=Et(r),o=(0,n.CE)(a),l="entries"===t||t===Symbol.iterator&&o,c="keys"===t&&o,h=r[t](...s),d=i?H:e?Ct:xt;return!e&&k(a,"iterate",c?T:S),{next(){const{value:t,done:e}=h.next();return e?{value:t,done:e}:{value:l?[d(t[0]),d(t[1])]:d(t),done:e}},[Symbol.iterator](){return this}}}}function J(t){return function(...e){return"delete"!==t&&("clear"===t?void 0:this)}}function Z(){const t={get(t){return z(this,t)},get size(){return G(this)},has:V,add:K,set:W,delete:q,clear:X,forEach:Y(!1,!1)},e={get(t){return z(this,t,!1,!0)},get size(){return G(this)},has:V,add:K,set:W,delete:q,clear:X,forEach:Y(!1,!0)},i={get(t){return z(this,t,!0)},get size(){return G(this,!0)},has(t){return V.call(this,t,!0)},add:J("add"),set:J("set"),delete:J("delete"),clear:J("clear"),forEach:Y(!0,!1)},n={get(t){return z(this,t,!0,!0)},get size(){return G(this,!0)},has(t){return V.call(this,t,!0)},add:J("add"),set:J("set"),delete:J("delete"),clear:J("clear"),forEach:Y(!0,!0)},s=["keys","values","entries",Symbol.iterator];return s.forEach((s=>{t[s]=Q(s,!1,!1),i[s]=Q(s,!0,!1),e[s]=Q(s,!1,!0),n[s]=Q(s,!0,!0)})),[t,i,e,n]}const[tt,et,it,nt]=Z();function st(t,e){const i=e?t?nt:it:t?et:tt;return(e,s,r)=>"__v_isReactive"===s?!t:"__v_isReadonly"===s?t:"__v_raw"===s?e:Reflect.get((0,n.$3)(i,s)&&s in e?i:e,s,r)}const rt={get:st(!1,!1)},at={get:st(!1,!0)},ot={get:st(!0,!1)};const lt=new WeakMap,ct=new WeakMap,ht=new WeakMap,dt=new WeakMap;function ut(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pt(t){return t["__v_skip"]||!Object.isExtensible(t)?0:ut((0,n.Zf)(t))}function ft(t){return yt(t)?t:vt(t,!1,B,rt,lt)}function gt(t){return vt(t,!1,j,at,ct)}function mt(t){return vt(t,!0,U,ot,ht)}function vt(t,e,i,s,r){if(!(0,n.Gv)(t))return t;if(t["__v_raw"]&&(!e||!t["__v_isReactive"]))return t;const a=r.get(t);if(a)return a;const o=pt(t);if(0===o)return t;const l=new Proxy(t,2===o?s:i);return r.set(t,l),l}function bt(t){return yt(t)?bt(t["__v_raw"]):!(!t||!t["__v_isReactive"])}function yt(t){return!(!t||!t["__v_isReadonly"])}function At(t){return!(!t||!t["__v_isShallow"])}function _t(t){return!!t&&!!t["__v_raw"]}function Et(t){const e=t&&t["__v_raw"];return e?Et(e):t}function wt(t){return Object.isExtensible(t)&&(0,n.yQ)(t,"__v_skip",!0),t}const xt=t=>(0,n.Gv)(t)?ft(t):t,Ct=t=>(0,n.Gv)(t)?mt(t):t;class St{constructor(t,e,i,n){this.getter=t,this._setter=e,this.dep=void 0,this.__v_isRef=!0,this["__v_isReadonly"]=!1,this.effect=new c((()=>t(this._value)),(()=>It(this,2===this.effect._dirtyLevel?2:3))),this.effect.computed=this,this.effect.active=this._cacheable=!n,this["__v_isReadonly"]=i}get value(){const t=Et(this);return t._cacheable&&!t.effect.dirty||!(0,n.$H)(t._value,t._value=t.effect.run())||It(t,4),kt(t),t.effect._dirtyLevel>=2&&It(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function Tt(t,e,i=!1){let s,r;const a=(0,n.Tn)(t);a?(s=t,r=n.tE):(s=t.get,r=t.set);const o=new St(s,r,a||!r,i);return o}function kt(t){var e;f&&r&&(t=Et(t),_(r,null!=(e=t.dep)?e:t.dep=x((()=>t.dep=void 0),t instanceof St?t:void 0),void 0))}function It(t,e=4,i){t=Et(t);const n=t.dep;n&&w(n,e,void 0)}function Mt(t){return!(!t||!0!==t.__v_isRef)}function Lt(t){return Rt(t,!1)}function Rt(t,e){return Mt(t)?t:new Dt(t,e)}class Dt{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:Et(t),this._value=e?t:xt(t)}get value(){return kt(this),this._value}set value(t){const e=this.__v_isShallow||At(t)||yt(t);t=e?t:Et(t),(0,n.$H)(t,this._rawValue)&&(this._rawValue=t,this._value=e?t:xt(t),It(this,4,t))}}function Pt(t){return Mt(t)?t.value:t}const Ot={get:(t,e,i)=>Pt(Reflect.get(t,e,i)),set:(t,e,i,n)=>{const s=t[e];return Mt(s)&&!Mt(i)?(s.value=i,!0):Reflect.set(t,e,i,n)}};function Ft(t){return bt(t)?t:new Proxy(t,Ot)}},641:function(t,e,i){i.d(e,{$u:function(){return Ot},CE:function(){return ri},Df:function(){return yt},EW:function(){return Ki},FK:function(){return qe},Fv:function(){return vi},Gt:function(){return ge},Gy:function(){return ct},K9:function(){return Ue},Lk:function(){return di},MZ:function(){return bt},OW:function(){return gt},Q3:function(){return bi},QP:function(){return dt},Qi:function(){return O},RG:function(){return zt},WQ:function(){return me},Wv:function(){return ai},bF:function(){return ui},bo:function(){return rt},dY:function(){return b},eW:function(){return mi},g2:function(){return G},h:function(){return Wi},jt:function(){return F},k6:function(){return N},nI:function(){return ki},pI:function(){return $t},pM:function(){return At},pR:function(){return pt},qL:function(){return a},uX:function(){return ti},wB:function(){return tt}});var n=i(953),s=i(33);function r(t,e,i,n){try{return n?t(...n):t()}catch(s){o(s,e,i)}}function a(t,e,i,n){if((0,s.Tn)(t)){const a=r(t,e,i,n);return a&&(0,s.yL)(a)&&a.catch((t=>{o(t,e,i)})),a}if((0,s.cy)(t)){const s=[];for(let r=0;r<t.length;r++)s.push(a(t[r],e,i,n));return s}}function o(t,e,i,s=!0){const a=e?e.vnode:null;if(e){let s=e.parent;const a=e.proxy,o=`https://vuejs.org/error-reference/#runtime-${i}`;while(s){const e=s.ec;if(e)for(let i=0;i<e.length;i++)if(!1===e[i](t,a,o))return;s=s.parent}const l=e.appContext.config.errorHandler;if(l)return(0,n.C4)(),r(l,null,10,[t,a,o]),void(0,n.bl)()}l(t,i,a,s)}function l(t,e,i,n=!0){console.error(t)}let c=!1,h=!1;const d=[];let u=0;const p=[];let f=null,g=0;const m=Promise.resolve();let v=null;function b(t){const e=v||m;return t?e.then(this?t.bind(this):t):e}function y(t){let e=u+1,i=d.length;while(e<i){const n=e+i>>>1,s=d[n],r=S(s);r<t||r===t&&s.pre?e=n+1:i=n}return e}function A(t){d.length&&d.includes(t,c&&t.allowRecurse?u+1:u)||(null==t.id?d.push(t):d.splice(y(t.id),0,t),_())}function _(){c||h||(h=!0,v=m.then(k))}function E(t){const e=d.indexOf(t);e>u&&d.splice(e,1)}function w(t){(0,s.cy)(t)?p.push(...t):f&&f.includes(t,t.allowRecurse?g+1:g)||p.push(t),_()}function x(t,e,i=(c?u+1:0)){for(0;i<d.length;i++){const e=d[i];if(e&&e.pre){if(t&&e.id!==t.uid)continue;0,d.splice(i,1),i--,e()}}}function C(t){if(p.length){const t=[...new Set(p)].sort(((t,e)=>S(t)-S(e)));if(p.length=0,f)return void f.push(...t);for(f=t,g=0;g<f.length;g++)f[g]();f=null,g=0}}const S=t=>null==t.id?1/0:t.id,T=(t,e)=>{const i=S(t)-S(e);if(0===i){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return i};function k(t){h=!1,c=!0,d.sort(T);s.tE;try{for(u=0;u<d.length;u++){const t=d[u];t&&!1!==t.active&&r(t,null,14)}}finally{u=0,d.length=0,C(t),c=!1,v=null,(d.length||p.length)&&k(t)}}function I(t,e,...i){if(t.isUnmounted)return;const n=t.vnode.props||s.MZ;let r=i;const o=e.startsWith("update:"),l=o&&e.slice(7);if(l&&l in n){const t=`${"modelValue"===l?"model":l}Modifiers`,{number:e,trim:a}=n[t]||s.MZ;a&&(r=i.map((t=>(0,s.Kg)(t)?t.trim():t))),e&&(r=i.map(s.bB))}let c;let h=n[c=(0,s.rU)(e)]||n[c=(0,s.rU)((0,s.PT)(e))];!h&&o&&(h=n[c=(0,s.rU)((0,s.Tg)(e))]),h&&a(h,t,6,r);const d=n[c+"Once"];if(d){if(t.emitted){if(t.emitted[c])return}else t.emitted={};t.emitted[c]=!0,a(d,t,6,r)}}function M(t,e,i=!1){const n=e.emitsCache,r=n.get(t);if(void 0!==r)return r;const a=t.emits;let o={},l=!1;if(!(0,s.Tn)(t)){const n=t=>{const i=M(t,e,!0);i&&(l=!0,(0,s.X$)(o,i))};!i&&e.mixins.length&&e.mixins.forEach(n),t.extends&&n(t.extends),t.mixins&&t.mixins.forEach(n)}return a||l?((0,s.cy)(a)?a.forEach((t=>o[t]=null)):(0,s.X$)(o,a),(0,s.Gv)(t)&&n.set(t,o),o):((0,s.Gv)(t)&&n.set(t,null),null)}function L(t,e){return!(!t||!(0,s.Mp)(e))&&(e=e.slice(2).replace(/Once$/,""),(0,s.$3)(t,e[0].toLowerCase()+e.slice(1))||(0,s.$3)(t,(0,s.Tg)(e))||(0,s.$3)(t,e))}let R=null,D=null;function P(t){const e=R;return R=t,D=t&&t.type.__scopeId||null,e}function O(t){D=t}function F(){D=null}function N(t,e=R,i){if(!e)return t;if(t._n)return t;const n=(...i)=>{n._d&&ni(-1);const s=P(e);let r;try{r=t(...i)}finally{P(s),n._d&&ni(1)}return r};return n._n=!0,n._c=!0,n._d=!0,n}function B(t){const{type:e,vnode:i,proxy:n,withProxy:r,propsOptions:[a],slots:l,attrs:c,emit:h,render:d,renderCache:u,props:p,data:f,setupState:g,ctx:m,inheritAttrs:v}=t,b=P(t);let y,A;try{if(4&i.shapeFlag){const t=r||n,e=t;y=yi(d.call(e,t,u,p,g,f,m)),A=c}else{const t=e;0,y=yi(t.length>1?t(p,{attrs:c,slots:l,emit:h}):t(p,null)),A=e.props?c:U(c)}}catch(E){Je.length=0,o(E,t,1),y=ui(Ye)}let _=y;if(A&&!1!==v){const t=Object.keys(A),{shapeFlag:e}=_;t.length&&7&e&&(a&&t.some(s.CP)&&(A=j(A,a)),_=gi(_,A,!1,!0))}return i.dirs&&(_=gi(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(i.dirs):i.dirs),i.transition&&(_.transition=i.transition),y=_,P(b),y}const U=t=>{let e;for(const i in t)("class"===i||"style"===i||(0,s.Mp)(i))&&((e||(e={}))[i]=t[i]);return e},j=(t,e)=>{const i={};for(const n in t)(0,s.CP)(n)&&n.slice(9)in e||(i[n]=t[n]);return i};function H(t,e,i){const{props:n,children:s,component:r}=t,{props:a,children:o,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(!(i&&l>=0))return!(!s&&!o||o&&o.$stable)||n!==a&&(n?!a||$(n,a,c):!!a);if(1024&l)return!0;if(16&l)return n?$(n,a,c):!!a;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const i=t[e];if(a[i]!==n[i]&&!L(c,i))return!0}}return!1}function $(t,e,i){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const r=n[s];if(e[r]!==t[r]&&!L(i,r))return!0}return!1}function z({vnode:t,parent:e},i){while(e){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n!==t)break;(t=e.vnode).el=i,e=e.parent}}const V="components";function G(t,e){return W(V,t,!0,e)||t}const K=Symbol.for("v-ndc");function W(t,e,i=!0,n=!1){const r=R||Ti;if(r){const i=r.type;if(t===V){const t=Vi(i,!1);if(t&&(t===e||t===(0,s.PT)(e)||t===(0,s.ZH)((0,s.PT)(e))))return i}const a=q(r[t]||i[t],e)||q(r.appContext[t],e);return!a&&n?i:a}}function q(t,e){return t&&(t[e]||t[(0,s.PT)(e)]||t[(0,s.ZH)((0,s.PT)(e))])}const X=t=>t.__isSuspense;function Y(t,e){e&&e.pendingBranch?(0,s.cy)(t)?e.effects.push(...t):e.effects.push(t):w(t)}const Q=Symbol.for("v-scx"),J=()=>{{const t=me(Q);return t}};const Z={};function tt(t,e,i){return et(t,e,i)}function et(t,e,{immediate:i,deep:o,flush:l,once:c,onTrack:h,onTrigger:d}=s.MZ){if(e&&c){const t=e;e=(...e)=>{t(...e),S()}}const u=Ti,p=t=>!0===o?t:st(t,!1===o?1:void 0);let f,g,m=!1,v=!1;if((0,n.i9)(t)?(f=()=>t.value,m=(0,n.fE)(t)):(0,n.g8)(t)?(f=()=>p(t),m=!0):(0,s.cy)(t)?(v=!0,m=t.some((t=>(0,n.g8)(t)||(0,n.fE)(t))),f=()=>t.map((t=>(0,n.i9)(t)?t.value:(0,n.g8)(t)?p(t):(0,s.Tn)(t)?r(t,u,2):void 0))):f=(0,s.Tn)(t)?e?()=>r(t,u,2):()=>(g&&g(),a(t,u,3,[y])):s.tE,e&&o){const t=f;f=()=>st(t())}let b,y=t=>{g=x.onStop=()=>{r(t,u,4),g=x.onStop=void 0}};if(Fi){if(y=s.tE,e?i&&a(e,u,3,[f(),v?[]:void 0,y]):f(),"sync"!==l)return s.tE;{const t=J();b=t.__watcherHandles||(t.__watcherHandles=[])}}let _=v?new Array(t.length).fill(Z):Z;const E=()=>{if(x.active&&x.dirty)if(e){const t=x.run();(o||m||(v?t.some(((t,e)=>(0,s.$H)(t,_[e]))):(0,s.$H)(t,_)))&&(g&&g(),a(e,u,3,[t,_===Z?void 0:v&&_[0]===Z?[]:_,y]),_=t)}else x.run()};let w;E.allowRecurse=!!e,"sync"===l?w=E:"post"===l?w=()=>Be(E,u&&u.suspense):(E.pre=!0,u&&(E.id=u.uid),w=()=>A(E));const x=new n.X2(f,s.tE,w),C=(0,n.o5)(),S=()=>{x.stop(),C&&(0,s.TF)(C.effects,x)};return e?i?E():_=x.run():"post"===l?Be(x.run.bind(x),u&&u.suspense):x.run(),b&&b.push(S),S}function it(t,e,i){const n=this.proxy,r=(0,s.Kg)(t)?t.includes(".")?nt(n,t):()=>n[t]:t.bind(n,n);let a;(0,s.Tn)(e)?a=e:(a=e.handler,i=e);const o=Li(this),l=et(r,a.bind(n),i);return o(),l}function nt(t,e){const i=e.split(".");return()=>{let e=t;for(let t=0;t<i.length&&e;t++)e=e[i[t]];return e}}function st(t,e=1/0,i){if(e<=0||!(0,s.Gv)(t)||t["__v_skip"])return t;if(i=i||new Set,i.has(t))return t;if(i.add(t),e--,(0,n.i9)(t))st(t.value,e,i);else if((0,s.cy)(t))for(let n=0;n<t.length;n++)st(t[n],e,i);else if((0,s.vM)(t)||(0,s.CE)(t))t.forEach((t=>{st(t,e,i)}));else if((0,s.Qd)(t))for(const n in t)st(t[n],e,i);return t}function rt(t,e){if(null===R)return t;const i=zi(R)||R.proxy,n=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[t,a,o,l=s.MZ]=e[r];t&&((0,s.Tn)(t)&&(t={mounted:t,updated:t}),t.deep&&st(a),n.push({dir:t,instance:i,value:a,oldValue:void 0,arg:o,modifiers:l}))}return t}function at(t,e,i,s){const r=t.dirs,o=e&&e.dirs;for(let l=0;l<r.length;l++){const c=r[l];o&&(c.oldValue=o[l].value);let h=c.dir[s];h&&((0,n.C4)(),a(h,i,8,[t.el,c,t,e]),(0,n.bl)())}}const ot=Symbol("_leaveCb"),lt=Symbol("_enterCb");function ct(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Dt((()=>{t.isMounted=!0})),Ft((()=>{t.isUnmounting=!0})),t}const ht=[Function,Array],dt={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ht,onEnter:ht,onAfterEnter:ht,onEnterCancelled:ht,onBeforeLeave:ht,onLeave:ht,onAfterLeave:ht,onLeaveCancelled:ht,onBeforeAppear:ht,onAppear:ht,onAfterAppear:ht,onAppearCancelled:ht},ut={name:"BaseTransition",props:dt,setup(t,{slots:e}){const i=ki(),s=ct();return()=>{const r=e.default&&yt(e.default(),!0);if(!r||!r.length)return;let a=r[0];if(r.length>1){let t=!1;for(const e of r)if(e.type!==Ye){0,a=e,t=!0;break}}const o=(0,n.ux)(t),{mode:l}=o;if(s.isLeaving)return mt(a);const c=vt(a);if(!c)return mt(a);const h=gt(c,o,s,i);bt(c,h);const d=i.subTree,u=d&&vt(d);if(u&&u.type!==Ye&&!li(c,u)){const t=gt(u,o,s,i);if(bt(u,t),"out-in"===l&&c.type!==Ye)return s.isLeaving=!0,t.afterLeave=()=>{s.isLeaving=!1,!1!==i.update.active&&(i.effect.dirty=!0,i.update())},mt(a);"in-out"===l&&c.type!==Ye&&(t.delayLeave=(t,e,i)=>{const n=ft(s,u);n[String(u.key)]=u,t[ot]=()=>{e(),t[ot]=void 0,delete h.delayedLeave},h.delayedLeave=i})}return a}}},pt=ut;function ft(t,e){const{leavingVNodes:i}=t;let n=i.get(e.type);return n||(n=Object.create(null),i.set(e.type,n)),n}function gt(t,e,i,n){const{appear:r,mode:o,persisted:l=!1,onBeforeEnter:c,onEnter:h,onAfterEnter:d,onEnterCancelled:u,onBeforeLeave:p,onLeave:f,onAfterLeave:g,onLeaveCancelled:m,onBeforeAppear:v,onAppear:b,onAfterAppear:y,onAppearCancelled:A}=e,_=String(t.key),E=ft(i,t),w=(t,e)=>{t&&a(t,n,9,e)},x=(t,e)=>{const i=e[1];w(t,e),(0,s.cy)(t)?t.every((t=>t.length<=1))&&i():t.length<=1&&i()},C={mode:o,persisted:l,beforeEnter(e){let n=c;if(!i.isMounted){if(!r)return;n=v||c}e[ot]&&e[ot](!0);const s=E[_];s&&li(t,s)&&s.el[ot]&&s.el[ot](),w(n,[e])},enter(t){let e=h,n=d,s=u;if(!i.isMounted){if(!r)return;e=b||h,n=y||d,s=A||u}let a=!1;const o=t[lt]=e=>{a||(a=!0,w(e?s:n,[t]),C.delayedLeave&&C.delayedLeave(),t[lt]=void 0)};e?x(e,[t,o]):o()},leave(e,n){const s=String(t.key);if(e[lt]&&e[lt](!0),i.isUnmounting)return n();w(p,[e]);let r=!1;const a=e[ot]=i=>{r||(r=!0,n(),w(i?m:g,[e]),e[ot]=void 0,E[s]===t&&delete E[s])};E[s]=t,f?x(f,[e,a]):a()},clone(t){return gt(t,e,i,n)}};return C}function mt(t){if(Et(t))return t=gi(t),t.children=null,t}function vt(t){if(!Et(t))return t;const{shapeFlag:e,children:i}=t;if(i){if(16&e)return i[0];if(32&e&&(0,s.Tn)(i.default))return i.default()}}function bt(t,e){6&t.shapeFlag&&t.component?bt(t.component.subTree,e):128&t.shapeFlag?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function yt(t,e=!1,i){let n=[],s=0;for(let r=0;r<t.length;r++){let a=t[r];const o=null==i?a.key:String(i)+String(null!=a.key?a.key:r);a.type===qe?(128&a.patchFlag&&s++,n=n.concat(yt(a.children,e,o))):(e||a.type!==Ye)&&n.push(null!=o?gi(a,{key:o}):a)}if(s>1)for(let r=0;r<n.length;r++)n[r].patchFlag=-2;return n}
/*! #__NO_SIDE_EFFECTS__ */function At(t,e){return(0,s.Tn)(t)?(()=>(0,s.X$)({name:t.name},e,{setup:t}))():t}const _t=t=>!!t.type.__asyncLoader
/*! #__NO_SIDE_EFFECTS__ */;const Et=t=>t.type.__isKeepAlive;RegExp,RegExp;function wt(t,e){return(0,s.cy)(t)?t.some((t=>wt(t,e))):(0,s.Kg)(t)?t.split(",").includes(e):!!(0,s.gd)(t)&&t.test(e)}function xt(t,e){St(t,"a",e)}function Ct(t,e){St(t,"da",e)}function St(t,e,i=Ti){const n=t.__wdc||(t.__wdc=()=>{let e=i;while(e){if(e.isDeactivated)return;e=e.parent}return t()});if(Mt(e,n,i),i){let t=i.parent;while(t&&t.parent)Et(t.parent.vnode)&&Tt(n,e,i,t),t=t.parent}}function Tt(t,e,i,n){const r=Mt(e,t,n,!0);Nt((()=>{(0,s.TF)(n[e],r)}),i)}function kt(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function It(t){return 128&t.shapeFlag?t.ssContent:t}function Mt(t,e,i=Ti,s=!1){if(i){const r=i[t]||(i[t]=[]),o=e.__weh||(e.__weh=(...s)=>{if(i.isUnmounted)return;(0,n.C4)();const r=Li(i),o=a(e,i,t,s);return r(),(0,n.bl)(),o});return s?r.unshift(o):r.push(o),o}}const Lt=t=>(e,i=Ti)=>(!Fi||"sp"===t)&&Mt(t,((...t)=>e(...t)),i),Rt=Lt("bm"),Dt=Lt("m"),Pt=Lt("bu"),Ot=Lt("u"),Ft=Lt("bum"),Nt=Lt("um"),Bt=Lt("sp"),Ut=Lt("rtg"),jt=Lt("rtc");function Ht(t,e=Ti){Mt("ec",t,e)}function $t(t,e,i,n){let r;const a=i&&i[n];if((0,s.cy)(t)||(0,s.Kg)(t)){r=new Array(t.length);for(let i=0,n=t.length;i<n;i++)r[i]=e(t[i],i,void 0,a&&a[i])}else if("number"===typeof t){0,r=new Array(t);for(let i=0;i<t;i++)r[i]=e(i+1,i,void 0,a&&a[i])}else if((0,s.Gv)(t))if(t[Symbol.iterator])r=Array.from(t,((t,i)=>e(t,i,void 0,a&&a[i])));else{const i=Object.keys(t);r=new Array(i.length);for(let n=0,s=i.length;n<s;n++){const s=i[n];r[n]=e(t[s],s,n,a&&a[n])}}else r=[];return i&&(i[n]=r),r}function zt(t,e,i={},n,s){if(R.isCE||R.parent&&_t(R.parent)&&R.parent.isCE)return"default"!==e&&(i.name=e),ui("slot",i,n&&n());let r=t[e];r&&r._c&&(r._d=!1),ti();const a=r&&Vt(r(i)),o=ai(qe,{key:i.key||a&&a.key||`_${e}`},a||(n?n():[]),a&&1===t._?64:-2);return!s&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),r&&r._c&&(r._d=!0),o}function Vt(t){return t.some((t=>!oi(t)||t.type!==Ye&&!(t.type===qe&&!Vt(t.children))))?t:null}const Gt=t=>t?Di(t)?zi(t)||t.proxy:Gt(t.parent):null,Kt=(0,s.X$)(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Gt(t.parent),$root:t=>Gt(t.root),$emit:t=>t.emit,$options:t=>ee(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,A(t.update)}),$nextTick:t=>t.n||(t.n=b.bind(t.proxy)),$watch:t=>it.bind(t)}),Wt=(t,e)=>t!==s.MZ&&!t.__isScriptSetup&&(0,s.$3)(t,e),qt={get({_:t},e){if("__v_skip"===e)return!0;const{ctx:i,setupState:r,data:a,props:o,accessCache:l,type:c,appContext:h}=t;let d;if("$"!==e[0]){const n=l[e];if(void 0!==n)switch(n){case 1:return r[e];case 2:return a[e];case 4:return i[e];case 3:return o[e]}else{if(Wt(r,e))return l[e]=1,r[e];if(a!==s.MZ&&(0,s.$3)(a,e))return l[e]=2,a[e];if((d=t.propsOptions[0])&&(0,s.$3)(d,e))return l[e]=3,o[e];if(i!==s.MZ&&(0,s.$3)(i,e))return l[e]=4,i[e];Yt&&(l[e]=0)}}const u=Kt[e];let p,f;return u?("$attrs"===e&&(0,n.u4)(t.attrs,"get",""),u(t)):(p=c.__cssModules)&&(p=p[e])?p:i!==s.MZ&&(0,s.$3)(i,e)?(l[e]=4,i[e]):(f=h.config.globalProperties,(0,s.$3)(f,e)?f[e]:void 0)},set({_:t},e,i){const{data:n,setupState:r,ctx:a}=t;return Wt(r,e)?(r[e]=i,!0):n!==s.MZ&&(0,s.$3)(n,e)?(n[e]=i,!0):!(0,s.$3)(t.props,e)&&(("$"!==e[0]||!(e.slice(1)in t))&&(a[e]=i,!0))},has({_:{data:t,setupState:e,accessCache:i,ctx:n,appContext:r,propsOptions:a}},o){let l;return!!i[o]||t!==s.MZ&&(0,s.$3)(t,o)||Wt(e,o)||(l=a[0])&&(0,s.$3)(l,o)||(0,s.$3)(n,o)||(0,s.$3)(Kt,o)||(0,s.$3)(r.config.globalProperties,o)},defineProperty(t,e,i){return null!=i.get?t._.accessCache[e]=0:(0,s.$3)(i,"value")&&this.set(t,e,i.value,null),Reflect.defineProperty(t,e,i)}};function Xt(t){return(0,s.cy)(t)?t.reduce(((t,e)=>(t[e]=null,t)),{}):t}let Yt=!0;function Qt(t){const e=ee(t),i=t.proxy,r=t.ctx;Yt=!1,e.beforeCreate&&Zt(e.beforeCreate,t,"bc");const{data:a,computed:o,methods:l,watch:c,provide:h,inject:d,created:u,beforeMount:p,mounted:f,beforeUpdate:g,updated:m,activated:v,deactivated:b,beforeDestroy:y,beforeUnmount:A,destroyed:_,unmounted:E,render:w,renderTracked:x,renderTriggered:C,errorCaptured:S,serverPrefetch:T,expose:k,inheritAttrs:I,components:M,directives:L,filters:R}=e,D=null;if(d&&Jt(d,r,D),l)for(const n in l){const t=l[n];(0,s.Tn)(t)&&(r[n]=t.bind(i))}if(a){0;const e=a.call(i,i);0,(0,s.Gv)(e)&&(t.data=(0,n.Kh)(e))}if(Yt=!0,o)for(const n in o){const t=o[n],e=(0,s.Tn)(t)?t.bind(i,i):(0,s.Tn)(t.get)?t.get.bind(i,i):s.tE;0;const a=!(0,s.Tn)(t)&&(0,s.Tn)(t.set)?t.set.bind(i):s.tE,l=Ki({get:e,set:a});Object.defineProperty(r,n,{enumerable:!0,configurable:!0,get:()=>l.value,set:t=>l.value=t})}if(c)for(const n in c)te(c[n],r,i,n);if(h){const t=(0,s.Tn)(h)?h.call(i):h;Reflect.ownKeys(t).forEach((e=>{ge(e,t[e])}))}function P(t,e){(0,s.cy)(e)?e.forEach((e=>t(e.bind(i)))):e&&t(e.bind(i))}if(u&&Zt(u,t,"c"),P(Rt,p),P(Dt,f),P(Pt,g),P(Ot,m),P(xt,v),P(Ct,b),P(Ht,S),P(jt,x),P(Ut,C),P(Ft,A),P(Nt,E),P(Bt,T),(0,s.cy)(k))if(k.length){const e=t.exposed||(t.exposed={});k.forEach((t=>{Object.defineProperty(e,t,{get:()=>i[t],set:e=>i[t]=e})}))}else t.exposed||(t.exposed={});w&&t.render===s.tE&&(t.render=w),null!=I&&(t.inheritAttrs=I),M&&(t.components=M),L&&(t.directives=L)}function Jt(t,e,i=s.tE){(0,s.cy)(t)&&(t=ae(t));for(const r in t){const i=t[r];let a;a=(0,s.Gv)(i)?"default"in i?me(i.from||r,i.default,!0):me(i.from||r):me(i),(0,n.i9)(a)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:t=>a.value=t}):e[r]=a}}function Zt(t,e,i){a((0,s.cy)(t)?t.map((t=>t.bind(e.proxy))):t.bind(e.proxy),e,i)}function te(t,e,i,n){const r=n.includes(".")?nt(i,n):()=>i[n];if((0,s.Kg)(t)){const i=e[t];(0,s.Tn)(i)&&tt(r,i)}else if((0,s.Tn)(t))tt(r,t.bind(i));else if((0,s.Gv)(t))if((0,s.cy)(t))t.forEach((t=>te(t,e,i,n)));else{const n=(0,s.Tn)(t.handler)?t.handler.bind(i):e[t.handler];(0,s.Tn)(n)&&tt(r,n,t)}else 0}function ee(t){const e=t.type,{mixins:i,extends:n}=e,{mixins:r,optionsCache:a,config:{optionMergeStrategies:o}}=t.appContext,l=a.get(e);let c;return l?c=l:r.length||i||n?(c={},r.length&&r.forEach((t=>ie(c,t,o,!0))),ie(c,e,o)):c=e,(0,s.Gv)(e)&&a.set(e,c),c}function ie(t,e,i,n=!1){const{mixins:s,extends:r}=e;r&&ie(t,r,i,!0),s&&s.forEach((e=>ie(t,e,i,!0)));for(const a in e)if(n&&"expose"===a);else{const n=ne[a]||i&&i[a];t[a]=n?n(t[a],e[a]):e[a]}return t}const ne={data:se,props:ce,emits:ce,methods:le,computed:le,beforeCreate:oe,created:oe,beforeMount:oe,mounted:oe,beforeUpdate:oe,updated:oe,beforeDestroy:oe,beforeUnmount:oe,destroyed:oe,unmounted:oe,activated:oe,deactivated:oe,errorCaptured:oe,serverPrefetch:oe,components:le,directives:le,watch:he,provide:se,inject:re};function se(t,e){return e?t?function(){return(0,s.X$)((0,s.Tn)(t)?t.call(this,this):t,(0,s.Tn)(e)?e.call(this,this):e)}:e:t}function re(t,e){return le(ae(t),ae(e))}function ae(t){if((0,s.cy)(t)){const e={};for(let i=0;i<t.length;i++)e[t[i]]=t[i];return e}return t}function oe(t,e){return t?[...new Set([].concat(t,e))]:e}function le(t,e){return t?(0,s.X$)(Object.create(null),t,e):e}function ce(t,e){return t?(0,s.cy)(t)&&(0,s.cy)(e)?[...new Set([...t,...e])]:(0,s.X$)(Object.create(null),Xt(t),Xt(null!=e?e:{})):e}function he(t,e){if(!t)return e;if(!e)return t;const i=(0,s.X$)(Object.create(null),t);for(const n in e)i[n]=oe(t[n],e[n]);return i}function de(){return{app:null,config:{isNativeTag:s.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ue=0;function pe(t,e){return function(i,n=null){(0,s.Tn)(i)||(i=(0,s.X$)({},i)),null==n||(0,s.Gv)(n)||(n=null);const r=de(),a=new WeakSet;let o=!1;const l=r.app={_uid:ue++,_component:i,_props:n,_container:null,_context:r,_instance:null,version:qi,get config(){return r.config},set config(t){0},use(t,...e){return a.has(t)||(t&&(0,s.Tn)(t.install)?(a.add(t),t.install(l,...e)):(0,s.Tn)(t)&&(a.add(t),t(l,...e))),l},mixin(t){return r.mixins.includes(t)||r.mixins.push(t),l},component(t,e){return e?(r.components[t]=e,l):r.components[t]},directive(t,e){return e?(r.directives[t]=e,l):r.directives[t]},mount(s,a,c){if(!o){0;const h=ui(i,n);return h.appContext=r,!0===c?c="svg":!1===c&&(c=void 0),a&&e?e(h,s):t(h,s,c),o=!0,l._container=s,s.__vue_app__=l,zi(h.component)||h.component.proxy}},unmount(){o&&(t(null,l._container),delete l._container.__vue_app__)},provide(t,e){return r.provides[t]=e,l},runWithContext(t){const e=fe;fe=l;try{return t()}finally{fe=e}}};return l}}let fe=null;function ge(t,e){if(Ti){let i=Ti.provides;const n=Ti.parent&&Ti.parent.provides;n===i&&(i=Ti.provides=Object.create(n)),i[t]=e}else 0}function me(t,e,i=!1){const n=Ti||R;if(n||fe){const r=n?null==n.parent?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:fe._context.provides;if(r&&t in r)return r[t];if(arguments.length>1)return i&&(0,s.Tn)(e)?e.call(n&&n.proxy):e}else 0}const ve={},be=()=>Object.create(ve),ye=t=>Object.getPrototypeOf(t)===ve;function Ae(t,e,i,s=!1){const r={},a=be();t.propsDefaults=Object.create(null),Ee(t,e,r,a);for(const n in t.propsOptions[0])n in r||(r[n]=void 0);i?t.props=s?r:(0,n.Gc)(r):t.type.props?t.props=r:t.props=a,t.attrs=a}function _e(t,e,i,r){const{props:a,attrs:o,vnode:{patchFlag:l}}=t,c=(0,n.ux)(a),[h]=t.propsOptions;let d=!1;if(!(r||l>0)||16&l){let n;Ee(t,e,a,o)&&(d=!0);for(const r in c)e&&((0,s.$3)(e,r)||(n=(0,s.Tg)(r))!==r&&(0,s.$3)(e,n))||(h?!i||void 0===i[r]&&void 0===i[n]||(a[r]=we(h,c,r,void 0,t,!0)):delete a[r]);if(o!==c)for(const t in o)e&&(0,s.$3)(e,t)||(delete o[t],d=!0)}else if(8&l){const i=t.vnode.dynamicProps;for(let n=0;n<i.length;n++){let r=i[n];if(L(t.emitsOptions,r))continue;const l=e[r];if(h)if((0,s.$3)(o,r))l!==o[r]&&(o[r]=l,d=!0);else{const e=(0,s.PT)(r);a[e]=we(h,c,e,l,t,!1)}else l!==o[r]&&(o[r]=l,d=!0)}}d&&(0,n.hZ)(t.attrs,"set","")}function Ee(t,e,i,r){const[a,o]=t.propsOptions;let l,c=!1;if(e)for(let n in e){if((0,s.SU)(n))continue;const h=e[n];let d;a&&(0,s.$3)(a,d=(0,s.PT)(n))?o&&o.includes(d)?(l||(l={}))[d]=h:i[d]=h:L(t.emitsOptions,n)||n in r&&h===r[n]||(r[n]=h,c=!0)}if(o){const e=(0,n.ux)(i),r=l||s.MZ;for(let n=0;n<o.length;n++){const l=o[n];i[l]=we(a,e,l,r[l],t,!(0,s.$3)(r,l))}}return c}function we(t,e,i,n,r,a){const o=t[i];if(null!=o){const t=(0,s.$3)(o,"default");if(t&&void 0===n){const t=o.default;if(o.type!==Function&&!o.skipFactory&&(0,s.Tn)(t)){const{propsDefaults:s}=r;if(i in s)n=s[i];else{const a=Li(r);n=s[i]=t.call(null,e),a()}}else n=t}o[0]&&(a&&!t?n=!1:!o[1]||""!==n&&n!==(0,s.Tg)(i)||(n=!0))}return n}function xe(t,e,i=!1){const n=e.propsCache,r=n.get(t);if(r)return r;const a=t.props,o={},l=[];let c=!1;if(!(0,s.Tn)(t)){const n=t=>{c=!0;const[i,n]=xe(t,e,!0);(0,s.X$)(o,i),n&&l.push(...n)};!i&&e.mixins.length&&e.mixins.forEach(n),t.extends&&n(t.extends),t.mixins&&t.mixins.forEach(n)}if(!a&&!c)return(0,s.Gv)(t)&&n.set(t,s.Oj),s.Oj;if((0,s.cy)(a))for(let d=0;d<a.length;d++){0;const t=(0,s.PT)(a[d]);Ce(t)&&(o[t]=s.MZ)}else if(a){0;for(const t in a){const e=(0,s.PT)(t);if(Ce(e)){const i=a[t],n=o[e]=(0,s.cy)(i)||(0,s.Tn)(i)?{type:i}:(0,s.X$)({},i);if(n){const t=ke(Boolean,n.type),i=ke(String,n.type);n[0]=t>-1,n[1]=i<0||t<i,(t>-1||(0,s.$3)(n,"default"))&&l.push(e)}}}}const h=[o,l];return(0,s.Gv)(t)&&n.set(t,h),h}function Ce(t){return"$"!==t[0]&&!(0,s.SU)(t)}function Se(t){if(null===t)return"null";if("function"===typeof t)return t.name||"";if("object"===typeof t){const e=t.constructor&&t.constructor.name;return e||""}return""}function Te(t,e){return Se(t)===Se(e)}function ke(t,e){return(0,s.cy)(e)?e.findIndex((e=>Te(e,t))):(0,s.Tn)(e)&&Te(e,t)?0:-1}const Ie=t=>"_"===t[0]||"$stable"===t,Me=t=>(0,s.cy)(t)?t.map(yi):[yi(t)],Le=(t,e,i)=>{if(e._n)return e;const n=N(((...t)=>Me(e(...t))),i);return n._c=!1,n},Re=(t,e,i)=>{const n=t._ctx;for(const r in t){if(Ie(r))continue;const i=t[r];if((0,s.Tn)(i))e[r]=Le(r,i,n);else if(null!=i){0;const t=Me(i);e[r]=()=>t}}},De=(t,e)=>{const i=Me(e);t.slots.default=()=>i},Pe=(t,e)=>{const i=t.slots=be();if(32&t.vnode.shapeFlag){const t=e._;t?((0,s.X$)(i,e),(0,s.yQ)(i,"_",t,!0)):Re(e,i)}else e&&De(t,e)},Oe=(t,e,i)=>{const{vnode:n,slots:r}=t;let a=!0,o=s.MZ;if(32&n.shapeFlag){const t=e._;t?i&&1===t?a=!1:((0,s.X$)(r,e),i||1!==t||delete r._):(a=!e.$stable,Re(e,r)),o=e}else e&&(De(t,e),o={default:1});if(a)for(const s in r)Ie(s)||null!=o[s]||delete r[s]};function Fe(t,e,i,a,o=!1){if((0,s.cy)(t))return void t.forEach(((t,n)=>Fe(t,e&&((0,s.cy)(e)?e[n]:e),i,a,o)));if(_t(a)&&!o)return;const l=4&a.shapeFlag?zi(a.component)||a.component.proxy:a.el,c=o?null:l,{i:h,r:d}=t;const u=e&&e.r,p=h.refs===s.MZ?h.refs={}:h.refs,f=h.setupState;if(null!=u&&u!==d&&((0,s.Kg)(u)?(p[u]=null,(0,s.$3)(f,u)&&(f[u]=null)):(0,n.i9)(u)&&(u.value=null)),(0,s.Tn)(d))r(d,h,12,[c,p]);else{const e=(0,s.Kg)(d),r=(0,n.i9)(d);if(e||r){const n=()=>{if(t.f){const i=e?(0,s.$3)(f,d)?f[d]:p[d]:d.value;o?(0,s.cy)(i)&&(0,s.TF)(i,l):(0,s.cy)(i)?i.includes(l)||i.push(l):e?(p[d]=[l],(0,s.$3)(f,d)&&(f[d]=p[d])):(d.value=[l],t.k&&(p[t.k]=d.value))}else e?(p[d]=c,(0,s.$3)(f,d)&&(f[d]=c)):r&&(d.value=c,t.k&&(p[t.k]=c))};c?(n.id=-1,Be(n,i)):n()}else 0}}function Ne(){"boolean"!==typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&((0,s.We)().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1)}const Be=Y;function Ue(t){return je(t)}function je(t,e){Ne();const i=(0,s.We)();i.__VUE__=!0;const{insert:r,remove:a,patchProp:o,createElement:l,createText:c,createComment:h,setText:d,setElementText:u,parentNode:p,nextSibling:f,setScopeId:g=s.tE,insertStaticContent:m}=t,v=(t,e,i,n=null,s=null,r=null,a=void 0,o=null,l=!!e.dynamicChildren)=>{if(t===e)return;t&&!li(t,e)&&(n=J(t),W(t,s,r,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:c,ref:h,shapeFlag:d}=e;switch(c){case Xe:b(t,e,i,n);break;case Ye:y(t,e,i,n);break;case Qe:null==t&&_(e,i,n,a);break;case qe:P(t,e,i,n,s,r,a,o,l);break;default:1&d?T(t,e,i,n,s,r,a,o,l):6&d?O(t,e,i,n,s,r,a,o,l):(64&d||128&d)&&c.process(t,e,i,n,s,r,a,o,l,et)}null!=h&&s&&Fe(h,t&&t.ref,r,e||t,!e)},b=(t,e,i,n)=>{if(null==t)r(e.el=c(e.children),i,n);else{const i=e.el=t.el;e.children!==t.children&&d(i,e.children)}},y=(t,e,i,n)=>{null==t?r(e.el=h(e.children||""),i,n):e.el=t.el},_=(t,e,i,n)=>{[t.el,t.anchor]=m(t.children,e,i,n,t.el,t.anchor)},w=({el:t,anchor:e},i,n)=>{let s;while(t&&t!==e)s=f(t),r(t,i,n),t=s;r(e,i,n)},S=({el:t,anchor:e})=>{let i;while(t&&t!==e)i=f(t),a(t),t=i;a(e)},T=(t,e,i,n,s,r,a,o,l)=>{"svg"===e.type?a="svg":"math"===e.type&&(a="mathml"),null==t?k(e,i,n,s,r,a,o,l):L(t,e,s,r,a,o,l)},k=(t,e,i,n,a,c,h,d)=>{let p,f;const{props:g,shapeFlag:m,transition:v,dirs:b}=t;if(p=t.el=l(t.type,c,g&&g.is,g),8&m?u(p,t.children):16&m&&M(t.children,p,null,n,a,He(t,c),h,d),b&&at(t,null,n,"created"),I(p,t,t.scopeId,h,n),g){for(const e in g)"value"===e||(0,s.SU)(e)||o(p,e,null,g[e],c,t.children,n,a,Q);"value"in g&&o(p,"value",null,g.value,c),(f=g.onVnodeBeforeMount)&&wi(f,n,t)}b&&at(t,null,n,"beforeMount");const y=ze(a,v);y&&v.beforeEnter(p),r(p,e,i),((f=g&&g.onVnodeMounted)||y||b)&&Be((()=>{f&&wi(f,n,t),y&&v.enter(p),b&&at(t,null,n,"mounted")}),a)},I=(t,e,i,n,s)=>{if(i&&g(t,i),n)for(let r=0;r<n.length;r++)g(t,n[r]);if(s){let i=s.subTree;if(e===i){const e=s.vnode;I(t,e,e.scopeId,e.slotScopeIds,s.parent)}}},M=(t,e,i,n,s,r,a,o,l=0)=>{for(let c=l;c<t.length;c++){const l=t[c]=o?Ai(t[c]):yi(t[c]);v(null,l,e,i,n,s,r,a,o)}},L=(t,e,i,n,r,a,l)=>{const c=e.el=t.el;let{patchFlag:h,dynamicChildren:d,dirs:p}=e;h|=16&t.patchFlag;const f=t.props||s.MZ,g=e.props||s.MZ;let m;if(i&&$e(i,!1),(m=g.onVnodeBeforeUpdate)&&wi(m,i,e,t),p&&at(e,t,i,"beforeUpdate"),i&&$e(i,!0),d?R(t.dynamicChildren,d,c,i,n,He(e,r),a):l||$(t,e,c,null,i,n,He(e,r),a,!1),h>0){if(16&h)D(c,e,f,g,i,n,r);else if(2&h&&f.class!==g.class&&o(c,"class",null,g.class,r),4&h&&o(c,"style",f.style,g.style,r),8&h){const s=e.dynamicProps;for(let e=0;e<s.length;e++){const a=s[e],l=f[a],h=g[a];h===l&&"value"!==a||o(c,a,l,h,r,t.children,i,n,Q)}}1&h&&t.children!==e.children&&u(c,e.children)}else l||null!=d||D(c,e,f,g,i,n,r);((m=g.onVnodeUpdated)||p)&&Be((()=>{m&&wi(m,i,e,t),p&&at(e,t,i,"updated")}),n)},R=(t,e,i,n,s,r,a)=>{for(let o=0;o<e.length;o++){const l=t[o],c=e[o],h=l.el&&(l.type===qe||!li(l,c)||70&l.shapeFlag)?p(l.el):i;v(l,c,h,null,n,s,r,a,!0)}},D=(t,e,i,n,r,a,l)=>{if(i!==n){if(i!==s.MZ)for(const c in i)(0,s.SU)(c)||c in n||o(t,c,i[c],null,l,e.children,r,a,Q);for(const c in n){if((0,s.SU)(c))continue;const h=n[c],d=i[c];h!==d&&"value"!==c&&o(t,c,d,h,l,e.children,r,a,Q)}"value"in n&&o(t,"value",i.value,n.value,l)}},P=(t,e,i,n,s,a,o,l,h)=>{const d=e.el=t?t.el:c(""),u=e.anchor=t?t.anchor:c("");let{patchFlag:p,dynamicChildren:f,slotScopeIds:g}=e;g&&(l=l?l.concat(g):g),null==t?(r(d,i,n),r(u,i,n),M(e.children||[],i,u,s,a,o,l,h)):p>0&&64&p&&f&&t.dynamicChildren?(R(t.dynamicChildren,f,i,s,a,o,l),(null!=e.key||s&&e===s.subTree)&&Ve(t,e,!0)):$(t,e,i,u,s,a,o,l,h)},O=(t,e,i,n,s,r,a,o,l)=>{e.slotScopeIds=o,null==t?512&e.shapeFlag?s.ctx.activate(e,i,n,a,l):F(e,i,n,s,r,a,l):N(t,e,l)},F=(t,e,i,n,s,r,a)=>{const o=t.component=Si(t,n,s);if(Et(t)&&(o.ctx.renderer=et),Ni(o),o.asyncDep){if(s&&s.registerDep(o,U),!t.el){const t=o.subTree=ui(Ye);y(null,t,e,i)}}else U(o,t,e,i,s,r,a)},N=(t,e,i)=>{const n=e.component=t.component;if(H(t,e,i)){if(n.asyncDep&&!n.asyncResolved)return void j(n,e,i);n.next=e,E(n.update),n.effect.dirty=!0,n.update()}else e.el=t.el,n.vnode=e},U=(t,e,i,r,a,o,l)=>{const c=()=>{if(t.isMounted){let{next:e,bu:i,u:n,parent:r,vnode:h}=t;{const i=Ke(t);if(i)return e&&(e.el=h.el,j(t,e,l)),void i.asyncDep.then((()=>{t.isUnmounted||c()}))}let d,u=e;0,$e(t,!1),e?(e.el=h.el,j(t,e,l)):e=h,i&&(0,s.DY)(i),(d=e.props&&e.props.onVnodeBeforeUpdate)&&wi(d,r,e,h),$e(t,!0);const f=B(t);0;const g=t.subTree;t.subTree=f,v(g,f,p(g.el),J(g),t,a,o),e.el=f.el,null===u&&z(t,f.el),n&&Be(n,a),(d=e.props&&e.props.onVnodeUpdated)&&Be((()=>wi(d,r,e,h)),a)}else{let n;const{el:l,props:c}=e,{bm:h,m:d,parent:u}=t,p=_t(e);if($e(t,!1),h&&(0,s.DY)(h),!p&&(n=c&&c.onVnodeBeforeMount)&&wi(n,u,e),$e(t,!0),l&&nt){const i=()=>{t.subTree=B(t),nt(l,t.subTree,t,a,null)};p?e.type.__asyncLoader().then((()=>!t.isUnmounted&&i())):i()}else{0;const n=t.subTree=B(t);0,v(null,n,i,r,t,a,o),e.el=n.el}if(d&&Be(d,a),!p&&(n=c&&c.onVnodeMounted)){const t=e;Be((()=>wi(n,u,t)),a)}(256&e.shapeFlag||u&&_t(u.vnode)&&256&u.vnode.shapeFlag)&&t.a&&Be(t.a,a),t.isMounted=!0,e=i=r=null}},h=t.effect=new n.X2(c,s.tE,(()=>A(d)),t.scope),d=t.update=()=>{h.dirty&&h.run()};d.id=t.uid,$e(t,!0),d()},j=(t,e,i)=>{e.component=t;const s=t.vnode.props;t.vnode=e,t.next=null,_e(t,e.props,s,i),Oe(t,e.children,i),(0,n.C4)(),x(t),(0,n.bl)()},$=(t,e,i,n,s,r,a,o,l=!1)=>{const c=t&&t.children,h=t?t.shapeFlag:0,d=e.children,{patchFlag:p,shapeFlag:f}=e;if(p>0){if(128&p)return void G(c,d,i,n,s,r,a,o,l);if(256&p)return void V(c,d,i,n,s,r,a,o,l)}8&f?(16&h&&Q(c,s,r),d!==c&&u(i,d)):16&h?16&f?G(c,d,i,n,s,r,a,o,l):Q(c,s,r,!0):(8&h&&u(i,""),16&f&&M(d,i,n,s,r,a,o,l))},V=(t,e,i,n,r,a,o,l,c)=>{t=t||s.Oj,e=e||s.Oj;const h=t.length,d=e.length,u=Math.min(h,d);let p;for(p=0;p<u;p++){const n=e[p]=c?Ai(e[p]):yi(e[p]);v(t[p],n,i,null,r,a,o,l,c)}h>d?Q(t,r,a,!0,!1,u):M(e,i,n,r,a,o,l,c,u)},G=(t,e,i,n,r,a,o,l,c)=>{let h=0;const d=e.length;let u=t.length-1,p=d-1;while(h<=u&&h<=p){const n=t[h],s=e[h]=c?Ai(e[h]):yi(e[h]);if(!li(n,s))break;v(n,s,i,null,r,a,o,l,c),h++}while(h<=u&&h<=p){const n=t[u],s=e[p]=c?Ai(e[p]):yi(e[p]);if(!li(n,s))break;v(n,s,i,null,r,a,o,l,c),u--,p--}if(h>u){if(h<=p){const t=p+1,s=t<d?e[t].el:n;while(h<=p)v(null,e[h]=c?Ai(e[h]):yi(e[h]),i,s,r,a,o,l,c),h++}}else if(h>p)while(h<=u)W(t[h],r,a,!0),h++;else{const f=h,g=h,m=new Map;for(h=g;h<=p;h++){const t=e[h]=c?Ai(e[h]):yi(e[h]);null!=t.key&&m.set(t.key,h)}let b,y=0;const A=p-g+1;let _=!1,E=0;const w=new Array(A);for(h=0;h<A;h++)w[h]=0;for(h=f;h<=u;h++){const n=t[h];if(y>=A){W(n,r,a,!0);continue}let s;if(null!=n.key)s=m.get(n.key);else for(b=g;b<=p;b++)if(0===w[b-g]&&li(n,e[b])){s=b;break}void 0===s?W(n,r,a,!0):(w[s-g]=h+1,s>=E?E=s:_=!0,v(n,e[s],i,null,r,a,o,l,c),y++)}const x=_?Ge(w):s.Oj;for(b=x.length-1,h=A-1;h>=0;h--){const t=g+h,s=e[t],u=t+1<d?e[t+1].el:n;0===w[h]?v(null,s,i,u,r,a,o,l,c):_&&(b<0||h!==x[b]?K(s,i,u,2):b--)}}},K=(t,e,i,n,s=null)=>{const{el:a,type:o,transition:l,children:c,shapeFlag:h}=t;if(6&h)return void K(t.component.subTree,e,i,n);if(128&h)return void t.suspense.move(e,i,n);if(64&h)return void o.move(t,e,i,et);if(o===qe){r(a,e,i);for(let t=0;t<c.length;t++)K(c[t],e,i,n);return void r(t.anchor,e,i)}if(o===Qe)return void w(t,e,i);const d=2!==n&&1&h&&l;if(d)if(0===n)l.beforeEnter(a),r(a,e,i),Be((()=>l.enter(a)),s);else{const{leave:t,delayLeave:n,afterLeave:s}=l,o=()=>r(a,e,i),c=()=>{t(a,(()=>{o(),s&&s()}))};n?n(a,o,c):c()}else r(a,e,i)},W=(t,e,i,n=!1,s=!1)=>{const{type:r,props:a,ref:o,children:l,dynamicChildren:c,shapeFlag:h,patchFlag:d,dirs:u}=t;if(null!=o&&Fe(o,null,i,t,!0),256&h)return void e.ctx.deactivate(t);const p=1&h&&u,f=!_t(t);let g;if(f&&(g=a&&a.onVnodeBeforeUnmount)&&wi(g,e,t),6&h)Y(t.component,i,n);else{if(128&h)return void t.suspense.unmount(i,n);p&&at(t,null,e,"beforeUnmount"),64&h?t.type.remove(t,e,i,s,et,n):c&&(r!==qe||d>0&&64&d)?Q(c,e,i,!1,!0):(r===qe&&384&d||!s&&16&h)&&Q(l,e,i),n&&q(t)}(f&&(g=a&&a.onVnodeUnmounted)||p)&&Be((()=>{g&&wi(g,e,t),p&&at(t,null,e,"unmounted")}),i)},q=t=>{const{type:e,el:i,anchor:n,transition:s}=t;if(e===qe)return void X(i,n);if(e===Qe)return void S(t);const r=()=>{a(i),s&&!s.persisted&&s.afterLeave&&s.afterLeave()};if(1&t.shapeFlag&&s&&!s.persisted){const{leave:e,delayLeave:n}=s,a=()=>e(i,r);n?n(t.el,r,a):a()}else r()},X=(t,e)=>{let i;while(t!==e)i=f(t),a(t),t=i;a(e)},Y=(t,e,i)=>{const{bum:n,scope:r,update:a,subTree:o,um:l}=t;n&&(0,s.DY)(n),r.stop(),a&&(a.active=!1,W(o,t,e,i)),l&&Be(l,e),Be((()=>{t.isUnmounted=!0}),e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve())},Q=(t,e,i,n=!1,s=!1,r=0)=>{for(let a=r;a<t.length;a++)W(t[a],e,i,n,s)},J=t=>6&t.shapeFlag?J(t.component.subTree):128&t.shapeFlag?t.suspense.next():f(t.anchor||t.el);let Z=!1;const tt=(t,e,i)=>{null==t?e._vnode&&W(e._vnode,null,null,!0):v(e._vnode||null,t,e,null,null,null,i),Z||(Z=!0,x(),C(),Z=!1),e._vnode=t},et={p:v,um:W,m:K,r:q,mt:F,mc:M,pc:$,pbc:R,n:J,o:t};let it,nt;return e&&([it,nt]=e(et)),{render:tt,hydrate:it,createApp:pe(tt,it)}}function He({type:t,props:e},i){return"svg"===i&&"foreignObject"===t||"mathml"===i&&"annotation-xml"===t&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function $e({effect:t,update:e},i){t.allowRecurse=e.allowRecurse=i}function ze(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Ve(t,e,i=!1){const n=t.children,r=e.children;if((0,s.cy)(n)&&(0,s.cy)(r))for(let s=0;s<n.length;s++){const t=n[s];let e=r[s];1&e.shapeFlag&&!e.dynamicChildren&&((e.patchFlag<=0||32===e.patchFlag)&&(e=r[s]=Ai(r[s]),e.el=t.el),i||Ve(t,e)),e.type===Xe&&(e.el=t.el)}}function Ge(t){const e=t.slice(),i=[0];let n,s,r,a,o;const l=t.length;for(n=0;n<l;n++){const l=t[n];if(0!==l){if(s=i[i.length-1],t[s]<l){e[n]=s,i.push(n);continue}r=0,a=i.length-1;while(r<a)o=r+a>>1,t[i[o]]<l?r=o+1:a=o;l<t[i[r]]&&(r>0&&(e[n]=i[r-1]),i[r]=n)}}r=i.length,a=i[r-1];while(r-- >0)i[r]=a,a=e[a];return i}function Ke(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Ke(e)}const We=t=>t.__isTeleport;const qe=Symbol.for("v-fgt"),Xe=Symbol.for("v-txt"),Ye=Symbol.for("v-cmt"),Qe=Symbol.for("v-stc"),Je=[];let Ze=null;function ti(t=!1){Je.push(Ze=t?null:[])}function ei(){Je.pop(),Ze=Je[Je.length-1]||null}let ii=1;function ni(t){ii+=t}function si(t){return t.dynamicChildren=ii>0?Ze||s.Oj:null,ei(),ii>0&&Ze&&Ze.push(t),t}function ri(t,e,i,n,s,r){return si(di(t,e,i,n,s,r,!0))}function ai(t,e,i,n,s){return si(ui(t,e,i,n,s,!0))}function oi(t){return!!t&&!0===t.__v_isVNode}function li(t,e){return t.type===e.type&&t.key===e.key}const ci=({key:t})=>null!=t?t:null,hi=({ref:t,ref_key:e,ref_for:i})=>("number"===typeof t&&(t=""+t),null!=t?(0,s.Kg)(t)||(0,n.i9)(t)||(0,s.Tn)(t)?{i:R,r:t,k:e,f:!!i}:t:null);function di(t,e=null,i=null,n=0,r=null,a=(t===qe?0:1),o=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ci(e),ref:e&&hi(e),scopeId:D,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:R};return l?(_i(c,i),128&a&&t.normalize(c)):i&&(c.shapeFlag|=(0,s.Kg)(i)?8:16),ii>0&&!o&&Ze&&(c.patchFlag>0||6&a)&&32!==c.patchFlag&&Ze.push(c),c}const ui=pi;function pi(t,e=null,i=null,r=0,a=null,o=!1){if(t&&t!==K||(t=Ye),oi(t)){const n=gi(t,e,!0);return i&&_i(n,i),ii>0&&!o&&Ze&&(6&n.shapeFlag?Ze[Ze.indexOf(t)]=n:Ze.push(n)),n.patchFlag|=-2,n}if(Gi(t)&&(t=t.__vccOpts),e){e=fi(e);let{class:t,style:i}=e;t&&!(0,s.Kg)(t)&&(e.class=(0,s.C4)(t)),(0,s.Gv)(i)&&((0,n.ju)(i)&&!(0,s.cy)(i)&&(i=(0,s.X$)({},i)),e.style=(0,s.Tr)(i))}const l=(0,s.Kg)(t)?1:X(t)?128:We(t)?64:(0,s.Gv)(t)?4:(0,s.Tn)(t)?2:0;return di(t,e,i,r,a,l,o,!0)}function fi(t){return t?(0,n.ju)(t)||ye(t)?(0,s.X$)({},t):t:null}function gi(t,e,i=!1,n=!1){const{props:r,ref:a,patchFlag:o,children:l,transition:c}=t,h=e?Ei(r||{},e):r,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:h,key:h&&ci(h),ref:e&&e.ref?i&&a?(0,s.cy)(a)?a.concat(hi(e)):[a,hi(e)]:hi(e):a,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==qe?-1===o?16:16|o:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&gi(t.ssContent),ssFallback:t.ssFallback&&gi(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&n&&(d.transition=c.clone(d)),d}function mi(t=" ",e=0){return ui(Xe,null,t,e)}function vi(t,e){const i=ui(Qe,null,t);return i.staticCount=e,i}function bi(t="",e=!1){return e?(ti(),ai(Ye,null,t)):ui(Ye,null,t)}function yi(t){return null==t||"boolean"===typeof t?ui(Ye):(0,s.cy)(t)?ui(qe,null,t.slice()):"object"===typeof t?Ai(t):ui(Xe,null,String(t))}function Ai(t){return null===t.el&&-1!==t.patchFlag||t.memo?t:gi(t)}function _i(t,e){let i=0;const{shapeFlag:n}=t;if(null==e)e=null;else if((0,s.cy)(e))i=16;else if("object"===typeof e){if(65&n){const i=e.default;return void(i&&(i._c&&(i._d=!1),_i(t,i()),i._c&&(i._d=!0)))}{i=32;const n=e._;n||ye(e)?3===n&&R&&(1===R.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=R}}else(0,s.Tn)(e)?(e={default:e,_ctx:R},i=32):(e=String(e),64&n?(i=16,e=[mi(e)]):i=8);t.children=e,t.shapeFlag|=i}function Ei(...t){const e={};for(let i=0;i<t.length;i++){const n=t[i];for(const t in n)if("class"===t)e.class!==n.class&&(e.class=(0,s.C4)([e.class,n.class]));else if("style"===t)e.style=(0,s.Tr)([e.style,n.style]);else if((0,s.Mp)(t)){const i=e[t],r=n[t];!r||i===r||(0,s.cy)(i)&&i.includes(r)||(e[t]=i?[].concat(i,r):r)}else""!==t&&(e[t]=n[t])}return e}function wi(t,e,i,n=null){a(t,e,7,[i,n])}const xi=de();let Ci=0;function Si(t,e,i){const r=t.type,a=(e?e.appContext:t.appContext)||xi,o={uid:Ci++,vnode:t,type:r,parent:e,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new n.yC(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:xe(r,a),emitsOptions:M(r,a),emit:null,emitted:null,propsDefaults:s.MZ,inheritAttrs:r.inheritAttrs,ctx:s.MZ,data:s.MZ,props:s.MZ,attrs:s.MZ,slots:s.MZ,refs:s.MZ,setupState:s.MZ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=e?e.root:o,o.emit=I.bind(null,o),t.ce&&t.ce(o),o}let Ti=null;const ki=()=>Ti||R;let Ii,Mi;{const t=(0,s.We)(),e=(e,i)=>{let n;return(n=t[e])||(n=t[e]=[]),n.push(i),t=>{n.length>1?n.forEach((e=>e(t))):n[0](t)}};Ii=e("__VUE_INSTANCE_SETTERS__",(t=>Ti=t)),Mi=e("__VUE_SSR_SETTERS__",(t=>Fi=t))}const Li=t=>{const e=Ti;return Ii(t),t.scope.on(),()=>{t.scope.off(),Ii(e)}},Ri=()=>{Ti&&Ti.scope.off(),Ii(null)};function Di(t){return 4&t.vnode.shapeFlag}let Pi,Oi,Fi=!1;function Ni(t,e=!1){e&&Mi(e);const{props:i,children:n}=t.vnode,s=Di(t);Ae(t,i,s,e),Pe(t,n);const r=s?Bi(t,e):void 0;return e&&Mi(!1),r}function Bi(t,e){const i=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,qt);const{setup:a}=i;if(a){const i=t.setupContext=a.length>1?$i(t):null,l=Li(t);(0,n.C4)();const c=r(a,t,0,[t.props,i]);if((0,n.bl)(),l(),(0,s.yL)(c)){if(c.then(Ri,Ri),e)return c.then((i=>{Ui(t,i,e)})).catch((e=>{o(e,t,0)}));t.asyncDep=c}else Ui(t,c,e)}else ji(t,e)}function Ui(t,e,i){(0,s.Tn)(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:(0,s.Gv)(e)&&(t.setupState=(0,n.Pr)(e)),ji(t,i)}function ji(t,e,i){const r=t.type;if(!t.render){if(!e&&Pi&&!r.render){const e=r.template||ee(t).template;if(e){0;const{isCustomElement:i,compilerOptions:n}=t.appContext.config,{delimiters:a,compilerOptions:o}=r,l=(0,s.X$)((0,s.X$)({isCustomElement:i,delimiters:a},n),o);r.render=Pi(e,l)}}t.render=r.render||s.tE,Oi&&Oi(t)}{const e=Li(t);(0,n.C4)();try{Qt(t)}finally{(0,n.bl)(),e()}}}const Hi={get(t,e){return(0,n.u4)(t,"get",""),t[e]}};function $i(t){const e=e=>{t.exposed=e||{}};return{attrs:new Proxy(t.attrs,Hi),slots:t.slots,emit:t.emit,expose:e}}function zi(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy((0,n.Pr)((0,n.IG)(t.exposed)),{get(e,i){return i in e?e[i]:i in Kt?Kt[i](t):void 0},has(t,e){return e in t||e in Kt}}))}function Vi(t,e=!0){return(0,s.Tn)(t)?t.displayName||t.name:t.name||e&&t.__name}function Gi(t){return(0,s.Tn)(t)&&"__vccOpts"in t}const Ki=(t,e)=>{const i=(0,n.EW)(t,e,Fi);return i};function Wi(t,e,i){const n=arguments.length;return 2===n?(0,s.Gv)(e)&&!(0,s.cy)(e)?oi(e)?ui(t,null,[e]):ui(t,e):ui(t,null,e):(n>3?i=Array.prototype.slice.call(arguments,2):3===n&&oi(i)&&(i=[i]),ui(t,e,i))}const qi="3.4.27"},3751:function(t,e,i){i.d(e,{D$:function(){return kt},Ef:function(){return Rt},Jo:function(){return bt},XL:function(){return _t},lH:function(){return yt},u1:function(){return Et}});var n=i(641),s=i(33),r=i(953);
/**
* @vue/runtime-dom v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
const a="http://www.w3.org/2000/svg",o="http://www.w3.org/1998/Math/MathML",l="undefined"!==typeof document?document:null,c=l&&l.createElement("template"),h={insert:(t,e,i)=>{e.insertBefore(t,i||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,i,n)=>{const s="svg"===e?l.createElementNS(a,t):"mathml"===e?l.createElementNS(o,t):l.createElement(t,i?{is:i}:void 0);return"select"===t&&n&&null!=n.multiple&&s.setAttribute("multiple",n.multiple),s},createText:t=>l.createTextNode(t),createComment:t=>l.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>l.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,i,n,s,r){const a=i?i.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling)){while(1)if(e.insertBefore(s.cloneNode(!0),i),s===r||!(s=s.nextSibling))break}else{c.innerHTML="svg"===n?`<svg>${t}</svg>`:"mathml"===n?`<math>${t}</math>`:t;const s=c.content;if("svg"===n||"mathml"===n){const t=s.firstChild;while(t.firstChild)s.appendChild(t.firstChild);s.removeChild(t)}e.insertBefore(s,i)}return[a?a.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},d="transition",u="animation",p=Symbol("_vtc"),f=(t,{slots:e})=>(0,n.h)(n.pR,y(t),e);f.displayName="Transition";const g={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},m=f.props=(0,s.X$)({},n.QP,g),v=(t,e=[])=>{(0,s.cy)(t)?t.forEach((t=>t(...e))):t&&t(...e)},b=t=>!!t&&((0,s.cy)(t)?t.some((t=>t.length>1)):t.length>1);function y(t){const e={};for(const s in t)s in g||(e[s]=t[s]);if(!1===t.css)return e;const{name:i="v",type:n,duration:r,enterFromClass:a=`${i}-enter-from`,enterActiveClass:o=`${i}-enter-active`,enterToClass:l=`${i}-enter-to`,appearFromClass:c=a,appearActiveClass:h=o,appearToClass:d=l,leaveFromClass:u=`${i}-leave-from`,leaveActiveClass:p=`${i}-leave-active`,leaveToClass:f=`${i}-leave-to`}=t,m=A(r),y=m&&m[0],_=m&&m[1],{onBeforeEnter:C,onEnter:T,onEnterCancelled:k,onLeave:I,onLeaveCancelled:L,onBeforeAppear:R=C,onAppear:D=T,onAppearCancelled:P=k}=e,O=(t,e,i)=>{w(t,e?d:l),w(t,e?h:o),i&&i()},F=(t,e)=>{t._isLeaving=!1,w(t,u),w(t,f),w(t,p),e&&e()},N=t=>(e,i)=>{const s=t?D:T,r=()=>O(e,t,i);v(s,[e,r]),x((()=>{w(e,t?c:a),E(e,t?d:l),b(s)||S(e,n,y,r)}))};return(0,s.X$)(e,{onBeforeEnter(t){v(C,[t]),E(t,a),E(t,o)},onBeforeAppear(t){v(R,[t]),E(t,c),E(t,h)},onEnter:N(!1),onAppear:N(!0),onLeave(t,e){t._isLeaving=!0;const i=()=>F(t,e);E(t,u),E(t,p),M(),x((()=>{t._isLeaving&&(w(t,u),E(t,f),b(I)||S(t,n,_,i))})),v(I,[t,i])},onEnterCancelled(t){O(t,!1),v(k,[t])},onAppearCancelled(t){O(t,!0),v(P,[t])},onLeaveCancelled(t){F(t),v(L,[t])}})}function A(t){if(null==t)return null;if((0,s.Gv)(t))return[_(t.enter),_(t.leave)];{const e=_(t);return[e,e]}}function _(t){const e=(0,s.Ro)(t);return e}function E(t,e){e.split(/\s+/).forEach((e=>e&&t.classList.add(e))),(t[p]||(t[p]=new Set)).add(e)}function w(t,e){e.split(/\s+/).forEach((e=>e&&t.classList.remove(e)));const i=t[p];i&&(i.delete(e),i.size||(t[p]=void 0))}function x(t){requestAnimationFrame((()=>{requestAnimationFrame(t)}))}let C=0;function S(t,e,i,n){const s=t._endId=++C,r=()=>{s===t._endId&&n()};if(i)return setTimeout(r,i);const{type:a,timeout:o,propCount:l}=T(t,e);if(!a)return n();const c=a+"end";let h=0;const d=()=>{t.removeEventListener(c,u),r()},u=e=>{e.target===t&&++h>=l&&d()};setTimeout((()=>{h<l&&d()}),o+1),t.addEventListener(c,u)}function T(t,e){const i=window.getComputedStyle(t),n=t=>(i[t]||"").split(", "),s=n(`${d}Delay`),r=n(`${d}Duration`),a=k(s,r),o=n(`${u}Delay`),l=n(`${u}Duration`),c=k(o,l);let h=null,p=0,f=0;e===d?a>0&&(h=d,p=a,f=r.length):e===u?c>0&&(h=u,p=c,f=l.length):(p=Math.max(a,c),h=p>0?a>c?d:u:null,f=h?h===d?r.length:l.length:0);const g=h===d&&/\b(transform|all)(,|$)/.test(n(`${d}Property`).toString());return{type:h,timeout:p,propCount:f,hasTransform:g}}function k(t,e){while(t.length<e.length)t=t.concat(t);return Math.max(...e.map(((e,i)=>I(e)+I(t[i]))))}function I(t){return"auto"===t?0:1e3*Number(t.slice(0,-1).replace(",","."))}function M(){return document.body.offsetHeight}function L(t,e,i){const n=t[p];n&&(e=(e?[e,...n]:[...n]).join(" ")),null==e?t.removeAttribute("class"):i?t.setAttribute("class",e):t.className=e}const R=Symbol("_vod"),D=Symbol("_vsh");const P=Symbol("");const O=/(^|;)\s*display\s*:/;function F(t,e,i){const n=t.style,r=(0,s.Kg)(i);let a=!1;if(i&&!r){if(e)if((0,s.Kg)(e))for(const t of e.split(";")){const e=t.slice(0,t.indexOf(":")).trim();null==i[e]&&B(n,e,"")}else for(const t in e)null==i[t]&&B(n,t,"");for(const t in i)"display"===t&&(a=!0),B(n,t,i[t])}else if(r){if(e!==i){const t=n[P];t&&(i+=";"+t),n.cssText=i,a=O.test(i)}}else e&&t.removeAttribute("style");R in t&&(t[R]=a?n.display:"",t[D]&&(n.display="none"))}const N=/\s*!important$/;function B(t,e,i){if((0,s.cy)(i))i.forEach((i=>B(t,e,i)));else if(null==i&&(i=""),e.startsWith("--"))t.setProperty(e,i);else{const n=H(t,e);N.test(i)?t.setProperty((0,s.Tg)(n),i.replace(N,""),"important"):t[n]=i}}const U=["Webkit","Moz","ms"],j={};function H(t,e){const i=j[e];if(i)return i;let n=(0,s.PT)(e);if("filter"!==n&&n in t)return j[e]=n;n=(0,s.ZH)(n);for(let s=0;s<U.length;s++){const i=U[s]+n;if(i in t)return j[e]=i}return e}const $="http://www.w3.org/1999/xlink";function z(t,e,i,n,r){if(n&&e.startsWith("xlink:"))null==i?t.removeAttributeNS($,e.slice(6,e.length)):t.setAttributeNS($,e,i);else{const n=(0,s.J$)(e);null==i||n&&!(0,s.Y2)(i)?t.removeAttribute(e):t.setAttribute(e,n?"":i)}}function V(t,e,i,n,r,a,o){if("innerHTML"===e||"textContent"===e)return n&&o(n,r,a),void(t[e]=null==i?"":i);const l=t.tagName;if("value"===e&&"PROGRESS"!==l&&!l.includes("-")){const n="OPTION"===l?t.getAttribute("value")||"":t.value,s=null==i?"":i;return n===s&&"_value"in t||(t.value=s),null==i&&t.removeAttribute(e),void(t._value=i)}let c=!1;if(""===i||null==i){const n=typeof t[e];"boolean"===n?i=(0,s.Y2)(i):null==i&&"string"===n?(i="",c=!0):"number"===n&&(i=0,c=!0)}try{t[e]=i}catch(h){0}c&&t.removeAttribute(e)}function G(t,e,i,n){t.addEventListener(e,i,n)}function K(t,e,i,n){t.removeEventListener(e,i,n)}const W=Symbol("_vei");function q(t,e,i,n,s=null){const r=t[W]||(t[W]={}),a=r[e];if(n&&a)a.value=n;else{const[i,o]=Y(e);if(n){const a=r[e]=tt(n,s);G(t,i,a,o)}else a&&(K(t,i,a,o),r[e]=void 0)}}const X=/(?:Once|Passive|Capture)$/;function Y(t){let e;if(X.test(t)){let i;e={};while(i=t.match(X))t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}const i=":"===t[2]?t.slice(3):(0,s.Tg)(t.slice(2));return[i,e]}let Q=0;const J=Promise.resolve(),Z=()=>Q||(J.then((()=>Q=0)),Q=Date.now());function tt(t,e){const i=t=>{if(t._vts){if(t._vts<=i.attached)return}else t._vts=Date.now();(0,n.qL)(et(t,i.value),e,5,[t])};return i.value=t,i.attached=Z(),i}function et(t,e){if((0,s.cy)(e)){const i=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{i.call(t),t._stopped=!0},e.map((t=>e=>!e._stopped&&t&&t(e)))}return e}const it=t=>111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,nt=(t,e,i,n,r,a,o,l,c)=>{const h="svg"===r;"class"===e?L(t,n,h):"style"===e?F(t,i,n):(0,s.Mp)(e)?(0,s.CP)(e)||q(t,e,i,n,o):("."===e[0]?(e=e.slice(1),1):"^"===e[0]?(e=e.slice(1),0):st(t,e,n,h))?V(t,e,n,a,o,l,c):("true-value"===e?t._trueValue=n:"false-value"===e&&(t._falseValue=n),z(t,e,n,h))};function st(t,e,i,n){if(n)return"innerHTML"===e||"textContent"===e||!!(e in t&&it(e)&&(0,s.Tn)(i));if("spellcheck"===e||"draggable"===e||"translate"===e)return!1;if("form"===e)return!1;if("list"===e&&"INPUT"===t.tagName)return!1;if("type"===e&&"TEXTAREA"===t.tagName)return!1;if("width"===e||"height"===e){const e=t.tagName;if("IMG"===e||"VIDEO"===e||"CANVAS"===e||"SOURCE"===e)return!1}return(!it(e)||!(0,s.Kg)(i))&&e in t}
/*! #__NO_SIDE_EFFECTS__ */
/*! #__NO_SIDE_EFFECTS__ */
"undefined"!==typeof HTMLElement&&HTMLElement;const rt=new WeakMap,at=new WeakMap,ot=Symbol("_moveCb"),lt=Symbol("_enterCb"),ct={name:"TransitionGroup",props:(0,s.X$)({},m,{tag:String,moveClass:String}),setup(t,{slots:e}){const i=(0,n.nI)(),s=(0,n.Gy)();let a,o;return(0,n.$u)((()=>{if(!a.length)return;const e=t.moveClass||`${t.name||"v"}-move`;if(!pt(a[0].el,i.vnode.el,e))return;a.forEach(ht),a.forEach(dt);const n=a.filter(ut);M(),n.forEach((t=>{const i=t.el,n=i.style;E(i,e),n.transform=n.webkitTransform=n.transitionDuration="";const s=i[ot]=t=>{t&&t.target!==i||t&&!/transform$/.test(t.propertyName)||(i.removeEventListener("transitionend",s),i[ot]=null,w(i,e))};i.addEventListener("transitionend",s)}))})),()=>{const l=(0,r.ux)(t),c=y(l);let h=l.tag||n.FK;if(a=[],o)for(let t=0;t<o.length;t++){const e=o[t];e.el&&e.el instanceof Element&&(a.push(e),(0,n.MZ)(e,(0,n.OW)(e,c,s,i)),rt.set(e,e.el.getBoundingClientRect()))}o=e.default?(0,n.Df)(e.default()):[];for(let t=0;t<o.length;t++){const e=o[t];null!=e.key&&(0,n.MZ)(e,(0,n.OW)(e,c,s,i))}return(0,n.bF)(h,null,o)}}};ct.props;function ht(t){const e=t.el;e[ot]&&e[ot](),e[lt]&&e[lt]()}function dt(t){at.set(t,t.el.getBoundingClientRect())}function ut(t){const e=rt.get(t),i=at.get(t),n=e.left-i.left,s=e.top-i.top;if(n||s){const e=t.el.style;return e.transform=e.webkitTransform=`translate(${n}px,${s}px)`,e.transitionDuration="0s",t}}function pt(t,e,i){const n=t.cloneNode(),s=t[p];s&&s.forEach((t=>{t.split(/\s+/).forEach((t=>t&&n.classList.remove(t)))})),i.split(/\s+/).forEach((t=>t&&n.classList.add(t))),n.style.display="none";const r=1===e.nodeType?e:e.parentNode;r.appendChild(n);const{hasTransform:a}=T(n);return r.removeChild(n),a}const ft=t=>{const e=t.props["onUpdate:modelValue"]||!1;return(0,s.cy)(e)?t=>(0,s.DY)(e,t):e};function gt(t){t.target.composing=!0}function mt(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const vt=Symbol("_assign"),bt={created(t,{modifiers:{lazy:e,trim:i,number:n}},r){t[vt]=ft(r);const a=n||r.props&&"number"===r.props.type;G(t,e?"change":"input",(e=>{if(e.target.composing)return;let n=t.value;i&&(n=n.trim()),a&&(n=(0,s.bB)(n)),t[vt](n)})),i&&G(t,"change",(()=>{t.value=t.value.trim()})),e||(G(t,"compositionstart",gt),G(t,"compositionend",mt),G(t,"change",mt))},mounted(t,{value:e}){t.value=null==e?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:i,trim:n,number:r}},a){if(t[vt]=ft(a),t.composing)return;const o=!r&&"number"!==t.type||/^0\d/.test(t.value)?t.value:(0,s.bB)(t.value),l=null==e?"":e;if(o!==l){if(document.activeElement===t&&"range"!==t.type){if(i)return;if(n&&t.value.trim()===l)return}t.value=l}}},yt={deep:!0,created(t,e,i){t[vt]=ft(i),G(t,"change",(()=>{const e=t._modelValue,i=xt(t),n=t.checked,r=t[vt];if((0,s.cy)(e)){const t=(0,s.u3)(e,i),a=-1!==t;if(n&&!a)r(e.concat(i));else if(!n&&a){const i=[...e];i.splice(t,1),r(i)}}else if((0,s.vM)(e)){const t=new Set(e);n?t.add(i):t.delete(i),r(t)}else r(Ct(t,n))}))},mounted:At,beforeUpdate(t,e,i){t[vt]=ft(i),At(t,e,i)}};function At(t,{value:e,oldValue:i},n){t._modelValue=e,(0,s.cy)(e)?t.checked=(0,s.u3)(e,n.props.value)>-1:(0,s.vM)(e)?t.checked=e.has(n.props.value):e!==i&&(t.checked=(0,s.BX)(e,Ct(t,!0)))}const _t={created(t,{value:e},i){t.checked=(0,s.BX)(e,i.props.value),t[vt]=ft(i),G(t,"change",(()=>{t[vt](xt(t))}))},beforeUpdate(t,{value:e,oldValue:i},n){t[vt]=ft(n),e!==i&&(t.checked=(0,s.BX)(e,n.props.value))}},Et={deep:!0,created(t,{value:e,modifiers:{number:i}},r){const a=(0,s.vM)(e);G(t,"change",(()=>{const e=Array.prototype.filter.call(t.options,(t=>t.selected)).map((t=>i?(0,s.bB)(xt(t)):xt(t)));t[vt](t.multiple?a?new Set(e):e:e[0]),t._assigning=!0,(0,n.dY)((()=>{t._assigning=!1}))})),t[vt]=ft(r)},mounted(t,{value:e,modifiers:{number:i}}){wt(t,e)},beforeUpdate(t,e,i){t[vt]=ft(i)},updated(t,{value:e,modifiers:{number:i}}){t._assigning||wt(t,e)}};function wt(t,e,i){const n=t.multiple,r=(0,s.cy)(e);if(!n||r||(0,s.vM)(e)){for(let i=0,a=t.options.length;i<a;i++){const a=t.options[i],o=xt(a);if(n)if(r){const t=typeof o;a.selected="string"===t||"number"===t?e.some((t=>String(t)===String(o))):(0,s.u3)(e,o)>-1}else a.selected=e.has(o);else if((0,s.BX)(xt(a),e))return void(t.selectedIndex!==i&&(t.selectedIndex=i))}n||-1===t.selectedIndex||(t.selectedIndex=-1)}}function xt(t){return"_value"in t?t._value:t.value}function Ct(t,e){const i=e?"_trueValue":"_falseValue";return i in t?t[i]:e}const St=["ctrl","shift","alt","meta"],Tt={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&0!==t.button,middle:t=>"button"in t&&1!==t.button,right:t=>"button"in t&&2!==t.button,exact:(t,e)=>St.some((i=>t[`${i}Key`]&&!e.includes(i)))},kt=(t,e)=>{const i=t._withMods||(t._withMods={}),n=e.join(".");return i[n]||(i[n]=(i,...n)=>{for(let t=0;t<e.length;t++){const n=Tt[e[t]];if(n&&n(i,e))return}return t(i,...n)})},It=(0,s.X$)({patchProp:nt},h);let Mt;function Lt(){return Mt||(Mt=(0,n.K9)(It))}const Rt=(...t)=>{const e=Lt().createApp(...t);const{mount:i}=e;return e.mount=t=>{const n=Pt(t);if(!n)return;const r=e._component;(0,s.Tn)(r)||r.render||r.template||(r.template=n.innerHTML),n.innerHTML="";const a=i(n,!1,Dt(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),a},e};function Dt(t){return t instanceof SVGElement?"svg":"function"===typeof MathMLElement&&t instanceof MathMLElement?"mathml":void 0}function Pt(t){if((0,s.Kg)(t)){const e=document.querySelector(t);return e}return t}},33:function(t,e,i){
/**
* @vue/shared v3.4.27
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/
/*! #__NO_SIDE_EFFECTS__ */
function n(t,e){const i=new Set(t.split(","));return e?t=>i.has(t.toLowerCase()):t=>i.has(t)}i.d(e,{$3:function(){return p},$H:function(){return N},BH:function(){return G},BX:function(){return it},Bm:function(){return _},C4:function(){return Q},CE:function(){return g},CP:function(){return c},DY:function(){return B},Gv:function(){return E},J$:function(){return Z},Kg:function(){return A},MZ:function(){return s},Mp:function(){return l},NO:function(){return o},Oj:function(){return r},PT:function(){return R},Qd:function(){return T},Ro:function(){return H},SU:function(){return I},TF:function(){return d},Tg:function(){return P},Tn:function(){return y},Tr:function(){return K},We:function(){return z},X$:function(){return h},Y2:function(){return tt},ZH:function(){return O},Zf:function(){return S},bB:function(){return j},cy:function(){return f},gd:function(){return b},pD:function(){return n},rU:function(){return F},tE:function(){return a},u3:function(){return nt},vM:function(){return m},v_:function(){return st},yI:function(){return k},yL:function(){return w},yQ:function(){return U}});const s={},r=[],a=()=>{},o=()=>!1,l=t=>111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),c=t=>t.startsWith("onUpdate:"),h=Object.assign,d=(t,e)=>{const i=t.indexOf(e);i>-1&&t.splice(i,1)},u=Object.prototype.hasOwnProperty,p=(t,e)=>u.call(t,e),f=Array.isArray,g=t=>"[object Map]"===C(t),m=t=>"[object Set]"===C(t),v=t=>"[object Date]"===C(t),b=t=>"[object RegExp]"===C(t),y=t=>"function"===typeof t,A=t=>"string"===typeof t,_=t=>"symbol"===typeof t,E=t=>null!==t&&"object"===typeof t,w=t=>(E(t)||y(t))&&y(t.then)&&y(t.catch),x=Object.prototype.toString,C=t=>x.call(t),S=t=>C(t).slice(8,-1),T=t=>"[object Object]"===C(t),k=t=>A(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,I=n(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),M=t=>{const e=Object.create(null);return i=>{const n=e[i];return n||(e[i]=t(i))}},L=/-(\w)/g,R=M((t=>t.replace(L,((t,e)=>e?e.toUpperCase():"")))),D=/\B([A-Z])/g,P=M((t=>t.replace(D,"-$1").toLowerCase())),O=M((t=>t.charAt(0).toUpperCase()+t.slice(1))),F=M((t=>{const e=t?`on${O(t)}`:"";return e})),N=(t,e)=>!Object.is(t,e),B=(t,e)=>{for(let i=0;i<t.length;i++)t[i](e)},U=(t,e,i,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:i})},j=t=>{const e=parseFloat(t);return isNaN(e)?t:e},H=t=>{const e=A(t)?Number(t):NaN;return isNaN(e)?t:e};let $;const z=()=>$||($="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof i.g?i.g:{});const V="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error",G=n(V);function K(t){if(f(t)){const e={};for(let i=0;i<t.length;i++){const n=t[i],s=A(n)?Y(n):K(n);if(s)for(const t in s)e[t]=s[t]}return e}if(A(t)||E(t))return t}const W=/;(?![^(]*\))/g,q=/:([^]+)/,X=/\/\*[^]*?\*\//g;function Y(t){const e={};return t.replace(X,"").split(W).forEach((t=>{if(t){const i=t.split(q);i.length>1&&(e[i[0].trim()]=i[1].trim())}})),e}function Q(t){let e="";if(A(t))e=t;else if(f(t))for(let i=0;i<t.length;i++){const n=Q(t[i]);n&&(e+=n+" ")}else if(E(t))for(const i in t)t[i]&&(e+=i+" ");return e.trim()}const J="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Z=n(J);function tt(t){return!!t||""===t}function et(t,e){if(t.length!==e.length)return!1;let i=!0;for(let n=0;i&&n<t.length;n++)i=it(t[n],e[n]);return i}function it(t,e){if(t===e)return!0;let i=v(t),n=v(e);if(i||n)return!(!i||!n)&&t.getTime()===e.getTime();if(i=_(t),n=_(e),i||n)return t===e;if(i=f(t),n=f(e),i||n)return!(!i||!n)&&et(t,e);if(i=E(t),n=E(e),i||n){if(!i||!n)return!1;const s=Object.keys(t).length,r=Object.keys(e).length;if(s!==r)return!1;for(const i in t){const n=t.hasOwnProperty(i),s=e.hasOwnProperty(i);if(n&&!s||!n&&s||!it(t[i],e[i]))return!1}}return String(t)===String(e)}function nt(t,e){return t.findIndex((t=>it(t,e)))}const st=t=>A(t)?t:null==t?"":f(t)||E(t)&&(t.toString===x||!y(t.toString))?JSON.stringify(t,rt,2):String(t),rt=(t,e)=>e&&e.__v_isRef?rt(t,e.value):g(e)?{[`Map(${e.size})`]:[...e.entries()].reduce(((t,[e,i],n)=>(t[at(e,n)+" =>"]=i,t)),{})}:m(e)?{[`Set(${e.size})`]:[...e.values()].map((t=>at(t)))}:_(e)?at(e):!E(e)||f(e)||T(e)?e:String(e),at=(t,e="")=>{var i;return _(t)?`Symbol(${null!=(i=t.description)?i:e})`:t}},9645:function(t,e,i){i.d(e,{Ay:function(){return Tt}});var n=function(){return n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i],e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},n.apply(this,arguments)};Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function s(t){return"object"==typeof t&&null!==t}function r(t,e){const i=Boolean(t);if(!i)throw new Error(null!=e?e:"Unexpected invariant triggered.")}const a=/\r\n|[\n\r]/g;function o(t,e){let i=0,n=1;for(const s of t.body.matchAll(a)){if("number"===typeof s.index||r(!1),s.index>=e)break;i=s.index+s[0].length,n+=1}return{line:n,column:e+1-i}}function l(t){return c(t.source,o(t.source,t.start))}function c(t,e){const i=t.locationOffset.column-1,n="".padStart(i)+t.body,s=e.line-1,r=t.locationOffset.line-1,a=e.line+r,o=1===e.line?i:0,l=e.column+o,c=`${t.name}:${a}:${l}\n`,d=n.split(/\r\n|[\n\r]/g),u=d[s];if(u.length>120){const t=Math.floor(l/80),e=l%80,i=[];for(let n=0;n<u.length;n+=80)i.push(u.slice(n,n+80));return c+h([[`${a} |`,i[0]],...i.slice(1,t+1).map((t=>["|",t])),["|","^".padStart(e)],["|",i[t+1]]])}return c+h([[a-1+" |",d[s-1]],[`${a} |`,u],["|","^".padStart(l)],[`${a+1} |`,d[s+1]]])}function h(t){const e=t.filter((([t,e])=>void 0!==e)),i=Math.max(...e.map((([t])=>t.length)));return e.map((([t,e])=>t.padStart(i)+(e?" "+e:""))).join("\n")}function d(t){const e=t[0];return null==e||"kind"in e||"length"in e?{nodes:e,source:t[1],positions:t[2],path:t[3],originalError:t[4],extensions:t[5]}:e}class u extends Error{constructor(t,...e){var i,n,r;const{nodes:a,source:l,positions:c,path:h,originalError:f,extensions:g}=d(e);super(t),this.name="GraphQLError",this.path=null!==h&&void 0!==h?h:void 0,this.originalError=null!==f&&void 0!==f?f:void 0,this.nodes=p(Array.isArray(a)?a:a?[a]:void 0);const m=p(null===(i=this.nodes)||void 0===i?void 0:i.map((t=>t.loc)).filter((t=>null!=t)));this.source=null!==l&&void 0!==l?l:null===m||void 0===m||null===(n=m[0])||void 0===n?void 0:n.source,this.positions=null!==c&&void 0!==c?c:null===m||void 0===m?void 0:m.map((t=>t.start)),this.locations=c&&l?c.map((t=>o(l,t))):null===m||void 0===m?void 0:m.map((t=>o(t.source,t.start)));const v=s(null===f||void 0===f?void 0:f.extensions)?null===f||void 0===f?void 0:f.extensions:void 0;this.extensions=null!==(r=null!==g&&void 0!==g?g:v)&&void 0!==r?r:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!==f&&void 0!==f&&f.stack?Object.defineProperty(this,"stack",{value:f.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,u):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let t=this.message;if(this.nodes)for(const e of this.nodes)e.loc&&(t+="\n\n"+l(e.loc));else if(this.source&&this.locations)for(const e of this.locations)t+="\n\n"+c(this.source,e);return t}toJSON(){const t={message:this.message};return null!=this.locations&&(t.locations=this.locations),null!=this.path&&(t.path=this.path),null!=this.extensions&&Object.keys(this.extensions).length>0&&(t.extensions=this.extensions),t}}function p(t){return void 0===t||0===t.length?void 0:t}function f(t,e,i){return new u(`Syntax Error: ${i}`,{source:t,positions:[e]})}class g{constructor(t,e,i){this.start=t.start,this.end=e.end,this.startToken=t,this.endToken=e,this.source=i}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class m{constructor(t,e,i,n,s,r){this.kind=t,this.start=e,this.end=i,this.line=n,this.column=s,this.value=r,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const v={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};new Set(Object.keys(v));var b,y,A,_;function E(t){return 9===t||32===t}function w(t){return t>=48&&t<=57}function x(t){return t>=97&&t<=122||t>=65&&t<=90}function C(t){return x(t)||95===t}function S(t){return x(t)||w(t)||95===t}function T(t){var e;let i=Number.MAX_SAFE_INTEGER,n=null,s=-1;for(let a=0;a<t.length;++a){var r;const e=t[a],o=k(e);o!==e.length&&(n=null!==(r=n)&&void 0!==r?r:a,s=a,0!==a&&o<i&&(i=o))}return t.map(((t,e)=>0===e?t:t.slice(i))).slice(null!==(e=n)&&void 0!==e?e:0,s+1)}function k(t){let e=0;while(e<t.length&&E(t.charCodeAt(e)))++e;return e}(function(t){t["QUERY"]="query",t["MUTATION"]="mutation",t["SUBSCRIPTION"]="subscription"})(b||(b={})),function(t){t["QUERY"]="QUERY",t["MUTATION"]="MUTATION",t["SUBSCRIPTION"]="SUBSCRIPTION",t["FIELD"]="FIELD",t["FRAGMENT_DEFINITION"]="FRAGMENT_DEFINITION",t["FRAGMENT_SPREAD"]="FRAGMENT_SPREAD",t["INLINE_FRAGMENT"]="INLINE_FRAGMENT",t["VARIABLE_DEFINITION"]="VARIABLE_DEFINITION",t["SCHEMA"]="SCHEMA",t["SCALAR"]="SCALAR",t["OBJECT"]="OBJECT",t["FIELD_DEFINITION"]="FIELD_DEFINITION",t["ARGUMENT_DEFINITION"]="ARGUMENT_DEFINITION",t["INTERFACE"]="INTERFACE",t["UNION"]="UNION",t["ENUM"]="ENUM",t["ENUM_VALUE"]="ENUM_VALUE",t["INPUT_OBJECT"]="INPUT_OBJECT",t["INPUT_FIELD_DEFINITION"]="INPUT_FIELD_DEFINITION"}(y||(y={})),function(t){t["NAME"]="Name",t["DOCUMENT"]="Document",t["OPERATION_DEFINITION"]="OperationDefinition",t["VARIABLE_DEFINITION"]="VariableDefinition",t["SELECTION_SET"]="SelectionSet",t["FIELD"]="Field",t["ARGUMENT"]="Argument",t["FRAGMENT_SPREAD"]="FragmentSpread",t["INLINE_FRAGMENT"]="InlineFragment",t["FRAGMENT_DEFINITION"]="FragmentDefinition",t["VARIABLE"]="Variable",t["INT"]="IntValue",t["FLOAT"]="FloatValue",t["STRING"]="StringValue",t["BOOLEAN"]="BooleanValue",t["NULL"]="NullValue",t["ENUM"]="EnumValue",t["LIST"]="ListValue",t["OBJECT"]="ObjectValue",t["OBJECT_FIELD"]="ObjectField",t["DIRECTIVE"]="Directive",t["NAMED_TYPE"]="NamedType",t["LIST_TYPE"]="ListType",t["NON_NULL_TYPE"]="NonNullType",t["SCHEMA_DEFINITION"]="SchemaDefinition",t["OPERATION_TYPE_DEFINITION"]="OperationTypeDefinition",t["SCALAR_TYPE_DEFINITION"]="ScalarTypeDefinition",t["OBJECT_TYPE_DEFINITION"]="ObjectTypeDefinition",t["FIELD_DEFINITION"]="FieldDefinition",t["INPUT_VALUE_DEFINITION"]="InputValueDefinition",t["INTERFACE_TYPE_DEFINITION"]="InterfaceTypeDefinition",t["UNION_TYPE_DEFINITION"]="UnionTypeDefinition",t["ENUM_TYPE_DEFINITION"]="EnumTypeDefinition",t["ENUM_VALUE_DEFINITION"]="EnumValueDefinition",t["INPUT_OBJECT_TYPE_DEFINITION"]="InputObjectTypeDefinition",t["DIRECTIVE_DEFINITION"]="DirectiveDefinition",t["SCHEMA_EXTENSION"]="SchemaExtension",t["SCALAR_TYPE_EXTENSION"]="ScalarTypeExtension",t["OBJECT_TYPE_EXTENSION"]="ObjectTypeExtension",t["INTERFACE_TYPE_EXTENSION"]="InterfaceTypeExtension",t["UNION_TYPE_EXTENSION"]="UnionTypeExtension",t["ENUM_TYPE_EXTENSION"]="EnumTypeExtension",t["INPUT_OBJECT_TYPE_EXTENSION"]="InputObjectTypeExtension"}(A||(A={})),function(t){t["SOF"]="<SOF>",t["EOF"]="<EOF>",t["BANG"]="!",t["DOLLAR"]="$",t["AMP"]="&",t["PAREN_L"]="(",t["PAREN_R"]=")",t["SPREAD"]="...",t["COLON"]=":",t["EQUALS"]="=",t["AT"]="@",t["BRACKET_L"]="[",t["BRACKET_R"]="]",t["BRACE_L"]="{",t["PIPE"]="|",t["BRACE_R"]="}",t["NAME"]="Name",t["INT"]="Int",t["FLOAT"]="Float",t["STRING"]="String",t["BLOCK_STRING"]="BlockString",t["COMMENT"]="Comment"}(_||(_={}));class I{constructor(t){const e=new m(_.SOF,0,0,0,0);this.source=t,this.lastToken=e,this.token=e,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){this.lastToken=this.token;const t=this.token=this.lookahead();return t}lookahead(){let t=this.token;if(t.kind!==_.EOF)do{if(t.next)t=t.next;else{const e=N(this,t.end);t.next=e,e.prev=t,t=e}}while(t.kind===_.COMMENT);return t}}function M(t){return t===_.BANG||t===_.DOLLAR||t===_.AMP||t===_.PAREN_L||t===_.PAREN_R||t===_.SPREAD||t===_.COLON||t===_.EQUALS||t===_.AT||t===_.BRACKET_L||t===_.BRACKET_R||t===_.BRACE_L||t===_.PIPE||t===_.BRACE_R}function L(t){return t>=0&&t<=55295||t>=57344&&t<=1114111}function R(t,e){return D(t.charCodeAt(e))&&P(t.charCodeAt(e+1))}function D(t){return t>=55296&&t<=56319}function P(t){return t>=56320&&t<=57343}function O(t,e){const i=t.source.body.codePointAt(e);if(void 0===i)return _.EOF;if(i>=32&&i<=126){const t=String.fromCodePoint(i);return'"'===t?"'\"'":`"${t}"`}return"U+"+i.toString(16).toUpperCase().padStart(4,"0")}function F(t,e,i,n,s){const r=t.line,a=1+i-t.lineStart;return new m(e,i,n,r,a,s)}function N(t,e){const i=t.source.body,n=i.length;let s=e;while(s<n){const e=i.charCodeAt(s);switch(e){case 65279:case 9:case 32:case 44:++s;continue;case 10:++s,++t.line,t.lineStart=s;continue;case 13:10===i.charCodeAt(s+1)?s+=2:++s,++t.line,t.lineStart=s;continue;case 35:return B(t,s);case 33:return F(t,_.BANG,s,s+1);case 36:return F(t,_.DOLLAR,s,s+1);case 38:return F(t,_.AMP,s,s+1);case 40:return F(t,_.PAREN_L,s,s+1);case 41:return F(t,_.PAREN_R,s,s+1);case 46:if(46===i.charCodeAt(s+1)&&46===i.charCodeAt(s+2))return F(t,_.SPREAD,s,s+3);break;case 58:return F(t,_.COLON,s,s+1);case 61:return F(t,_.EQUALS,s,s+1);case 64:return F(t,_.AT,s,s+1);case 91:return F(t,_.BRACKET_L,s,s+1);case 93:return F(t,_.BRACKET_R,s,s+1);case 123:return F(t,_.BRACE_L,s,s+1);case 124:return F(t,_.PIPE,s,s+1);case 125:return F(t,_.BRACE_R,s,s+1);case 34:return 34===i.charCodeAt(s+1)&&34===i.charCodeAt(s+2)?W(t,s):H(t,s)}if(w(e)||45===e)return U(t,s,e);if(C(e))return q(t,s);throw f(t.source,s,39===e?"Unexpected single quote character ('), did you mean to use a double quote (\")?":L(e)||R(i,s)?`Unexpected character: ${O(t,s)}.`:`Invalid character: ${O(t,s)}.`)}return F(t,_.EOF,n,n)}function B(t,e){const i=t.source.body,n=i.length;let s=e+1;while(s<n){const t=i.charCodeAt(s);if(10===t||13===t)break;if(L(t))++s;else{if(!R(i,s))break;s+=2}}return F(t,_.COMMENT,e,s,i.slice(e+1,s))}function U(t,e,i){const n=t.source.body;let s=e,r=i,a=!1;if(45===r&&(r=n.charCodeAt(++s)),48===r){if(r=n.charCodeAt(++s),w(r))throw f(t.source,s,`Invalid number, unexpected digit after 0: ${O(t,s)}.`)}else s=j(t,s,r),r=n.charCodeAt(s);if(46===r&&(a=!0,r=n.charCodeAt(++s),s=j(t,s,r),r=n.charCodeAt(s)),69!==r&&101!==r||(a=!0,r=n.charCodeAt(++s),43!==r&&45!==r||(r=n.charCodeAt(++s)),s=j(t,s,r),r=n.charCodeAt(s)),46===r||C(r))throw f(t.source,s,`Invalid number, expected digit but got: ${O(t,s)}.`);return F(t,a?_.FLOAT:_.INT,e,s,n.slice(e,s))}function j(t,e,i){if(!w(i))throw f(t.source,e,`Invalid number, expected digit but got: ${O(t,e)}.`);const n=t.source.body;let s=e+1;while(w(n.charCodeAt(s)))++s;return s}function H(t,e){const i=t.source.body,n=i.length;let s=e+1,r=s,a="";while(s<n){const n=i.charCodeAt(s);if(34===n)return a+=i.slice(r,s),F(t,_.STRING,e,s+1,a);if(92!==n){if(10===n||13===n)break;if(L(n))++s;else{if(!R(i,s))throw f(t.source,s,`Invalid character within String: ${O(t,s)}.`);s+=2}}else{a+=i.slice(r,s);const e=117===i.charCodeAt(s+1)?123===i.charCodeAt(s+2)?$(t,s):z(t,s):K(t,s);a+=e.value,s+=e.size,r=s}}throw f(t.source,s,"Unterminated string.")}function $(t,e){const i=t.source.body;let n=0,s=3;while(s<12){const t=i.charCodeAt(e+s++);if(125===t){if(s<5||!L(n))break;return{value:String.fromCodePoint(n),size:s}}if(n=n<<4|G(t),n<0)break}throw f(t.source,e,`Invalid Unicode escape sequence: "${i.slice(e,e+s)}".`)}function z(t,e){const i=t.source.body,n=V(i,e+2);if(L(n))return{value:String.fromCodePoint(n),size:6};if(D(n)&&92===i.charCodeAt(e+6)&&117===i.charCodeAt(e+7)){const t=V(i,e+8);if(P(t))return{value:String.fromCodePoint(n,t),size:12}}throw f(t.source,e,`Invalid Unicode escape sequence: "${i.slice(e,e+6)}".`)}function V(t,e){return G(t.charCodeAt(e))<<12|G(t.charCodeAt(e+1))<<8|G(t.charCodeAt(e+2))<<4|G(t.charCodeAt(e+3))}function G(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:-1}function K(t,e){const i=t.source.body,n=i.charCodeAt(e+1);switch(n){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:"\n",size:2};case 114:return{value:"\r",size:2};case 116:return{value:"\t",size:2}}throw f(t.source,e,`Invalid character escape sequence: "${i.slice(e,e+2)}".`)}function W(t,e){const i=t.source.body,n=i.length;let s=t.lineStart,r=e+3,a=r,o="";const l=[];while(r<n){const n=i.charCodeAt(r);if(34===n&&34===i.charCodeAt(r+1)&&34===i.charCodeAt(r+2)){o+=i.slice(a,r),l.push(o);const n=F(t,_.BLOCK_STRING,e,r+3,T(l).join("\n"));return t.line+=l.length-1,t.lineStart=s,n}if(92!==n||34!==i.charCodeAt(r+1)||34!==i.charCodeAt(r+2)||34!==i.charCodeAt(r+3))if(10!==n&&13!==n)if(L(n))++r;else{if(!R(i,r))throw f(t.source,r,`Invalid character within String: ${O(t,r)}.`);r+=2}else o+=i.slice(a,r),l.push(o),13===n&&10===i.charCodeAt(r+1)?r+=2:++r,o="",a=r,s=r;else o+=i.slice(a,r),a=r+1,r+=4}throw f(t.source,r,"Unterminated string.")}function q(t,e){const i=t.source.body,n=i.length;let s=e+1;while(s<n){const t=i.charCodeAt(s);if(!S(t))break;++s}return F(t,_.NAME,e,s,i.slice(e,s))}function X(t,e){const i=Boolean(t);if(!i)throw new Error(e)}const Y=10,Q=2;function J(t){return Z(t,[])}function Z(t,e){switch(typeof t){case"string":return JSON.stringify(t);case"function":return t.name?`[function ${t.name}]`:"[function]";case"object":return tt(t,e);default:return String(t)}}function tt(t,e){if(null===t)return"null";if(e.includes(t))return"[Circular]";const i=[...e,t];if(et(t)){const e=t.toJSON();if(e!==t)return"string"===typeof e?e:Z(e,i)}else if(Array.isArray(t))return nt(t,i);return it(t,i)}function et(t){return"function"===typeof t.toJSON}function it(t,e){const i=Object.entries(t);if(0===i.length)return"{}";if(e.length>Q)return"["+st(t)+"]";const n=i.map((([t,i])=>t+": "+Z(i,e)));return"{ "+n.join(", ")+" }"}function nt(t,e){if(0===t.length)return"[]";if(e.length>Q)return"[Array]";const i=Math.min(Y,t.length),n=t.length-i,s=[];for(let r=0;r<i;++r)s.push(Z(t[r],e));return 1===n?s.push("... 1 more item"):n>1&&s.push(`... ${n} more items`),"["+s.join(", ")+"]"}function st(t){const e=Object.prototype.toString.call(t).replace(/^\[object /,"").replace(/]$/,"");if("Object"===e&&"function"===typeof t.constructor){const e=t.constructor.name;if("string"===typeof e&&""!==e)return e}return e}const rt=globalThis.process&&"production"===globalThis.process.env.NODE_ENV?function(t,e){return t instanceof e}:function(t,e){if(t instanceof e)return!0;if("object"===typeof t&&null!==t){var i;const n=e.prototype[Symbol.toStringTag],s=Symbol.toStringTag in t?t[Symbol.toStringTag]:null===(i=t.constructor)||void 0===i?void 0:i.name;if(n===s){const e=J(t);throw new Error(`Cannot use ${n} "${e}" from another module or realm.\n\nEnsure that there is only one instance of "graphql" in the node_modules\ndirectory. If different versions of "graphql" are the dependencies of other\nrelied on modules, use "resolutions" to ensure only one version is installed.\n\nhttps://yarnpkg.com/en/docs/selective-version-resolutions\n\nDuplicate "graphql" modules cannot be used at the same time since different\nversions may have different capabilities and behavior. The data from one\nversion used in the function from another could produce confusing and\nspurious results.`)}}return!1};class at{constructor(t,e="GraphQL request",i={line:1,column:1}){"string"===typeof t||X(!1,`Body must be a string. Received: ${J(t)}.`),this.body=t,this.name=e,this.locationOffset=i,this.locationOffset.line>0||X(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||X(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function ot(t){return rt(t,at)}function lt(t,e){const i=new ct(t,e);return i.parseDocument()}class ct{constructor(t,e={}){const i=ot(t)?t:new at(t);this._lexer=new I(i),this._options=e,this._tokenCounter=0}parseName(){const t=this.expectToken(_.NAME);return this.node(t,{kind:A.NAME,value:t.value})}parseDocument(){return this.node(this._lexer.token,{kind:A.DOCUMENT,definitions:this.many(_.SOF,this.parseDefinition,_.EOF)})}parseDefinition(){if(this.peek(_.BRACE_L))return this.parseOperationDefinition();const t=this.peekDescription(),e=t?this._lexer.lookahead():this._lexer.token;if(e.kind===_.NAME){switch(e.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(t)throw f(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(e.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(e)}parseOperationDefinition(){const t=this._lexer.token;if(this.peek(_.BRACE_L))return this.node(t,{kind:A.OPERATION_DEFINITION,operation:b.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const e=this.parseOperationType();let i;return this.peek(_.NAME)&&(i=this.parseName()),this.node(t,{kind:A.OPERATION_DEFINITION,operation:e,name:i,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const t=this.expectToken(_.NAME);switch(t.value){case"query":return b.QUERY;case"mutation":return b.MUTATION;case"subscription":return b.SUBSCRIPTION}throw this.unexpected(t)}parseVariableDefinitions(){return this.optionalMany(_.PAREN_L,this.parseVariableDefinition,_.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:A.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(_.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(_.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const t=this._lexer.token;return this.expectToken(_.DOLLAR),this.node(t,{kind:A.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:A.SELECTION_SET,selections:this.many(_.BRACE_L,this.parseSelection,_.BRACE_R)})}parseSelection(){return this.peek(_.SPREAD)?this.parseFragment():this.parseField()}parseField(){const t=this._lexer.token,e=this.parseName();let i,n;return this.expectOptionalToken(_.COLON)?(i=e,n=this.parseName()):n=e,this.node(t,{kind:A.FIELD,alias:i,name:n,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(_.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(t){const e=t?this.parseConstArgument:this.parseArgument;return this.optionalMany(_.PAREN_L,e,_.PAREN_R)}parseArgument(t=!1){const e=this._lexer.token,i=this.parseName();return this.expectToken(_.COLON),this.node(e,{kind:A.ARGUMENT,name:i,value:this.parseValueLiteral(t)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const t=this._lexer.token;this.expectToken(_.SPREAD);const e=this.expectOptionalKeyword("on");return!e&&this.peek(_.NAME)?this.node(t,{kind:A.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(t,{kind:A.INLINE_FRAGMENT,typeCondition:e?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const t=this._lexer.token;return this.expectKeyword("fragment"),!0===this._options.allowLegacyFragmentVariables?this.node(t,{kind:A.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(t,{kind:A.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()}parseValueLiteral(t){const e=this._lexer.token;switch(e.kind){case _.BRACKET_L:return this.parseList(t);case _.BRACE_L:return this.parseObject(t);case _.INT:return this.advanceLexer(),this.node(e,{kind:A.INT,value:e.value});case _.FLOAT:return this.advanceLexer(),this.node(e,{kind:A.FLOAT,value:e.value});case _.STRING:case _.BLOCK_STRING:return this.parseStringLiteral();case _.NAME:switch(this.advanceLexer(),e.value){case"true":return this.node(e,{kind:A.BOOLEAN,value:!0});case"false":return this.node(e,{kind:A.BOOLEAN,value:!1});case"null":return this.node(e,{kind:A.NULL});default:return this.node(e,{kind:A.ENUM,value:e.value})}case _.DOLLAR:if(t){if(this.expectToken(_.DOLLAR),this._lexer.token.kind===_.NAME){const t=this._lexer.token.value;throw f(this._lexer.source,e.start,`Unexpected variable "$${t}" in constant value.`)}throw this.unexpected(e)}return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const t=this._lexer.token;return this.advanceLexer(),this.node(t,{kind:A.STRING,value:t.value,block:t.kind===_.BLOCK_STRING})}parseList(t){const e=()=>this.parseValueLiteral(t);return this.node(this._lexer.token,{kind:A.LIST,values:this.any(_.BRACKET_L,e,_.BRACKET_R)})}parseObject(t){const e=()=>this.parseObjectField(t);return this.node(this._lexer.token,{kind:A.OBJECT,fields:this.any(_.BRACE_L,e,_.BRACE_R)})}parseObjectField(t){const e=this._lexer.token,i=this.parseName();return this.expectToken(_.COLON),this.node(e,{kind:A.OBJECT_FIELD,name:i,value:this.parseValueLiteral(t)})}parseDirectives(t){const e=[];while(this.peek(_.AT))e.push(this.parseDirective(t));return e}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(t){const e=this._lexer.token;return this.expectToken(_.AT),this.node(e,{kind:A.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(t)})}parseTypeReference(){const t=this._lexer.token;let e;if(this.expectOptionalToken(_.BRACKET_L)){const i=this.parseTypeReference();this.expectToken(_.BRACKET_R),e=this.node(t,{kind:A.LIST_TYPE,type:i})}else e=this.parseNamedType();return this.expectOptionalToken(_.BANG)?this.node(t,{kind:A.NON_NULL_TYPE,type:e}):e}parseNamedType(){return this.node(this._lexer.token,{kind:A.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(_.STRING)||this.peek(_.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("schema");const i=this.parseConstDirectives(),n=this.many(_.BRACE_L,this.parseOperationTypeDefinition,_.BRACE_R);return this.node(t,{kind:A.SCHEMA_DEFINITION,description:e,directives:i,operationTypes:n})}parseOperationTypeDefinition(){const t=this._lexer.token,e=this.parseOperationType();this.expectToken(_.COLON);const i=this.parseNamedType();return this.node(t,{kind:A.OPERATION_TYPE_DEFINITION,operation:e,type:i})}parseScalarTypeDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("scalar");const i=this.parseName(),n=this.parseConstDirectives();return this.node(t,{kind:A.SCALAR_TYPE_DEFINITION,description:e,name:i,directives:n})}parseObjectTypeDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("type");const i=this.parseName(),n=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),r=this.parseFieldsDefinition();return this.node(t,{kind:A.OBJECT_TYPE_DEFINITION,description:e,name:i,interfaces:n,directives:s,fields:r})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(_.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(_.BRACE_L,this.parseFieldDefinition,_.BRACE_R)}parseFieldDefinition(){const t=this._lexer.token,e=this.parseDescription(),i=this.parseName(),n=this.parseArgumentDefs();this.expectToken(_.COLON);const s=this.parseTypeReference(),r=this.parseConstDirectives();return this.node(t,{kind:A.FIELD_DEFINITION,description:e,name:i,arguments:n,type:s,directives:r})}parseArgumentDefs(){return this.optionalMany(_.PAREN_L,this.parseInputValueDef,_.PAREN_R)}parseInputValueDef(){const t=this._lexer.token,e=this.parseDescription(),i=this.parseName();this.expectToken(_.COLON);const n=this.parseTypeReference();let s;this.expectOptionalToken(_.EQUALS)&&(s=this.parseConstValueLiteral());const r=this.parseConstDirectives();return this.node(t,{kind:A.INPUT_VALUE_DEFINITION,description:e,name:i,type:n,defaultValue:s,directives:r})}parseInterfaceTypeDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("interface");const i=this.parseName(),n=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),r=this.parseFieldsDefinition();return this.node(t,{kind:A.INTERFACE_TYPE_DEFINITION,description:e,name:i,interfaces:n,directives:s,fields:r})}parseUnionTypeDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("union");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseUnionMemberTypes();return this.node(t,{kind:A.UNION_TYPE_DEFINITION,description:e,name:i,directives:n,types:s})}parseUnionMemberTypes(){return this.expectOptionalToken(_.EQUALS)?this.delimitedMany(_.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("enum");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();return this.node(t,{kind:A.ENUM_TYPE_DEFINITION,description:e,name:i,directives:n,values:s})}parseEnumValuesDefinition(){return this.optionalMany(_.BRACE_L,this.parseEnumValueDefinition,_.BRACE_R)}parseEnumValueDefinition(){const t=this._lexer.token,e=this.parseDescription(),i=this.parseEnumValueName(),n=this.parseConstDirectives();return this.node(t,{kind:A.ENUM_VALUE_DEFINITION,description:e,name:i,directives:n})}parseEnumValueName(){if("true"===this._lexer.token.value||"false"===this._lexer.token.value||"null"===this._lexer.token.value)throw f(this._lexer.source,this._lexer.token.start,`${ht(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("input");const i=this.parseName(),n=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();return this.node(t,{kind:A.INPUT_OBJECT_TYPE_DEFINITION,description:e,name:i,directives:n,fields:s})}parseInputFieldsDefinition(){return this.optionalMany(_.BRACE_L,this.parseInputValueDef,_.BRACE_R)}parseTypeSystemExtension(){const t=this._lexer.lookahead();if(t.kind===_.NAME)switch(t.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(t)}parseSchemaExtension(){const t=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const e=this.parseConstDirectives(),i=this.optionalMany(_.BRACE_L,this.parseOperationTypeDefinition,_.BRACE_R);if(0===e.length&&0===i.length)throw this.unexpected();return this.node(t,{kind:A.SCHEMA_EXTENSION,directives:e,operationTypes:i})}parseScalarTypeExtension(){const t=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const e=this.parseName(),i=this.parseConstDirectives();if(0===i.length)throw this.unexpected();return this.node(t,{kind:A.SCALAR_TYPE_EXTENSION,name:e,directives:i})}parseObjectTypeExtension(){const t=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const e=this.parseName(),i=this.parseImplementsInterfaces(),n=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(0===i.length&&0===n.length&&0===s.length)throw this.unexpected();return this.node(t,{kind:A.OBJECT_TYPE_EXTENSION,name:e,interfaces:i,directives:n,fields:s})}parseInterfaceTypeExtension(){const t=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const e=this.parseName(),i=this.parseImplementsInterfaces(),n=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(0===i.length&&0===n.length&&0===s.length)throw this.unexpected();return this.node(t,{kind:A.INTERFACE_TYPE_EXTENSION,name:e,interfaces:i,directives:n,fields:s})}parseUnionTypeExtension(){const t=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const e=this.parseName(),i=this.parseConstDirectives(),n=this.parseUnionMemberTypes();if(0===i.length&&0===n.length)throw this.unexpected();return this.node(t,{kind:A.UNION_TYPE_EXTENSION,name:e,directives:i,types:n})}parseEnumTypeExtension(){const t=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const e=this.parseName(),i=this.parseConstDirectives(),n=this.parseEnumValuesDefinition();if(0===i.length&&0===n.length)throw this.unexpected();return this.node(t,{kind:A.ENUM_TYPE_EXTENSION,name:e,directives:i,values:n})}parseInputObjectTypeExtension(){const t=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const e=this.parseName(),i=this.parseConstDirectives(),n=this.parseInputFieldsDefinition();if(0===i.length&&0===n.length)throw this.unexpected();return this.node(t,{kind:A.INPUT_OBJECT_TYPE_EXTENSION,name:e,directives:i,fields:n})}parseDirectiveDefinition(){const t=this._lexer.token,e=this.parseDescription();this.expectKeyword("directive"),this.expectToken(_.AT);const i=this.parseName(),n=this.parseArgumentDefs(),s=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const r=this.parseDirectiveLocations();return this.node(t,{kind:A.DIRECTIVE_DEFINITION,description:e,name:i,arguments:n,repeatable:s,locations:r})}parseDirectiveLocations(){return this.delimitedMany(_.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const t=this._lexer.token,e=this.parseName();if(Object.prototype.hasOwnProperty.call(y,e.value))return e;throw this.unexpected(t)}node(t,e){return!0!==this._options.noLocation&&(e.loc=new g(t,this._lexer.lastToken,this._lexer.source)),e}peek(t){return this._lexer.token.kind===t}expectToken(t){const e=this._lexer.token;if(e.kind===t)return this.advanceLexer(),e;throw f(this._lexer.source,e.start,`Expected ${dt(t)}, found ${ht(e)}.`)}expectOptionalToken(t){const e=this._lexer.token;return e.kind===t&&(this.advanceLexer(),!0)}expectKeyword(t){const e=this._lexer.token;if(e.kind!==_.NAME||e.value!==t)throw f(this._lexer.source,e.start,`Expected "${t}", found ${ht(e)}.`);this.advanceLexer()}expectOptionalKeyword(t){const e=this._lexer.token;return e.kind===_.NAME&&e.value===t&&(this.advanceLexer(),!0)}unexpected(t){const e=null!==t&&void 0!==t?t:this._lexer.token;return f(this._lexer.source,e.start,`Unexpected ${ht(e)}.`)}any(t,e,i){this.expectToken(t);const n=[];while(!this.expectOptionalToken(i))n.push(e.call(this));return n}optionalMany(t,e,i){if(this.expectOptionalToken(t)){const t=[];do{t.push(e.call(this))}while(!this.expectOptionalToken(i));return t}return[]}many(t,e,i){this.expectToken(t);const n=[];do{n.push(e.call(this))}while(!this.expectOptionalToken(i));return n}delimitedMany(t,e){this.expectOptionalToken(t);const i=[];do{i.push(e.call(this))}while(this.expectOptionalToken(t));return i}advanceLexer(){const{maxTokens:t}=this._options,e=this._lexer.advance();if(void 0!==t&&e.kind!==_.EOF&&(++this._tokenCounter,this._tokenCounter>t))throw f(this._lexer.source,e.start,`Document contains more that ${t} tokens. Parsing aborted.`)}}function ht(t){const e=t.value;return dt(t.kind)+(null!=e?` "${e}"`:"")}function dt(t){return M(t)?`"${t}"`:t}var ut=new Map,pt=new Map,ft=!0,gt=!1;function mt(t){return t.replace(/[\s,]+/g," ").trim()}function vt(t){return mt(t.source.body.substring(t.start,t.end))}function bt(t){var e=new Set,i=[];return t.definitions.forEach((function(t){if("FragmentDefinition"===t.kind){var n=t.name.value,s=vt(t.loc),r=pt.get(n);r&&!r.has(s)?ft&&console.warn("Warning: fragment with name "+n+" already exists.\ngraphql-tag enforces all fragment names across your application to be unique; read more about\nthis in the docs: http://dev.apollodata.com/core/fragments.html#unique-names"):r||pt.set(n,r=new Set),r.add(s),e.has(s)||(e.add(s),i.push(t))}else i.push(t)})),n(n({},t),{definitions:i})}function yt(t){var e=new Set(t.definitions);e.forEach((function(t){t.loc&&delete t.loc,Object.keys(t).forEach((function(i){var n=t[i];n&&"object"===typeof n&&e.add(n)}))}));var i=t.loc;return i&&(delete i.startToken,delete i.endToken),t}function At(t){var e=mt(t);if(!ut.has(e)){var i=lt(t,{experimentalFragmentVariables:gt,allowLegacyFragmentVariables:gt});if(!i||"Document"!==i.kind)throw new Error("Not a valid GraphQL document.");ut.set(e,yt(bt(i)))}return ut.get(e)}function _t(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];"string"===typeof t&&(t=[t]);var n=t[0];return e.forEach((function(e,i){e&&"Document"===e.kind?n+=e.loc.source.body:n+=e,n+=t[i+1]})),At(n)}function Et(){ut.clear(),pt.clear()}function wt(){ft=!1}function xt(){gt=!0}function Ct(){gt=!1}var St={gql:_t,resetCaches:Et,disableFragmentWarnings:wt,enableExperimentalFragmentVariables:xt,disableExperimentalFragmentVariables:Ct};(function(t){t.gql=St.gql,t.resetCaches=St.resetCaches,t.disableFragmentWarnings=St.disableFragmentWarnings,t.enableExperimentalFragmentVariables=St.enableExperimentalFragmentVariables,t.disableExperimentalFragmentVariables=St.disableExperimentalFragmentVariables})(_t||(_t={})),_t["default"]=_t;var Tt=_t},6262:function(t,e){e.A=(t,e)=>{const i=t.__vccOpts||t;for(const[n,s]of e)i[n]=s;return i}},9306:function(t,e,i){var n=i(4901),s=i(6823),r=TypeError;t.exports=function(t){if(n(t))return t;throw new r(s(t)+" is not a function")}},8551:function(t,e,i){var n=i(34),s=String,r=TypeError;t.exports=function(t){if(n(t))return t;throw new r(s(t)+" is not an object")}},9617:function(t,e,i){var n=i(5397),s=i(5610),r=i(6198),a=function(t){return function(e,i,a){var o=n(e),l=r(o);if(0===l)return!t&&-1;var c,h=s(a,l);if(t&&i!==i){while(l>h)if(c=o[h++],c!==c)return!0}else for(;l>h;h++)if((t||h in o)&&o[h]===i)return t||h||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},4527:function(t,e,i){var n=i(3724),s=i(4376),r=TypeError,a=Object.getOwnPropertyDescriptor,o=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=o?function(t,e){if(s(t)&&!a(t,"length").writable)throw new r("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},4576:function(t,e,i){var n=i(9504),s=n({}.toString),r=n("".slice);t.exports=function(t){return r(s(t),8,-1)}},6955:function(t,e,i){var n=i(2140),s=i(4901),r=i(4576),a=i(8227),o=a("toStringTag"),l=Object,c="Arguments"===r(function(){return arguments}()),h=function(t,e){try{return t[e]}catch(i){}};t.exports=n?r:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=h(e=l(t),o))?i:c?r(e):"Object"===(n=r(e))&&s(e.callee)?"Arguments":n}},7740:function(t,e,i){var n=i(9297),s=i(5031),r=i(7347),a=i(4913);t.exports=function(t,e,i){for(var o=s(e),l=a.f,c=r.f,h=0;h<o.length;h++){var d=o[h];n(t,d)||i&&n(i,d)||l(t,d,c(e,d))}}},6699:function(t,e,i){var n=i(3724),s=i(4913),r=i(6980);t.exports=n?function(t,e,i){return s.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},6980:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2106:function(t,e,i){var n=i(283),s=i(4913);t.exports=function(t,e,i){return i.get&&n(i.get,e,{getter:!0}),i.set&&n(i.set,e,{setter:!0}),s.f(t,e,i)}},6840:function(t,e,i){var n=i(4901),s=i(4913),r=i(283),a=i(9433);t.exports=function(t,e,i,o){o||(o={});var l=o.enumerable,c=void 0!==o.name?o.name:e;if(n(i)&&r(i,c,o),o.global)l?t[e]=i:a(e,i);else{try{o.unsafe?t[e]&&(l=!0):delete t[e]}catch(h){}l?t[e]=i:s.f(t,e,{value:i,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return t}},9433:function(t,e,i){var n=i(4475),s=Object.defineProperty;t.exports=function(t,e){try{s(n,t,{value:e,configurable:!0,writable:!0})}catch(i){n[t]=e}return e}},3724:function(t,e,i){var n=i(9039);t.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4055:function(t,e,i){var n=i(4475),s=i(34),r=n.document,a=s(r)&&s(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},6837:function(t){var e=TypeError,i=9007199254740991;t.exports=function(t){if(t>i)throw e("Maximum allowed index exceeded");return t}},9392:function(t){t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7388:function(t,e,i){var n,s,r=i(4475),a=i(9392),o=r.process,l=r.Deno,c=o&&o.versions||l&&l.version,h=c&&c.v8;h&&(n=h.split("."),s=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!s&&a&&(n=a.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/),n&&(s=+n[1]))),t.exports=s},8727:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6518:function(t,e,i){var n=i(4475),s=i(7347).f,r=i(6699),a=i(6840),o=i(9433),l=i(7740),c=i(2796);t.exports=function(t,e){var i,h,d,u,p,f,g=t.target,m=t.global,v=t.stat;if(h=m?n:v?n[g]||o(g,{}):n[g]&&n[g].prototype,h)for(d in e){if(p=e[d],t.dontCallGetSet?(f=s(h,d),u=f&&f.value):u=h[d],i=c(m?d:g+(v?".":"#")+d,t.forced),!i&&void 0!==u){if(typeof p==typeof u)continue;l(p,u)}(t.sham||u&&u.sham)&&r(p,"sham",!0),a(h,d,p,t)}}},9039:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},616:function(t,e,i){var n=i(9039);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},9565:function(t,e,i){var n=i(616),s=Function.prototype.call;t.exports=n?s.bind(s):function(){return s.apply(s,arguments)}},350:function(t,e,i){var n=i(3724),s=i(9297),r=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,o=s(r,"name"),l=o&&"something"===function(){}.name,c=o&&(!n||n&&a(r,"name").configurable);t.exports={EXISTS:o,PROPER:l,CONFIGURABLE:c}},9504:function(t,e,i){var n=i(616),s=Function.prototype,r=s.call,a=n&&s.bind.bind(r,r);t.exports=n?a:function(t){return function(){return r.apply(t,arguments)}}},7751:function(t,e,i){var n=i(4475),s=i(4901),r=function(t){return s(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?r(n[t]):n[t]&&n[t][e]}},5966:function(t,e,i){var n=i(9306),s=i(4117);t.exports=function(t,e){var i=t[e];return s(i)?void 0:n(i)}},4475:function(t,e,i){var n=function(t){return t&&t.Math===Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof i.g&&i.g)||n("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:function(t,e,i){var n=i(9504),s=i(8981),r=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return r(s(t),e)}},421:function(t){t.exports={}},5917:function(t,e,i){var n=i(3724),s=i(9039),r=i(4055);t.exports=!n&&!s((function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},7055:function(t,e,i){var n=i(9504),s=i(9039),r=i(4576),a=Object,o=n("".split);t.exports=s((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"===r(t)?o(t,""):a(t)}:a},3706:function(t,e,i){var n=i(9504),s=i(4901),r=i(7629),a=n(Function.toString);s(r.inspectSource)||(r.inspectSource=function(t){return a(t)}),t.exports=r.inspectSource},1181:function(t,e,i){var n,s,r,a=i(8622),o=i(4475),l=i(34),c=i(6699),h=i(9297),d=i(7629),u=i(6119),p=i(421),f="Object already initialized",g=o.TypeError,m=o.WeakMap,v=function(t){return r(t)?s(t):n(t,{})},b=function(t){return function(e){var i;if(!l(e)||(i=s(e)).type!==t)throw new g("Incompatible receiver, "+t+" required");return i}};if(a||d.state){var y=d.state||(d.state=new m);y.get=y.get,y.has=y.has,y.set=y.set,n=function(t,e){if(y.has(t))throw new g(f);return e.facade=t,y.set(t,e),e},s=function(t){return y.get(t)||{}},r=function(t){return y.has(t)}}else{var A=u("state");p[A]=!0,n=function(t,e){if(h(t,A))throw new g(f);return e.facade=t,c(t,A,e),e},s=function(t){return h(t,A)?t[A]:{}},r=function(t){return h(t,A)}}t.exports={set:n,get:s,has:r,enforce:v,getterFor:b}},4376:function(t,e,i){var n=i(4576);t.exports=Array.isArray||function(t){return"Array"===n(t)}},4901:function(t){var e="object"==typeof document&&document.all;t.exports="undefined"==typeof e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},2796:function(t,e,i){var n=i(9039),s=i(4901),r=/#|\.prototype\./,a=function(t,e){var i=l[o(t)];return i===h||i!==c&&(s(e)?n(e):!!e)},o=a.normalize=function(t){return String(t).replace(r,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",h=a.POLYFILL="P";t.exports=a},4117:function(t){t.exports=function(t){return null===t||void 0===t}},34:function(t,e,i){var n=i(4901);t.exports=function(t){return"object"==typeof t?null!==t:n(t)}},6395:function(t){t.exports=!1},757:function(t,e,i){var n=i(7751),s=i(4901),r=i(1625),a=i(7040),o=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return s(e)&&r(e.prototype,o(t))}},6198:function(t,e,i){var n=i(8014);t.exports=function(t){return n(t.length)}},283:function(t,e,i){var n=i(9504),s=i(9039),r=i(4901),a=i(9297),o=i(3724),l=i(350).CONFIGURABLE,c=i(3706),h=i(1181),d=h.enforce,u=h.get,p=String,f=Object.defineProperty,g=n("".slice),m=n("".replace),v=n([].join),b=o&&!s((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),A=t.exports=function(t,e,i){"Symbol("===g(p(e),0,7)&&(e="["+m(p(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!a(t,"name")||l&&t.name!==e)&&(o?f(t,"name",{value:e,configurable:!0}):t.name=e),b&&i&&a(i,"arity")&&t.length!==i.arity&&f(t,"length",{value:i.arity});try{i&&a(i,"constructor")&&i.constructor?o&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(s){}var n=d(t);return a(n,"source")||(n.source=v(y,"string"==typeof e?e:"")),t};Function.prototype.toString=A((function(){return r(this)&&u(this).source||c(this)}),"toString")},741:function(t){var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?i:e)(n)}},4913:function(t,e,i){var n=i(3724),s=i(5917),r=i(8686),a=i(8551),o=i(6969),l=TypeError,c=Object.defineProperty,h=Object.getOwnPropertyDescriptor,d="enumerable",u="configurable",p="writable";e.f=n?r?function(t,e,i){if(a(t),e=o(e),a(i),"function"===typeof t&&"prototype"===e&&"value"in i&&p in i&&!i[p]){var n=h(t,e);n&&n[p]&&(t[e]=i.value,i={configurable:u in i?i[u]:n[u],enumerable:d in i?i[d]:n[d],writable:!1})}return c(t,e,i)}:c:function(t,e,i){if(a(t),e=o(e),a(i),s)try{return c(t,e,i)}catch(n){}if("get"in i||"set"in i)throw new l("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},7347:function(t,e,i){var n=i(3724),s=i(9565),r=i(8773),a=i(6980),o=i(5397),l=i(6969),c=i(9297),h=i(5917),d=Object.getOwnPropertyDescriptor;e.f=n?d:function(t,e){if(t=o(t),e=l(e),h)try{return d(t,e)}catch(i){}if(c(t,e))return a(!s(r.f,t,e),t[e])}},8480:function(t,e,i){var n=i(1828),s=i(8727),r=s.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,r)}},3717:function(t,e){e.f=Object.getOwnPropertySymbols},1625:function(t,e,i){var n=i(9504);t.exports=n({}.isPrototypeOf)},1828:function(t,e,i){var n=i(9504),s=i(9297),r=i(5397),a=i(9617).indexOf,o=i(421),l=n([].push);t.exports=function(t,e){var i,n=r(t),c=0,h=[];for(i in n)!s(o,i)&&s(n,i)&&l(h,i);while(e.length>c)s(n,i=e[c++])&&(~a(h,i)||l(h,i));return h}},8773:function(t,e){var i={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!i.call({1:2},1);e.f=s?function(t){var e=n(this,t);return!!e&&e.enumerable}:i},4270:function(t,e,i){var n=i(9565),s=i(4901),r=i(34),a=TypeError;t.exports=function(t,e){var i,o;if("string"===e&&s(i=t.toString)&&!r(o=n(i,t)))return o;if(s(i=t.valueOf)&&!r(o=n(i,t)))return o;if("string"!==e&&s(i=t.toString)&&!r(o=n(i,t)))return o;throw new a("Can't convert object to primitive value")}},5031:function(t,e,i){var n=i(7751),s=i(9504),r=i(8480),a=i(3717),o=i(8551),l=s([].concat);t.exports=n("Reflect","ownKeys")||function(t){var e=r.f(o(t)),i=a.f;return i?l(e,i(t)):e}},7750:function(t,e,i){var n=i(4117),s=TypeError;t.exports=function(t){if(n(t))throw new s("Can't call method on "+t);return t}},6119:function(t,e,i){var n=i(5745),s=i(3392),r=n("keys");t.exports=function(t){return r[t]||(r[t]=s(t))}},7629:function(t,e,i){var n=i(6395),s=i(4475),r=i(9433),a="__core-js_shared__",o=t.exports=s[a]||r(a,{});(o.versions||(o.versions=[])).push({version:"3.37.1",mode:n?"pure":"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:function(t,e,i){var n=i(7629);t.exports=function(t,e){return n[t]||(n[t]=e||{})}},4495:function(t,e,i){var n=i(7388),s=i(9039),r=i(4475),a=r.String;t.exports=!!Object.getOwnPropertySymbols&&!s((function(){var t=Symbol("symbol detection");return!a(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},5610:function(t,e,i){var n=i(1291),s=Math.max,r=Math.min;t.exports=function(t,e){var i=n(t);return i<0?s(i+e,0):r(i,e)}},5397:function(t,e,i){var n=i(7055),s=i(7750);t.exports=function(t){return n(s(t))}},1291:function(t,e,i){var n=i(741);t.exports=function(t){var e=+t;return e!==e||0===e?0:n(e)}},8014:function(t,e,i){var n=i(1291),s=Math.min;t.exports=function(t){var e=n(t);return e>0?s(e,9007199254740991):0}},8981:function(t,e,i){var n=i(7750),s=Object;t.exports=function(t){return s(n(t))}},2777:function(t,e,i){var n=i(9565),s=i(34),r=i(757),a=i(5966),o=i(4270),l=i(8227),c=TypeError,h=l("toPrimitive");t.exports=function(t,e){if(!s(t)||r(t))return t;var i,l=a(t,h);if(l){if(void 0===e&&(e="default"),i=n(l,t,e),!s(i)||r(i))return i;throw new c("Can't convert object to primitive value")}return void 0===e&&(e="number"),o(t,e)}},6969:function(t,e,i){var n=i(2777),s=i(757);t.exports=function(t){var e=n(t,"string");return s(e)?e:e+""}},2140:function(t,e,i){var n=i(8227),s=n("toStringTag"),r={};r[s]="z",t.exports="[object z]"===String(r)},655:function(t,e,i){var n=i(6955),s=String;t.exports=function(t){if("Symbol"===n(t))throw new TypeError("Cannot convert a Symbol value to a string");return s(t)}},6823:function(t){var e=String;t.exports=function(t){try{return e(t)}catch(i){return"Object"}}},3392:function(t,e,i){var n=i(9504),s=0,r=Math.random(),a=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++s+r,36)}},7040:function(t,e,i){var n=i(4495);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:function(t,e,i){var n=i(3724),s=i(9039);t.exports=n&&s((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},2812:function(t){var e=TypeError;t.exports=function(t,i){if(t<i)throw new e("Not enough arguments");return t}},8622:function(t,e,i){var n=i(4475),s=i(4901),r=n.WeakMap;t.exports=s(r)&&/native code/.test(String(r))},8227:function(t,e,i){var n=i(4475),s=i(5745),r=i(9297),a=i(3392),o=i(4495),l=i(7040),c=n.Symbol,h=s("wks"),d=l?c["for"]||c:c&&c.withoutSetter||a;t.exports=function(t){return r(h,t)||(h[t]=o&&r(c,t)?c[t]:d("Symbol."+t)),h[t]}},4114:function(t,e,i){var n=i(6518),s=i(8981),r=i(6198),a=i(4527),o=i(6837),l=i(9039),c=l((function(){return 4294967297!==[].push.call({length:4294967296},1)})),h=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},d=c||!h();n({target:"Array",proto:!0,arity:1,forced:d},{push:function(t){var e=s(this),i=r(e),n=arguments.length;o(i+n);for(var l=0;l<n;l++)e[i]=arguments[l],i++;return a(e,i),i}})},4603:function(t,e,i){var n=i(6840),s=i(9504),r=i(655),a=i(2812),o=URLSearchParams,l=o.prototype,c=s(l.append),h=s(l["delete"]),d=s(l.forEach),u=s([].push),p=new o("a=1&a=2&b=3");p["delete"]("a",1),p["delete"]("b",void 0),p+""!=="a=2"&&n(l,"delete",(function(t){var e=arguments.length,i=e<2?void 0:arguments[1];if(e&&void 0===i)return h(this,t);var n=[];d(this,(function(t,e){u(n,{key:e,value:t})})),a(e,1);var s,o=r(t),l=r(i),p=0,f=0,g=!1,m=n.length;while(p<m)s=n[p++],g||s.key===o?(g=!0,h(this,s.key)):f++;while(f<m)s=n[f++],s.key===o&&s.value===l||c(this,s.key,s.value)}),{enumerable:!0,unsafe:!0})},7566:function(t,e,i){var n=i(6840),s=i(9504),r=i(655),a=i(2812),o=URLSearchParams,l=o.prototype,c=s(l.getAll),h=s(l.has),d=new o("a=1");!d.has("a",2)&&d.has("a",void 0)||n(l,"has",(function(t){var e=arguments.length,i=e<2?void 0:arguments[1];if(e&&void 0===i)return h(this,t);var n=c(this,t);a(e,1);var s=r(i),o=0;while(o<n.length)if(n[o++]===s)return!0;return!1}),{enumerable:!0,unsafe:!0})},8721:function(t,e,i){var n=i(3724),s=i(9504),r=i(2106),a=URLSearchParams.prototype,o=s(a.forEach);n&&!("size"in a)&&r(a,"size",{get:function(){var t=0;return o(this,(function(){t++})),t},configurable:!0,enumerable:!0})},9455:function(t,e,i){i.d(e,{YE:function(){return rs}});
/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2023 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */var n={};(()=>{n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}})(),(()=>{n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})();var s=globalThis.pdfjsLib={};n.d(s,{AbortException:()=>H,AnnotationEditorLayer:()=>is,AnnotationEditorParamsType:()=>f,AnnotationEditorType:()=>p,AnnotationEditorUIManager:()=>Vt,AnnotationLayer:()=>Vn,AnnotationMode:()=>d,CMapCompressionType:()=>_,ColorPicker:()=>Jn,DOMSVGFactory:()=>mt,DrawLayer:()=>ns,FeatureTest:()=>q,GlobalWorkerOptions:()=>Ve,ImageKind:()=>v,InvalidPDFException:()=>N,MissingPDFException:()=>B,OPS:()=>E,Outliner:()=>Wn,PDFDataRangeTransport:()=>Xi,PDFDateString:()=>kt,PDFWorker:()=>tn,PasswordResponses:()=>w,PermissionFlag:()=>g,PixelsPerInch:()=>ht,RenderingCancelledException:()=>bt,TextLayer:()=>Di,UnexpectedResponseException:()=>U,Util:()=>Y,VerbosityLevel:()=>A,XfaLayer:()=>un,build:()=>ln,createValidAbsoluteUrl:()=>R,fetchData:()=>pt,getDocument:()=>Vi,getFilenameFromUrl:()=>_t,getPdfFilenameFromUrl:()=>Et,getXfaPageViewport:()=>It,isDataScheme:()=>yt,isPdfFile:()=>At,noContextMenu:()=>Ct,normalizeUnicode:()=>tt,renderTextLayer:()=>Pi,setLayerDimensions:()=>Pt,shadow:()=>D,updateTextLayer:()=>Oi,version:()=>on});const r="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),a=[1,0,0,1,0,0],o=[.001,0,0,.001,0,0],l=1e7,c=1.35,h={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},u="pdfjs_internal_editor_",p={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},f={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},m={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},v={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},b={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},y={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},A={ERRORS:0,WARNINGS:1,INFOS:5},_={NONE:0,BINARY:1},E={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},w={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let x=A.WARNINGS;function C(t){Number.isInteger(t)&&(x=t)}function S(){return x}function T(t){x>=A.INFOS&&console.log(`Info: ${t}`)}function k(t){x>=A.WARNINGS&&console.log(`Warning: ${t}`)}function I(t){throw new Error(t)}function M(t,e){t||I(e)}function L(t){switch(t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function R(t,e=null,i=null){if(!t)return null;try{if(i&&"string"===typeof t){if(i.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);e?.length>=2&&(t=`http://${t}`)}if(i.tryConvertEncoding)try{t=Q(t)}catch{}}const n=e?new URL(t,e):new URL(t);if(L(n))return n}catch{}return null}function D(t,e,i,n=!1){return Object.defineProperty(t,e,{value:i,enumerable:!n,configurable:!0,writable:!1}),i}const P=function(){function t(e,i){this.constructor===t&&I("Cannot initialize BaseException."),this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class O extends P{constructor(t,e){super(t,"PasswordException"),this.code=e}}class F extends P{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class N extends P{constructor(t){super(t,"InvalidPDFException")}}class B extends P{constructor(t){super(t,"MissingPDFException")}}class U extends P{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class j extends P{constructor(t){super(t,"FormatError")}}class H extends P{constructor(t){super(t,"AbortException")}}function $(t){"object"===typeof t&&void 0!==t?.length||I("Invalid argument for bytesToString");const e=t.length,i=8192;if(e<i)return String.fromCharCode.apply(null,t);const n=[];for(let s=0;s<e;s+=i){const r=Math.min(s+i,e),a=t.subarray(s,r);n.push(String.fromCharCode.apply(null,a))}return n.join("")}function z(t){"string"!==typeof t&&I("Invalid argument for stringToBytes");const e=t.length,i=new Uint8Array(e);for(let n=0;n<e;++n)i[n]=255&t.charCodeAt(n);return i}function V(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function G(t){const e=Object.create(null);for(const[i,n]of t)e[i]=n;return e}function K(){const t=new Uint8Array(4);t[0]=1;const e=new Uint32Array(t.buffer,0,1);return 1===e[0]}function W(){try{return new Function(""),!0}catch{return!1}}class q{static get isLittleEndian(){return D(this,"isLittleEndian",K())}static get isEvalSupported(){return D(this,"isEvalSupported",W())}static get isOffscreenCanvasSupported(){return D(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get platform(){return"undefined"!==typeof navigator&&"string"===typeof navigator?.platform?D(this,"platform",{isMac:navigator.platform.includes("Mac")}):D(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){return D(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const X=Array.from(Array(256).keys(),(t=>t.toString(16).padStart(2,"0")));class Y{static makeHexColor(t,e,i){return`#${X[t]}${X[e]}${X[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const i=t[0]*e[0]+t[1]*e[2]+e[4],n=t[0]*e[1]+t[1]*e[3]+e[5];return[i,n]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2],n=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i;return[n,s]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),n=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),r=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],n[0],s[0],r[0]),Math.min(i[1],n[1],s[1],r[1]),Math.max(i[0],n[0],s[0],r[0]),Math.max(i[1],n[1],s[1],r[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],n=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],r=t[2]*e[1]+t[3]*e[3],a=(i+r)/2,o=Math.sqrt((i+r)**2-4*(i*r-s*n))/2,l=a+o||1,c=a-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),r=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>r?null:[i,s,n,r]}static#t(t,e,i,n,s,r,a,o,l,c){if(l<=0||l>=1)return;const h=1-l,d=l*l,u=d*l,p=h*(h*(h*t+3*l*e)+3*d*i)+u*n,f=h*(h*(h*s+3*l*r)+3*d*a)+u*o;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}static#e(t,e,i,n,s,r,a,o,l,c,h,d){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&this.#t(t,e,i,n,s,r,a,o,-h/c,d));const u=c**2-4*h*l;if(u<0)return;const p=Math.sqrt(u),f=2*l;this.#t(t,e,i,n,s,r,a,o,(-c+p)/f,d),this.#t(t,e,i,n,s,r,a,o,(-c-p)/f,d)}static bezierBoundingBox(t,e,i,n,s,r,a,o,l){return l?(l[0]=Math.min(l[0],t,a),l[1]=Math.min(l[1],e,o),l[2]=Math.max(l[2],t,a),l[3]=Math.max(l[3],e,o)):l=[Math.min(t,a),Math.min(e,o),Math.max(t,a),Math.max(e,o)],this.#e(t,i,s,a,e,n,r,o,3*(3*(i-s)-t+a),6*(t-2*i+s),3*(i-t),l),this.#e(t,i,s,a,e,n,r,o,3*(3*(n-r)-e+o),6*(e-2*n+r),3*(n-e),l),l}}function Q(t){return decodeURIComponent(escape(t))}let J=null,Z=null;function tt(t){return J||(J=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Z=new Map([["","t"]])),t.replaceAll(J,((t,e,i)=>e?e.normalize("NFKC"):Z.get(i)))}function et(){if("undefined"!==typeof crypto&&"function"===typeof crypto?.randomUUID)return crypto.randomUUID();const t=new Uint8Array(32);if("undefined"!==typeof crypto&&"function"===typeof crypto?.getRandomValues)crypto.getRandomValues(t);else for(let e=0;e<32;e++)t[e]=Math.floor(255*Math.random());return $(t)}const it="pdfjs_internal_id_",nt={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};class st{constructor(){this.constructor===st&&I("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,s){return"none"}destroy(t=!1){}}class rt{constructor(){this.constructor===rt&&I("Cannot initialize BaseCanvasFactory.")}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d")}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){I("Abstract method `_createCanvas` called.")}}class at{constructor({baseUrl:t=null,isCompressed:e=!0}){this.constructor===at&&I("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?_.BINARY:_.NONE;return this._fetchData(e,i).catch((t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)}))}_fetchData(t,e){I("Abstract method `_fetchData` called.")}}class ot{constructor({baseUrl:t=null}){this.constructor===ot&&I("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetchData(e).catch((t=>{throw new Error(`Unable to load font data at: ${e}`)}))}_fetchData(t){I("Abstract method `_fetchData` called.")}}class lt{constructor(){this.constructor===lt&&I("Cannot initialize BaseSVGFactory.")}create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if("string"!==typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){I("Abstract method `_createSVG` called.")}}const ct="http://www.w3.org/2000/svg";class ht{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}class dt extends st{#i;#n;#s;#r;#a;#o=0;constructor({docId:t,ownerDocument:e=globalThis.document}={}){super(),this.#s=t,this.#r=e}get#l(){return this.#i||=new Map}get#c(){return this.#a||=new Map}get#h(){if(!this.#n){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#r.createElementNS(ct,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#r.createElementNS(ct,"defs"),t.append(i),i.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(1===t.length){const e=t[0],i=new Array(256);for(let t=0;t<256;t++)i[t]=e[t]/255;const n=i.join(",");return[n,n,n]}const[e,i,n]=t,s=new Array(256),r=new Array(256),a=new Array(256);for(let o=0;o<256;o++)s[o]=e[o]/255,r[o]=i[o]/255,a[o]=n[o]/255;return[s.join(","),r.join(","),a.join(",")]}addFilter(t){if(!t)return"none";let e=this.#l.get(t);if(e)return e;const[i,n,s]=this.#d(t),r=1===t.length?i:`${i}${n}${s}`;if(e=this.#l.get(r),e)return this.#l.set(t,e),e;const a=`g_${this.#s}_transfer_map_${this.#o++}`,o=`url(#${a})`;this.#l.set(t,o),this.#l.set(r,o);const l=this.#u(a);return this.#p(i,n,s,l),o}addHCMFilter(t,e){const i=`${t}-${e}`,n="base";let s=this.#c.get(n);if(s?.key===i)return s.url;if(s?(s.filter?.remove(),s.key=i,s.url="none",s.filter=null):(s={key:i,url:"none",filter:null},this.#c.set(n,s)),!t||!e)return s.url;const r=this.#f(t);t=Y.makeHexColor(...r);const a=this.#f(e);if(e=Y.makeHexColor(...a),this.#h.style.color="","#000000"===t&&"#ffffff"===e||t===e)return s.url;const o=new Array(256);for(let u=0;u<=255;u++){const t=u/255;o[u]=t<=.03928?t/12.92:((t+.055)/1.055)**2.4}const l=o.join(","),c=`g_${this.#s}_hcm_filter`,h=s.filter=this.#u(c);this.#p(l,l,l,h),this.#g(h);const d=(t,e)=>{const i=r[t]/255,n=a[t]/255,s=new Array(e+1);for(let r=0;r<=e;r++)s[r]=i+r/e*(n-i);return s.join(",")};return this.#p(d(0,5),d(1,5),d(2,5),h),s.url=`url(#${c})`,s.url}addAlphaFilter(t){let e=this.#l.get(t);if(e)return e;const[i]=this.#d([t]),n=`alpha_${i}`;if(e=this.#l.get(n),e)return this.#l.set(t,e),e;const s=`g_${this.#s}_alpha_map_${this.#o++}`,r=`url(#${s})`;this.#l.set(t,r),this.#l.set(n,r);const a=this.#u(s);return this.#m(i,a),r}addLuminosityFilter(t){let e,i,n=this.#l.get(t||"luminosity");if(n)return n;if(t?([e]=this.#d([t]),i=`luminosity_${e}`):i="luminosity",n=this.#l.get(i),n)return this.#l.set(t,n),n;const s=`g_${this.#s}_luminosity_map_${this.#o++}`,r=`url(#${s})`;this.#l.set(t,r),this.#l.set(i,r);const a=this.#u(s);return this.#v(a),t&&this.#m(e,a),r}addHighlightHCMFilter(t,e,i,n,s){const r=`${e}-${i}-${n}-${s}`;let a=this.#c.get(t);if(a?.key===r)return a.url;if(a?(a.filter?.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},this.#c.set(t,a)),!e||!i)return a.url;const[o,l]=[e,i].map(this.#f.bind(this));let c=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),h=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[d,u]=[n,s].map(this.#f.bind(this));h<c&&([c,h,d,u]=[h,c,u,d]),this.#h.style.color="";const p=(t,e,i)=>{const n=new Array(256),s=(h-c)/i,r=t/255,a=(e-t)/(255*i);let o=0;for(let l=0;l<=i;l++){const t=Math.round(c+l*s),e=r+l*a;for(let i=o;i<=t;i++)n[i]=e;o=t+1}for(let l=o;l<256;l++)n[l]=n[o-1];return n.join(",")},f=`g_${this.#s}_hcm_${t}_filter`,g=a.filter=this.#u(f);return this.#g(g),this.#p(p(d[0],u[0],5),p(d[1],u[1],5),p(d[2],u[2],5),g),a.url=`url(#${f})`,a.url}destroy(t=!1){t&&0!==this.#c.size||(this.#n&&(this.#n.parentNode.parentNode.remove(),this.#n=null),this.#i&&(this.#i.clear(),this.#i=null),this.#o=0)}#v(t){const e=this.#r.createElementNS(ct,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#r.createElementNS(ct,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#u(t){const e=this.#r.createElementNS(ct,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#h.append(e),e}#b(t,e,i){const n=this.#r.createElementNS(ct,e);n.setAttribute("type","discrete"),n.setAttribute("tableValues",i),t.append(n)}#p(t,e,i,n){const s=this.#r.createElementNS(ct,"feComponentTransfer");n.append(s),this.#b(s,"feFuncR",t),this.#b(s,"feFuncG",e),this.#b(s,"feFuncB",i)}#m(t,e){const i=this.#r.createElementNS(ct,"feComponentTransfer");e.append(i),this.#b(i,"feFuncA",t)}#f(t){return this.#h.style.color=t,Mt(getComputedStyle(this.#h).getPropertyValue("color"))}}class ut extends rt{constructor({ownerDocument:t=globalThis.document}={}){super(),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}async function pt(t,e="text"){if(xt(t,document.baseURI)){const i=await fetch(t);if(!i.ok)throw new Error(i.statusText);switch(e){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise(((i,n)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE)if(200!==s.status&&0!==s.status)n(new Error(s.statusText));else{switch(e){case"arraybuffer":case"blob":case"json":return void i(s.response)}i(s.responseText)}},s.send(null)}))}class ft extends at{_fetchData(t,e){return pt(t,this.isCompressed?"arraybuffer":"text").then((t=>({cMapData:t instanceof ArrayBuffer?new Uint8Array(t):z(t),compressionType:e})))}}class gt extends ot{_fetchData(t){return pt(t,"arraybuffer").then((t=>new Uint8Array(t)))}}class mt extends lt{_createSVG(t){return document.createElementNS(ct,t)}}class vt{constructor({viewBox:t,scale:e,rotation:i,offsetX:n=0,offsetY:s=0,dontFlip:r=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=n,this.offsetY=s;const a=(t[2]+t[0])/2,o=(t[3]+t[1])/2;let l,c,h,d,u,p,f,g;switch(i%=360,i<0&&(i+=360),i){case 180:l=-1,c=0,h=0,d=1;break;case 90:l=0,c=1,h=1,d=0;break;case 270:l=0,c=-1,h=-1,d=0;break;case 0:l=1,c=0,h=0,d=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}r&&(h=-h,d=-d),0===l?(u=Math.abs(o-t[1])*e+n,p=Math.abs(a-t[0])*e+s,f=(t[3]-t[1])*e,g=(t[2]-t[0])*e):(u=Math.abs(a-t[0])*e+n,p=Math.abs(o-t[1])*e+s,f=(t[2]-t[0])*e,g=(t[3]-t[1])*e),this.transform=[l*e,c*e,h*e,d*e,u-l*e*a-h*e*o,p-c*e*a-d*e*o],this.width=f,this.height=g}get rawDims(){const{viewBox:t}=this;return D(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:s=!1}={}){return new vt({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}convertToViewportPoint(t,e){return Y.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=Y.applyTransform([t[0],t[1]],this.transform),i=Y.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return Y.applyInverseTransform([t,e],this.transform)}}class bt extends P{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function yt(t){const e=t.length;let i=0;while(i<e&&""===t[i].trim())i++;return"data:"===t.substring(i,i+5).toLowerCase()}function At(t){return"string"===typeof t&&/\.pdf$/i.test(t)}function _t(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)}function Et(t,e="document.pdf"){if("string"!==typeof t)return e;if(yt(t))return k('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=i.exec(t);let r=n.exec(s[1])||n.exec(s[2])||n.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=n.exec(decodeURIComponent(r))[0]}catch{}return r||e}class wt{started=Object.create(null);times=[];time(t){t in this.started&&k(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||k(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:s}of this.times)t.push(`${i.padEnd(e)} ${s-n}ms\n`);return t.join("")}}function xt(t,e){try{const{protocol:i}=e?new URL(t,e):new URL(t);return"http:"===i||"https:"===i}catch{return!1}}function Ct(t){t.preventDefault()}function St(t){console.log("Deprecated API usage: "+t)}let Tt;class kt{static toDateObject(t){if(!t||"string"!==typeof t)return null;Tt||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=Tt.exec(t);if(!e)return null;const i=parseInt(e[1],10);let n=parseInt(e[2],10);n=n>=1&&n<=12?n-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let r=parseInt(e[4],10);r=r>=0&&r<=23?r:0;let a=parseInt(e[5],10);a=a>=0&&a<=59?a:0;let o=parseInt(e[6],10);o=o>=0&&o<=59?o:0;const l=e[7]||"Z";let c=parseInt(e[8],10);c=c>=0&&c<=23?c:0;let h=parseInt(e[9],10)||0;return h=h>=0&&h<=59?h:0,"-"===l?(r+=c,a+=h):"+"===l&&(r-=c,a-=h),new Date(Date.UTC(i,n,s,r,a,o))}}function It(t,{scale:e=1,rotation:i=0}){const{width:n,height:s}=t.attributes.style,r=[0,0,parseInt(n),parseInt(s)];return new vt({viewBox:r,scale:e,rotation:i})}function Mt(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map((t=>parseInt(t))):t.startsWith("rgba(")?t.slice(5,-1).split(",").map((t=>parseInt(t))).slice(0,3):(k(`Not a valid color format: "${t}"`),[0,0,0])}function Lt(t){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const i of t.keys()){e.style.color=i;const n=window.getComputedStyle(e).color;t.set(i,Mt(n))}e.remove()}function Rt(t){const{a:e,b:i,c:n,d:s,e:r,f:a}=t.getTransform();return[e,i,n,s,r,a]}function Dt(t){const{a:e,b:i,c:n,d:s,e:r,f:a}=t.getTransform().invertSelf();return[e,i,n,s,r,a]}function Pt(t,e,i=!1,n=!0){if(e instanceof vt){const{pageWidth:n,pageHeight:s}=e.rawDims,{style:r}=t,a=q.isCSSRoundSupported,o=`var(--scale-factor) * ${n}px`,l=`var(--scale-factor) * ${s}px`,c=a?`round(${o}, 1px)`:`calc(${o})`,h=a?`round(${l}, 1px)`:`calc(${l})`;i&&e.rotation%180!==0?(r.width=h,r.height=c):(r.width=c,r.height=h)}n&&t.setAttribute("data-main-rotation",e.rotation)}class Ot{#y=null;#A=null;#_;#E=null;constructor(t){this.#_=t}render(){const t=this.#y=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ct),t.addEventListener("pointerdown",Ot.#w);const e=this.#E=document.createElement("div");e.className="buttons",t.append(e);const i=this.#_.toolbarPosition;if(i){const{style:e}=t,n="ltr"===this.#_._uiManager.direction?1-i[0]:i[0];e.insetInlineEnd=100*n+"%",e.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#x(),t}static#w(t){t.stopPropagation()}#C(t){this.#_._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()}#S(t){this.#_._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()}#T(t){t.addEventListener("focusin",this.#C.bind(this),{capture:!0}),t.addEventListener("focusout",this.#S.bind(this),{capture:!0}),t.addEventListener("contextmenu",Ct)}hide(){this.#y.classList.add("hidden"),this.#A?.hideDropdown()}show(){this.#y.classList.remove("hidden")}#x(){const t=document.createElement("button");t.className="delete",t.tabIndex=0,t.setAttribute("data-l10n-id",`pdfjs-editor-remove-${this.#_.editorType}-button`),this.#T(t),t.addEventListener("click",(t=>{this.#_._uiManager.delete()})),this.#E.append(t)}get#k(){const t=document.createElement("div");return t.className="divider",t}addAltTextButton(t){this.#T(t),this.#E.prepend(t,this.#k)}addColorPicker(t){this.#A=t;const e=t.renderButton();this.#T(e),this.#E.prepend(e,this.#k)}remove(){this.#y.remove(),this.#A?.destroy(),this.#A=null}}class Ft{#E=null;#y=null;#I;constructor(t){this.#I=t}#M(){const t=this.#y=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ct);const e=this.#E=document.createElement("div");return e.className="buttons",t.append(e),this.#L(),t}#R(t,e){let i=0,n=0;for(const s of t){const t=s.y+s.height;if(t<i)continue;const r=s.x+(e?s.width:0);t>i?(n=r,i=t):e?r>n&&(n=r):r<n&&(n=r)}return[e?1-n:n,i]}show(t,e,i){const[n,s]=this.#R(e,i),{style:r}=this.#y||=this.#M();t.append(this.#y),r.insetInlineEnd=100*n+"%",r.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#y.remove()}#L(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),t.addEventListener("contextmenu",Ct),t.addEventListener("click",(()=>{this.#I.highlightSelection("floating_button")})),this.#E.append(t)}}function Nt(t,e,i){for(const n of i)e.addEventListener(n,t[n].bind(t))}function Bt(t){return Math.round(Math.min(255,Math.max(1,255*t))).toString(16).padStart(2,"0")}class Ut{#o=0;get id(){return`${u}${this.#o++}`}}class jt{#D=et();#o=0;#l=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',e=new OffscreenCanvas(1,3),i=e.getContext("2d"),n=new Image;n.src=t;const s=n.decode().then((()=>(i.drawImage(n,0,0,1,1,0,0,1,3),0===new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0])));return D(this,"_isSVGFittingCanvas",s)}async#P(t,e){this.#l||=new Map;let i=this.#l.get(t);if(null===i)return null;if(i?.bitmap)return i.refCounter+=1,i;try{let t;if(i||={bitmap:null,id:`image_${this.#D}_${this.#o++}`,refCounter:0,isSvg:!1},"string"===typeof e?(i.url=e,t=await pt(e,"blob")):t=i.file=e,"image/svg+xml"===t.type){const e=jt._isSVGFittingCanvas,n=new FileReader,s=new Image,r=new Promise(((t,r)=>{s.onload=()=>{i.bitmap=s,i.isSvg=!0,t()},n.onload=async()=>{const t=i.svgUrl=n.result;s.src=await e?`${t}#svgView(preserveAspectRatio(none))`:t},s.onerror=n.onerror=r}));n.readAsDataURL(t),await r}else i.bitmap=await createImageBitmap(t);i.refCounter=1}catch(n){console.error(n),i=null}return this.#l.set(t,i),i&&this.#l.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:n,type:s}=t;return this.#P(`${e}_${i}_${n}_${s}`,t)}async getFromUrl(t){return this.#P(t,t)}async getFromId(t){this.#l||=new Map;const e=this.#l.get(t);return e?e.bitmap?(e.refCounter+=1,e):e.file?this.getFromFile(e.file):this.getFromUrl(e.url):null}getSvgUrl(t){const e=this.#l.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#l||=new Map;const e=this.#l.get(t);e&&(e.refCounter-=1,0===e.refCounter&&(e.bitmap=null))}isValidId(t){return t.startsWith(`image_${this.#D}_`)}}class Ht{#O=[];#F=!1;#N;#B=-1;constructor(t=128){this.#N=t}add({cmd:t,undo:e,post:i,mustExec:n,type:s=NaN,overwriteIfSameType:r=!1,keepUndo:a=!1}){if(n&&t(),this.#F)return;const o={cmd:t,undo:e,post:i,type:s};if(-1===this.#B)return this.#O.length>0&&(this.#O.length=0),this.#B=0,void this.#O.push(o);if(r&&this.#O[this.#B].type===s)return a&&(o.undo=this.#O[this.#B].undo),void(this.#O[this.#B]=o);const l=this.#B+1;l===this.#N?this.#O.splice(0,1):(this.#B=l,l<this.#O.length&&this.#O.splice(l)),this.#O.push(o)}undo(){if(-1===this.#B)return;this.#F=!0;const{undo:t,post:e}=this.#O[this.#B];t(),e?.(),this.#F=!1,this.#B-=1}redo(){if(this.#B<this.#O.length-1){this.#B+=1,this.#F=!0;const{cmd:t,post:e}=this.#O[this.#B];t(),e?.(),this.#F=!1}}hasSomethingToUndo(){return-1!==this.#B}hasSomethingToRedo(){return this.#B<this.#O.length-1}destroy(){this.#O=null}}class $t{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=q.platform;for(const[i,n,s={}]of t)for(const t of i){const i=t.startsWith("mac+");e&&i?(this.callbacks.set(t.slice(4),{callback:n,options:s}),this.allKeys.add(t.split("+").at(-1))):e||i||(this.callbacks.set(t,{callback:n,options:s}),this.allKeys.add(t.split("+").at(-1)))}}#U(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#U(e));if(!i)return;const{callback:n,options:{bubbles:s=!1,args:r=[],checker:a=null}}=i;a&&!a(t,e)||(n.bind(t,...r,e)(),s||(e.stopPropagation(),e.preventDefault()))}}class zt{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Lt(t),D(this,"_colors",t)}convert(t){const e=Mt(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,n]of this._colors)if(n.every(((t,i)=>t===e[i])))return zt._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?Y.makeHexColor(...e):t}}class Vt{#j=null;#H=new Map;#$=new Map;#z=null;#V=null;#G=null;#K=new Ht;#W=0;#q=new Set;#X=null;#Y=null;#Q=new Set;#J=!1;#Z=null;#tt=null;#et=null;#it=!1;#nt=null;#st=new Ut;#rt=!1;#at=!1;#ot=null;#lt=null;#ct=null;#ht=p.NONE;#dt=new Set;#ut=null;#pt=null;#ft=null;#gt=this.blur.bind(this);#mt=this.focus.bind(this);#vt=this.copy.bind(this);#bt=this.cut.bind(this);#yt=this.paste.bind(this);#At=this.keydown.bind(this);#_t=this.keyup.bind(this);#Et=this.onEditingAction.bind(this);#wt=this.onPageChanging.bind(this);#xt=this.onScaleChanging.bind(this);#Ct=this.#St.bind(this);#Tt=this.onRotationChanging.bind(this);#kt={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#It=[0,0];#Mt=null;#Lt=null;#Rt=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Vt.prototype,e=t=>t.#Lt.contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl(),i=(t,{target:e})=>{if(e instanceof HTMLInputElement){const{type:t}=e;return"text"!==t&&"number"!==t}return!0},n=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return D(this,"_keyboardManager",new $t([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#Lt.contains(e)&&!t.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&t.#Lt.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,i,n,s,r,a,o,l){this.#Lt=t,this.#Rt=e,this.#z=i,this._eventBus=n,this._eventBus._on("editingaction",this.#Et),this._eventBus._on("pagechanging",this.#wt),this._eventBus._on("scalechanging",this.#xt),this._eventBus._on("rotationchanging",this.#Tt),this.#Dt(),this.#Pt(),this.#V=s.annotationStorage,this.#Z=s.filterFactory,this.#pt=r,this.#et=a||null,this.#J=o,this.#ct=l||null,this.viewParameters={realScale:ht.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}destroy(){this.#Ot(),this.#Ft(),this._eventBus._off("editingaction",this.#Et),this._eventBus._off("pagechanging",this.#wt),this._eventBus._off("scalechanging",this.#xt),this._eventBus._off("rotationchanging",this.#Tt);for(const t of this.#$.values())t.destroy();this.#$.clear(),this.#H.clear(),this.#Q.clear(),this.#j=null,this.#dt.clear(),this.#K.destroy(),this.#z?.destroy(),this.#nt?.hide(),this.#nt=null,this.#tt&&(clearTimeout(this.#tt),this.#tt=null),this.#Mt&&(clearTimeout(this.#Mt),this.#Mt=null),this.#Nt()}async mlGuess(t){return this.#ct?.guess(t)||null}get hasMLManager(){return!!this.#ct}get hcmFilter(){return D(this,"hcmFilter",this.#pt?this.#Z.addHCMFilter(this.#pt.foreground,this.#pt.background):"none")}get direction(){return D(this,"direction",getComputedStyle(this.#Lt).direction)}get highlightColors(){return D(this,"highlightColors",this.#et?new Map(this.#et.split(",").map((t=>t.split("=").map((t=>t.trim()))))):null)}get highlightColorNames(){return D(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(t=>t.reverse()))):null)}setMainHighlightColorPicker(t){this.#lt=t}editAltText(t){this.#z?.editAltText(this,t)}onPageChanging({pageNumber:t}){this.#W=t-1}focusMainContainer(){this.#Lt.focus()}findParent(t,e){for(const i of this.#$.values()){const{x:n,y:s,width:r,height:a}=i.div.getBoundingClientRect();if(t>=n&&t<=n+r&&e>=s&&e<=s+a)return i}return null}disableUserSelect(t=!1){this.#Rt.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#Q.add(t)}removeShouldRescale(t){this.#Q.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*ht.PDF_TO_CSS_UNITS;for(const e of this.#Q)e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Bt({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:r}=e,a=e.toString(),o=this.#Bt(e),l=o.closest(".textLayer"),c=this.getSelectionBoxes(l);if(c){e.empty(),this.#ht===p.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:p.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const e of this.#$.values())if(e.hasTextLayer(l)){e.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:c,anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:r,text:a});break}}}#Ut(){const t=document.getSelection();if(!t||t.isCollapsed)return;const e=this.#Bt(t),i=e.closest(".textLayer"),n=this.getSelectionBoxes(i);n&&(this.#nt||=new Ft(this),this.#nt.show(i,n,"ltr"===this.direction))}addToAnnotationStorage(t){t.isEmpty()||!this.#V||this.#V.has(t.id)||this.#V.setValue(t.id,t)}#St(){const t=document.getSelection();if(!t||t.isCollapsed)return void(this.#ut&&(this.#nt?.hide(),this.#ut=null,this.#jt({hasSelectedText:!1})));const{anchorNode:e}=t;if(e===this.#ut)return;const i=this.#Bt(t),n=i.closest(".textLayer");if(n){if(this.#nt?.hide(),this.#ut=e,this.#jt({hasSelectedText:!0}),(this.#ht===p.HIGHLIGHT||this.#ht===p.NONE)&&(this.#ht===p.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#it=this.isShiftKeyDown,!this.isShiftKeyDown)){const t=e=>{"pointerup"===e.type&&0!==e.button||(window.removeEventListener("pointerup",t),window.removeEventListener("blur",t),"pointerup"===e.type&&this.#Ht("main_toolbar"))};window.addEventListener("pointerup",t),window.addEventListener("blur",t)}}else this.#ut&&(this.#nt?.hide(),this.#ut=null,this.#jt({hasSelectedText:!1}))}#Ht(t=""){this.#ht===p.HIGHLIGHT?this.highlightSelection(t):this.#J&&this.#Ut()}#Dt(){document.addEventListener("selectionchange",this.#Ct)}#Nt(){document.removeEventListener("selectionchange",this.#Ct)}#$t(){window.addEventListener("focus",this.#mt),window.addEventListener("blur",this.#gt)}#Ft(){window.removeEventListener("focus",this.#mt),window.removeEventListener("blur",this.#gt)}blur(){if(this.isShiftKeyDown=!1,this.#it&&(this.#it=!1,this.#Ht("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#dt)if(e.div.contains(t)){this.#ot=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#ot)return;const[t,e]=this.#ot;this.#ot=null,e.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0}),e.focus()}#Pt(){window.addEventListener("keydown",this.#At),window.addEventListener("keyup",this.#_t)}#Ot(){window.removeEventListener("keydown",this.#At),window.removeEventListener("keyup",this.#_t)}#zt(){document.addEventListener("copy",this.#vt),document.addEventListener("cut",this.#bt),document.addEventListener("paste",this.#yt)}#Vt(){document.removeEventListener("copy",this.#vt),document.removeEventListener("cut",this.#bt),document.removeEventListener("paste",this.#yt)}addEditListeners(){this.#Pt(),this.#zt()}removeEditListeners(){this.#Ot(),this.#Vt()}copy(t){if(t.preventDefault(),this.#j?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#dt){const t=i.serialize(!0);t&&e.push(t)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const t of this.#Y)if(t.isHandlingMimeForPasting(r.type))return void t.paste(r,this.currentLayer);let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){return void k(`paste: "${s.message}".`)}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const t=[];for(const r of i){const e=n.deserialize(r);if(!e)return;t.push(e)}const e=()=>{for(const e of t)this.#Gt(e);this.#Kt(t)},s=()=>{for(const e of t)e.remove()};this.addCommands({cmd:e,undo:s,mustExec:!0})}catch(s){k(`paste: "${s.message}".`)}}keydown(t){this.isShiftKeyDown||"Shift"!==t.key||(this.isShiftKeyDown=!0),this.#ht===p.NONE||this.isEditorHandlingKeyboard||Vt._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,this.#it&&(this.#it=!1,this.#Ht("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#jt(t){const e=Object.entries(t).some((([t,e])=>this.#kt[t]!==e));e&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#kt,t)}),this.#ht===p.HIGHLIGHT&&!1===t.hasSelectedEditor&&this.#Wt([[f.HIGHLIGHT_FREE,!0]]))}#Wt(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#$t(),this.#zt(),this.#jt({isEditing:this.#ht!==p.NONE,isEmpty:this.#qt(),hasSomethingToUndo:this.#K.hasSomethingToUndo(),hasSomethingToRedo:this.#K.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#Ft(),this.#Vt(),this.#jt({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#Y){this.#Y=t;for(const t of this.#Y)this.#Wt(t.defaultPropertiesToUpdate)}}getId(){return this.#st.id}get currentLayer(){return this.#$.get(this.#W)}getLayer(t){return this.#$.get(t)}get currentPageIndex(){return this.#W}addLayer(t){this.#$.set(t.pageIndex,t),this.#rt?t.enable():t.disable()}removeLayer(t){this.#$.delete(t.pageIndex)}updateMode(t,e=null,i=!1){if(this.#ht!==t){if(this.#ht=t,t===p.NONE)return this.setEditingState(!1),void this.#Xt();this.setEditingState(!0),this.#Yt(),this.unselectAll();for(const e of this.#$.values())e.updateMode(t);if(e||!i){if(e)for(const t of this.#H.values())if(t.annotationElementId===e){this.setSelected(t),t.enterInEditMode();break}}else this.addNewEditorFromKeyboard()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#ht&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#Y){switch(t){case f.CREATE:return void this.currentLayer.addNewEditor();case f.HIGHLIGHT_DEFAULT_COLOR:this.#lt?.updateColor(e);break;case f.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#ft||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const i of this.#dt)i.updateParams(t,e);for(const i of this.#Y)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const s of this.#H.values())s.editorType===t&&s.show(e);const n=this.#ft?.get(f.HIGHLIGHT_SHOW_ALL)??!0;n!==e&&this.#Wt([[f.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#at!==t){this.#at=t;for(const e of this.#$.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}#Yt(){if(!this.#rt){this.#rt=!0;for(const t of this.#$.values())t.enable();for(const t of this.#H.values())t.enable()}}#Xt(){if(this.unselectAll(),this.#rt){this.#rt=!1;for(const t of this.#$.values())t.disable();for(const t of this.#H.values())t.disable()}}getEditors(t){const e=[];for(const i of this.#H.values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return this.#H.get(t)}addEditor(t){this.#H.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#tt&&clearTimeout(this.#tt),this.#tt=setTimeout((()=>{this.focusMainContainer(),this.#tt=null}),0)),this.#H.delete(t.id),this.unselect(t),t.annotationElementId&&this.#q.has(t.annotationElementId)||this.#V?.remove(t.id)}addDeletedAnnotationElement(t){this.#q.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#q.has(t)}removeDeletedAnnotationElement(t){this.#q.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Gt(t){const e=this.#$.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#j!==t&&(this.#j=t,t&&this.#Wt(t.propertiesToUpdate))}get#Qt(){let t=null;for(t of this.#dt);return t}updateUI(t){this.#Qt===t&&this.#Wt(t.propertiesToUpdate)}toggleSelected(t){if(this.#dt.has(t))return this.#dt.delete(t),t.unselect(),void this.#jt({hasSelectedEditor:this.hasSelection});this.#dt.add(t),t.select(),this.#Wt(t.propertiesToUpdate),this.#jt({hasSelectedEditor:!0})}setSelected(t){for(const e of this.#dt)e!==t&&e.unselect();this.#dt.clear(),this.#dt.add(t),t.select(),this.#Wt(t.propertiesToUpdate),this.#jt({hasSelectedEditor:!0})}isSelected(t){return this.#dt.has(t)}get firstSelectedEditor(){return this.#dt.values().next().value}unselect(t){t.unselect(),this.#dt.delete(t),this.#jt({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#dt.size}get isEnterHandled(){return 1===this.#dt.size&&this.firstSelectedEditor.isEnterHandled}undo(){this.#K.undo(),this.#jt({hasSomethingToUndo:this.#K.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#qt()})}redo(){this.#K.redo(),this.#jt({hasSomethingToUndo:!0,hasSomethingToRedo:this.#K.hasSomethingToRedo(),isEmpty:this.#qt()})}addCommands(t){this.#K.add(t),this.#jt({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#qt()})}#qt(){if(0===this.#H.size)return!0;if(1===this.#H.size)for(const t of this.#H.values())return t.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...this.#dt],e=()=>{for(const e of t)e.remove()},i=()=>{for(const e of t)this.#Gt(e)};this.addCommands({cmd:e,undo:i,mustExec:!0})}commitOrRemove(){this.#j?.commitOrRemove()}hasSomethingToControl(){return this.#j||this.hasSelection}#Kt(t){for(const e of this.#dt)e.unselect();this.#dt.clear();for(const e of t)e.isEmpty()||(this.#dt.add(e),e.select());this.#jt({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#dt)t.commit();this.#Kt(this.#H.values())}unselectAll(){if((!this.#j||(this.#j.commitOrRemove(),this.#ht===p.NONE))&&this.hasSelection){for(const t of this.#dt)t.unselect();this.#dt.clear(),this.#jt({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#It[0]+=t,this.#It[1]+=e;const[n,s]=this.#It,r=[...this.#dt],a=1e3;this.#Mt&&clearTimeout(this.#Mt),this.#Mt=setTimeout((()=>{this.#Mt=null,this.#It[0]=this.#It[1]=0,this.addCommands({cmd:()=>{for(const t of r)this.#H.has(t.id)&&t.translateInPage(n,s)},undo:()=>{for(const t of r)this.#H.has(t.id)&&t.translateInPage(-n,-s)},mustExec:!1})}),a);for(const o of r)o.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#X=new Map;for(const t of this.#dt)this.#X.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#X)return!1;this.disableUserSelect(!1);const t=this.#X;this.#X=null;let e=!1;for(const[{x:n,y:s,pageIndex:r},a]of t)a.newX=n,a.newY=s,a.newPageIndex=r,e||=n!==a.savedX||s!==a.savedY||r!==a.savedPageIndex;if(!e)return!1;const i=(t,e,i,n)=>{if(this.#H.has(t.id)){const s=this.#$.get(n);s?t._setParentAndPosition(s,e,i):(t.pageIndex=n,t.x=e,t.y=i)}};return this.addCommands({cmd:()=>{for(const[e,{newX:n,newY:s,newPageIndex:r}]of t)i(e,n,s,r)},undo:()=>{for(const[e,{savedX:n,savedY:s,savedPageIndex:r}]of t)i(e,n,s,r)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#X)for(const i of this.#X.keys())i.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===this.#dt.size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#j===t}getActive(){return this.#j}getMode(){return this.#ht}get imageManager(){return D(this,"imageManager",new jt)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let l=0,c=e.rangeCount;l<c;l++)if(!t.contains(e.getRangeAt(l).commonAncestorContainer))return null;const{x:i,y:n,width:s,height:r}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(t,e,a,o)=>({x:(e-n)/r,y:1-(t+a-i)/s,width:o/r,height:a/s});break;case"180":a=(t,e,a,o)=>({x:1-(t+a-i)/s,y:1-(e+o-n)/r,width:a/s,height:o/r});break;case"270":a=(t,e,a,o)=>({x:1-(e+o-n)/r,y:(t-i)/s,width:o/r,height:a/s});break;default:a=(t,e,a,o)=>({x:(t-i)/s,y:(e-n)/r,width:a/s,height:o/r});break}const o=[];for(let l=0,c=e.rangeCount;l<c;l++){const t=e.getRangeAt(l);if(!t.collapsed)for(const{x:e,y:i,width:n,height:s}of t.getClientRects())0!==n&&0!==s&&o.push(a(e,i,n,s))}return 0===o.length?null:o}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#G||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#G?.delete(t)}renderAnnotationElement(t){const e=this.#G?.get(t.data.id);if(!e)return;const i=this.#V.getRawValue(e);i&&(this.#ht!==p.NONE||i.hasBeenModified)&&i.renderAnnotationElement(t)}}class Gt{#Jt="";#Zt=!1;#te=null;#ee=null;#ie=null;#ne=!1;#_=null;static _l10nPromise=null;constructor(t){this.#_=t}static initialize(t){Gt._l10nPromise||=t}async render(){const t=this.#te=document.createElement("button");t.className="altText";const e=await Gt._l10nPromise.get("pdfjs-editor-alt-text-button-label");t.textContent=e,t.setAttribute("aria-label",e),t.tabIndex="0",t.addEventListener("contextmenu",Ct),t.addEventListener("pointerdown",(t=>t.stopPropagation()));const i=t=>{t.preventDefault(),this.#_._uiManager.editAltText(this.#_)};return t.addEventListener("click",i,{capture:!0}),t.addEventListener("keydown",(e=>{e.target===t&&"Enter"===e.key&&(this.#ne=!0,i(e))})),await this.#se(),t}finish(){this.#te&&(this.#te.focus({focusVisible:this.#ne}),this.#ne=!1)}isEmpty(){return!this.#Jt&&!this.#Zt}get data(){return{altText:this.#Jt,decorative:this.#Zt}}set data({altText:t,decorative:e}){this.#Jt===t&&this.#Zt===e||(this.#Jt=t,this.#Zt=e,this.#se())}toggle(t=!1){this.#te&&(!t&&this.#ie&&(clearTimeout(this.#ie),this.#ie=null),this.#te.disabled=!t)}destroy(){this.#te?.remove(),this.#te=null,this.#ee=null}async#se(){const t=this.#te;if(!t)return;if(!this.#Jt&&!this.#Zt)return t.classList.remove("done"),void this.#ee?.remove();t.classList.add("done"),Gt._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then((e=>{t.setAttribute("aria-label",e)}));let e=this.#ee;if(!e){this.#ee=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip");const i=e.id=`alt-text-tooltip-${this.#_.id}`;t.setAttribute("aria-describedby",i);const n=100;t.addEventListener("mouseenter",(()=>{this.#ie=setTimeout((()=>{this.#ie=null,this.#ee.classList.add("show"),this.#_._reportTelemetry({action:"alt_text_tooltip"})}),n)})),t.addEventListener("mouseleave",(()=>{this.#ie&&(clearTimeout(this.#ie),this.#ie=null),this.#ee?.classList.remove("show")}))}e.innerText=this.#Zt?await Gt._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):this.#Jt,e.parentNode||t.append(e);const i=this.#_.getImageForAltText();i?.setAttribute("aria-describedby",e.id)}}class Kt{#re=null;#Jt=null;#ae=!1;#oe=!1;#le=null;#ce=null;#he=this.focusin.bind(this);#de=this.focusout.bind(this);#ue=null;#pe="";#fe=!1;#ge=null;#me=!1;#ve=!1;#be=!1;#ye=null;#Ae=0;#_e=0;#Ee=null;_initialOptions=Object.create(null);_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#we=!1;#xe=Kt._zIndex++;static _borderLineWidth=-1;static _colorManager=new zt;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Kt.prototype._resizeWithKeyboard,e=Vt.TRANSLATE_SMALL,i=Vt.TRANSLATE_BIG;return D(this,"_resizerKeyboardManager",new $t([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Kt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.constructor===Kt&&I("Cannot initialize AnnotationEditor."),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:n,pageX:s,pageY:r}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,n],this.pageTranslation=[s,r];const[a,o]=this.parentDimensions;this.x=t.x/a,this.y=t.y/o,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return D(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Wt({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e,i){if(Kt._l10nPromise||=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map((e=>[e,t.get(e.replaceAll(/([A-Z])/g,(t=>`-${t.toLowerCase()}`)))]))),i?.strings)for(const s of i.strings)Kt._l10nPromise.set(s,t.get(s));if(-1!==Kt._borderLineWidth)return;const n=getComputedStyle(document.documentElement);Kt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){I("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#we}set _isDraggable(t){this.#we=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#xe}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#Ce(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#fe?this.#fe=!1:this.parent.setSelected(this))}focusout(t){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const e=t.relatedTarget;e?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[s,r]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/s,this.y=(e+n)/r,this.fixAndSetPosition()}#Se([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this.fixAndSetPosition()}translate(t,e){this.#Se(this.parentDimensions,t,e)}translateInPage(t,e){this.#ge||=[this.x,this.y],this.#Se(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#ge||=[this.x,this.y];const[i,n]=this.parentDimensions;if(this.x+=t/i,this.y+=e/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:t,y:e}=this.div.getBoundingClientRect();this.parent.findNewParent(this,t,e)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:s,y:r}=this;const[a,o]=this.getBaseTranslation();s+=a,r+=o,this.div.style.left=`${(100*s).toFixed(2)}%`,this.div.style.top=`${(100*r).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!this.#ge&&(this.#ge[0]!==this.x||this.#ge[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Kt,n=i/t,s=i/e;switch(this.rotation){case 90:return[-n,s];case 180:return[n,s];case 270:return[n,-s];default:return[-n,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:n,y:s,width:r,height:a}=this;if(r*=e,a*=i,n*=e,s*=i,this._mustFixPosition)switch(t){case 0:n=Math.max(0,Math.min(e-r,n)),s=Math.max(0,Math.min(i-a,s));break;case 90:n=Math.max(0,Math.min(e-a,n)),s=Math.min(i,Math.max(r,s));break;case 180:n=Math.min(e,Math.max(r,n)),s=Math.min(i,Math.max(a,s));break;case 270:n=Math.min(e,Math.max(a,n)),s=Math.max(0,Math.min(i-r,s));break}this.x=n/=e,this.y=s/=i;const[o,l]=this.getBaseTranslation();n+=o,s+=l;const{style:c}=this.div;c.left=`${(100*n).toFixed(2)}%`,c.top=`${(100*s).toFixed(2)}%`,this.moveInDOM()}static#Te(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Kt.#Te(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Kt.#Te(t,e,360-this.parentRotation)}#ke(t){switch(t){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this,n=e*t,s=i*t;return q.isCSSRoundSupported?[Math.round(n),Math.round(s)]:[n,s]}setDims(t,e){const[i,n]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,this.#oe||(this.div.style.height=`${(100*e/n).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,n=i.endsWith("%"),s=!this.#oe&&e.endsWith("%");if(n&&s)return;const[r,a]=this.parentDimensions;n||(t.width=`${(100*parseFloat(i)/r).toFixed(2)}%`),this.#oe||s||(t.height=`${(100*parseFloat(e)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#Ie(){if(this.#le)return;this.#le=document.createElement("div"),this.#le.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const e of t){const t=document.createElement("div");this.#le.append(t),t.classList.add("resizer",e),t.setAttribute("data-resizer-name",e),t.addEventListener("pointerdown",this.#Me.bind(this,e)),t.addEventListener("contextmenu",Ct),t.tabIndex=-1}this.div.prepend(this.#le)}#Me(t,e){e.preventDefault();const{isMac:i}=q.platform;if(0!==e.button||e.ctrlKey&&i)return;this.#Jt?.toggle(!1);const n=this.#Le.bind(this,t),s=this._isDraggable;this._isDraggable=!1;const r={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",n,r),window.addEventListener("contextmenu",Ct);const a=this.x,o=this.y,l=this.width,c=this.height,h=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{this.parent.togglePointerEvents(!0),this.#Jt?.toggle(!0),this._isDraggable=s,window.removeEventListener("pointerup",u),window.removeEventListener("blur",u),window.removeEventListener("pointermove",n,r),window.removeEventListener("contextmenu",Ct),this.parent.div.style.cursor=h,this.div.style.cursor=d,this.#Re(a,o,l,c)};window.addEventListener("pointerup",u),window.addEventListener("blur",u)}#Re(t,e,i,n){const s=this.x,r=this.y,a=this.width,o=this.height;s===t&&r===e&&a===i&&o===n||this.addCommands({cmd:()=>{this.width=a,this.height=o,this.x=s,this.y=r;const[t,e]=this.parentDimensions;this.setDims(t*a,e*o),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=n,this.x=t,this.y=e;const[s,r]=this.parentDimensions;this.setDims(s*i,r*n),this.fixAndSetPosition()},mustExec:!0})}#Le(t,e){const[i,n]=this.parentDimensions,s=this.x,r=this.y,a=this.width,o=this.height,l=Kt.MIN_SIZE/i,c=Kt.MIN_SIZE/n,h=t=>Math.round(1e4*t)/1e4,d=this.#ke(this.rotation),u=(t,e)=>[d[0]*t+d[2]*e,d[1]*t+d[3]*e],p=this.#ke(360-this.rotation),f=(t,e)=>[p[0]*t+p[2]*e,p[1]*t+p[3]*e];let g,m,v=!1,b=!1;switch(t){case"topLeft":v=!0,g=(t,e)=>[0,0],m=(t,e)=>[t,e];break;case"topMiddle":g=(t,e)=>[t/2,0],m=(t,e)=>[t/2,e];break;case"topRight":v=!0,g=(t,e)=>[t,0],m=(t,e)=>[0,e];break;case"middleRight":b=!0,g=(t,e)=>[t,e/2],m=(t,e)=>[0,e/2];break;case"bottomRight":v=!0,g=(t,e)=>[t,e],m=(t,e)=>[0,0];break;case"bottomMiddle":g=(t,e)=>[t/2,e],m=(t,e)=>[t/2,0];break;case"bottomLeft":v=!0,g=(t,e)=>[0,e],m=(t,e)=>[t,0];break;case"middleLeft":b=!0,g=(t,e)=>[0,e/2],m=(t,e)=>[t,e/2];break}const y=g(a,o),A=m(a,o);let _=u(...A);const E=h(s+_[0]),w=h(r+_[1]);let x=1,C=1,[S,T]=this.screenToPageTranslation(e.movementX,e.movementY);if([S,T]=f(S/i,T/n),v){const t=Math.hypot(a,o);x=C=Math.max(Math.min(Math.hypot(A[0]-y[0]-S,A[1]-y[1]-T)/t,1/a,1/o),l/a,c/o)}else b?x=Math.max(l,Math.min(1,Math.abs(A[0]-y[0]-S)))/a:C=Math.max(c,Math.min(1,Math.abs(A[1]-y[1]-T)))/o;const k=h(a*x),I=h(o*C);_=u(...m(k,I));const M=E-_[0],L=w-_[1];this.width=k,this.height=I,this.x=M,this.y=L,this.setDims(i*k,n*I),this.fixAndSetPosition()}altTextFinish(){this.#Jt?.finish()}async addEditToolbar(){return this.#ue||this.#ve||(this.#ue=new Ot(this),this.div.append(this.#ue.render()),this.#Jt&&this.#ue.addAltTextButton(await this.#Jt.render())),this.#ue}removeEditToolbar(){this.#ue&&(this.#ue.remove(),this.#ue=null,this.#Jt?.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#Jt||(Gt.initialize(Kt._l10nPromise),this.#Jt=new Gt(this),await this.addEditToolbar())}get altTextData(){return this.#Jt?.data}set altTextData(t){this.#Jt&&(this.#Jt.data=t)}hasAltText(){return!this.#Jt?.isEmpty()}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#ae?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",this.#he),this.div.addEventListener("focusout",this.#de);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,n]=this.getInitialTranslation();return this.translate(i,n),Nt(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=q.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():(this.#fe=!0,this._isDraggable?this.#De(t):this.#Pe(t))}#Pe(t){const{isMac:e}=q.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#De(t){const e=this._uiManager.isSelected(this);let i,n;this._uiManager.setUpDragSession(),e&&(this.div.classList.add("moving"),i={passive:!0,capture:!0},this.#Ae=t.clientX,this.#_e=t.clientY,n=t=>{const{clientX:e,clientY:i}=t,[n,s]=this.screenToPageTranslation(e-this.#Ae,i-this.#_e);this.#Ae=e,this.#_e=i,this._uiManager.dragSelectedEditors(n,s)},window.addEventListener("pointermove",n,i));const s=()=>{window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),e&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",n,i)),this.#fe=!1,this._uiManager.endDragSession()||this.#Pe(t)};window.addEventListener("pointerup",s),window.addEventListener("blur",s)}moveInDOM(){this.#ye&&clearTimeout(this.#ye),this.#ye=setTimeout((()=>{this.#ye=null,this.parent?.moveEditorInDOM(this)}),0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const n=this.parentScale,[s,r]=this.pageDimensions,[a,o]=this.pageTranslation,l=t/n,c=e/n,h=this.x*s,d=this.y*r,u=this.width*s,p=this.height*r;switch(i){case 0:return[h+l+a,r-d-c-p+o,h+l+u+a,r-d-c+o];case 90:return[h+c+a,r-d+l+o,h+c+p+a,r-d+l+u+o];case 180:return[h-l-u+a,r-d+c+o,h-l+a,r-d+c+p+o];case 270:return[h-c-p+a,r-d-l-u+o,h-c+a,r-d-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,s,r]=t,a=s-i,o=r-n;switch(this.rotation){case 0:return[i,e-r,a,o];case 90:return[i,e-n,o,a];case 180:return[s,e-n,a,o];case 270:return[s,e-r,o,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#ve=!0}disableEditMode(){this.#ve=!1}isInEditMode(){return this.#ve}shouldGetKeyboardEvents(){return this.#be}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#he),this.div?.addEventListener("focusout",this.#de)}rotate(t){}serialize(t=!1,e=null){I("An editor must be serializable")}static deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});n.rotation=t.rotation;const[s,r]=n.pageDimensions,[a,o,l,c]=n.getRectInCurrentCoords(t.rect,r);return n.x=a/s,n.y=o/r,n.width=l/s,n.height=c/r,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if(this.div.removeEventListener("focusin",this.#he),this.div.removeEventListener("focusout",this.#de),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#ye&&(clearTimeout(this.#ye),this.#ye=null),this.#Ce(),this.removeEditToolbar(),this.#Ee){for(const t of this.#Ee.values())clearTimeout(t);this.#Ee=null}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#Ie(),this.#le.classList.remove("hidden"),Nt(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),this.#ce={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#le.children;if(!this.#re){this.#re=Array.from(e);const t=this.#Oe.bind(this),i=this.#Fe.bind(this);for(const e of this.#re){const n=e.getAttribute("data-resizer-name");e.setAttribute("role","spinbutton"),e.addEventListener("keydown",t),e.addEventListener("blur",i),e.addEventListener("focus",this.#Ne.bind(this,n)),Kt._l10nPromise.get(`pdfjs-editor-resizer-label-${n}`).then((t=>e.setAttribute("aria-label",t)))}}const i=this.#re[0];let n=0;for(const r of e){if(r===i)break;n++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#re.length/4);if(s!==n){if(s<n)for(let e=0;e<n-s;e++)this.#le.append(this.#le.firstChild);else if(s>n)for(let e=0;e<s-n;e++)this.#le.firstChild.before(this.#le.lastChild);let t=0;for(const i of e){const e=this.#re[t++],n=e.getAttribute("data-resizer-name");Kt._l10nPromise.get(`pdfjs-editor-resizer-label-${n}`).then((t=>i.setAttribute("aria-label",t)))}}this.#Be(0),this.#be=!0,this.#le.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Oe(t){Kt._resizerKeyboardManager.exec(this,t)}#Fe(t){this.#be&&t.relatedTarget?.parentNode!==this.#le&&this.#Ce()}#Ne(t){this.#pe=this.#be?t:""}#Be(t){if(this.#re)for(const e of this.#re)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#be&&this.#Le(this.#pe,{movementX:t,movementY:e})}#Ce(){if(this.#be=!1,this.#Be(-1),this.#ce){const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=this.#ce;this.#Re(t,e,i,n),this.#ce=null}}_stopResizingWithKeyboard(){this.#Ce(),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),this.#ue?this.#ue?.show():this.addEditToolbar().then((()=>{this.div?.classList.contains("selectedEditor")&&this.#ue?.show()}))}unselect(){this.#le?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this.#ue?.hide()}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#me}set isEditing(t){this.#me=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#oe=!0;const i=t/e,{style:n}=this.div;n.aspectRatio=i,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#Ee||=new Map;const{action:e}=t;let i=this.#Ee.get(e);return i&&clearTimeout(i),i=setTimeout((()=>{this._reportTelemetry(t),this.#Ee.delete(e),0===this.#Ee.size&&(this.#Ee=null)}),Kt._telemetryTimeout),void this.#Ee.set(e,i)}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#ae=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#ae=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){const t=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.before(e)}}else e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}resetAnnotationElement(t){const{firstChild:e}=t.container;"DIV"===e.nodeName&&e.classList.contains("annotationContent")&&e.remove()}}class Wt extends Kt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const qt=3285377520,Xt=4294901760,Yt=65535;class Qt{constructor(t){this.h1=t?4294967295&t:qt,this.h2=t?4294967295&t:qt}update(t){let e,i;if("string"===typeof t){e=new Uint8Array(2*t.length),i=0;for(let n=0,s=t.length;n<s;n++){const s=t.charCodeAt(n);s<=255?e[i++]=s:(e[i++]=s>>>8,e[i++]=255&s)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");e=t.slice(),i=e.byteLength}const n=i>>2,s=i-4*n,r=new Uint32Array(e.buffer,0,n);let a=0,o=0,l=this.h1,c=this.h2;const h=3432918353,d=461845907,u=h&Yt,p=d&Yt;for(let f=0;f<n;f++)1&f?(a=r[f],a=a*h&Xt|a*u&Yt,a=a<<15|a>>>17,a=a*d&Xt|a*p&Yt,l^=a,l=l<<13|l>>>19,l=5*l+3864292196):(o=r[f],o=o*h&Xt|o*u&Yt,o=o<<15|o>>>17,o=o*d&Xt|o*p&Yt,c^=o,c=c<<13|c>>>19,c=5*c+3864292196);switch(a=0,s){case 3:a^=e[4*n+2]<<16;case 2:a^=e[4*n+1]<<8;case 1:a^=e[4*n],a=a*h&Xt|a*u&Yt,a=a<<15|a>>>17,a=a*d&Xt|a*p&Yt,1&n?l^=a:c^=a}this.h1=l,this.h2=c}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&Xt|36045*t&Yt,e=4283543511*e&Xt|(2950163797*(e<<16|t>>>16)&Xt)>>>16,t^=e>>>1,t=444984403*t&Xt|60499*t&Yt,e=3301882366*e&Xt|(3120437893*(e<<16|t>>>16)&Xt)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Jt=Object.freeze({map:null,hash:"",transfer:void 0});class Zt{#Ue=!1;#je=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#je.get(t);return void 0===i?e:Object.assign(e,i)}getRawValue(t){return this.#je.get(t)}remove(t){if(this.#je.delete(t),0===this.#je.size&&this.resetModified(),"function"===typeof this.onAnnotationEditor){for(const t of this.#je.values())if(t instanceof Kt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#je.get(t);let n=!1;if(void 0!==i)for(const[s,r]of Object.entries(e))i[s]!==r&&(n=!0,i[s]=r);else n=!0,this.#je.set(t,e);n&&this.#He(),e instanceof Kt&&"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#je.has(t)}getAll(){return this.#je.size>0?G(this.#je):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return this.#je.size}#He(){this.#Ue||(this.#Ue=!0,"function"===typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#Ue&&(this.#Ue=!1,"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new te(this)}get serializable(){if(0===this.#je.size)return Jt;const t=new Map,e=new Qt,i=[],n=Object.create(null);let s=!1;for(const[r,a]of this.#je){const i=a instanceof Kt?a.serialize(!1,n):a;i&&(t.set(r,i),e.update(`${r}:${JSON.stringify(i)}`),s||=!!i.bitmap)}if(s)for(const r of t.values())r.bitmap&&i.push(r.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Jt}get editorStats(){let t=null;const e=new Map;for(const i of this.#je.values()){if(!(i instanceof Kt))continue;const n=i.telemetryFinalData;if(!n)continue;const{type:s}=n;e.has(s)||e.set(s,Object.getPrototypeOf(i).constructor),t||=Object.create(null);const r=t[s]||=new Map;for(const[t,e]of Object.entries(n)){if("type"===t)continue;let i=r.get(t);i||(i=new Map,r.set(t,i));const n=i.get(e)??0;i.set(e,n+1)}}for(const[i,n]of e)t[i]=n.computeTelemetryFinalData(t[i]);return t}}class te extends Zt{#$e;constructor(t){super();const{map:e,hash:i,transfer:n}=t.serializable,s=structuredClone(e,n?{transfer:n}:null);this.#$e={map:s,hash:i,transfer:n}}get print(){I("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#$e}}class ee{#ze=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#ze.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(t&&!this.#ze.has(t.loadedName))if(M(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:n,style:s}=t,r=new FontFace(i,n,s);this.addNativeFontFace(r);try{await r.load(),this.#ze.add(i),e?.(t)}catch{k(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}}else I("Not implemented: loadSystemFont without the Font Loading API.")}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void await this.loadSystemFont(t);if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(i){throw k(`Failed to load font '${e.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise((e=>{const i=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,i)}))}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return D(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(r||"undefined"!==typeof navigator&&"string"===typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),D(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){M(!n.done,"completeRequest() cannot be called twice."),n.done=!0;while(i.length>0&&i[0].done){const t=i.shift();setTimeout(t.callback,0)}}const{loadingRequests:i}=this,n={done:!1,complete:e,callback:t};return i.push(n),n}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return D(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function n(t,e,i,n){const s=t.substring(0,e),r=t.substring(e+i);return s+n+r}let s,r;const a=this._document.createElement("canvas");a.width=1,a.height=1;const o=a.getContext("2d");let l=0;function c(t,e){if(++l>30)return k("Load test font never loaded."),void e();o.font="30px "+t,o.fillText(".",0,20);const i=o.getImageData(0,0,1,1);i.data[3]>0?e():setTimeout(c.bind(null,t,e))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;const u=976;d=n(d,u,h.length,h);const p=16,f=1482184792;let g=i(d,p);for(s=0,r=h.length-3;s<r;s+=4)g=g-f+i(h,s)|0;s<h.length&&(g=g-f+i(h+"XXX",s)|0),d=n(d,p,4,V(g));const m=`url(data:font/opentype;base64,${btoa(d)});`,v=`@font-face {font-family:"${h}";src:${m}}`;this.insertRule(v);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const y of[t.loadedName,h]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=y,b.append(t)}this._document.body.append(b),c(h,(()=>{b.remove(),e.complete()}))}}class ie{constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this.disableFontFace=!0===e,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=$(this.data),e=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(this.cssFontInfo){let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${e}}`}else i=`@font-face {font-family:"${this.loadedName}";src:${e}}`;return this._inspectFont?.(this,e),i}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(s){k(`getPathGenerator - ignoring character: "${s}".`)}if(!Array.isArray(i)||0===i.length)return this.compiledGlyphs[e]=function(t,e){};const n=[];for(let r=0,a=i.length;r<a;)switch(i[r++]){case nt.BEZIER_CURVE_TO:{const[t,e,s,a,o,l]=i.slice(r,r+6);n.push((i=>i.bezierCurveTo(t,e,s,a,o,l))),r+=6}break;case nt.MOVE_TO:{const[t,e]=i.slice(r,r+2);n.push((i=>i.moveTo(t,e))),r+=2}break;case nt.LINE_TO:{const[t,e]=i.slice(r,r+2);n.push((i=>i.lineTo(t,e))),r+=2}break;case nt.QUADRATIC_CURVE_TO:{const[t,e,s,a]=i.slice(r,r+4);n.push((i=>i.quadraticCurveTo(t,e,s,a))),r+=4}break;case nt.RESTORE:n.push((t=>t.restore()));break;case nt.SAVE:n.push((t=>t.save()));break;case nt.SCALE:M(2===n.length,"Scale command is only valid at the third position.");break;case nt.TRANSFORM:{const[t,e,s,a,o,l]=i.slice(r,r+6);n.push((i=>i.transform(t,e,s,a,o,l))),r+=6}break;case nt.TRANSLATE:{const[t,e]=i.slice(r,r+2);n.push((i=>i.translate(t,e))),r+=2}break}return this.compiledGlyphs[e]=function(t,e){n[0](t),n[1](t),t.scale(e,-e);for(let i=2,s=n.length;i<s;i++)n[i](t)}}}if(r){var ne=Promise.withResolvers(),se=null;const t=async()=>{const t=await import("fs"),e=await import("http"),i=await import("https"),n=await import("url");let s,r;return new Map(Object.entries({fs:t,http:e,https:i,url:n,canvas:s,path2d:r}))};t().then((t=>{se=t,ne.resolve()}),(t=>{k(`loadPackages: ${t}`),se=new Map,ne.resolve()}))}class re{static get promise(){return ne.promise}static get(t){return se?.get(t)}}const ae=function(t){const e=re.get("fs");return e.promises.readFile(t).then((t=>new Uint8Array(t)))};class oe extends st{}class le extends rt{_createCanvas(t,e){const i=re.get("canvas");return i.createCanvas(t,e)}}class ce extends at{_fetchData(t,e){return ae(t).then((t=>({cMapData:t,compressionType:e})))}}class he extends ot{_fetchData(t){return ae(t)}}const de={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function ue(t,e){if(!e)return;const i=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],i,n),t.clip(s)}class pe{constructor(){this.constructor===pe&&I("Cannot initialize BaseShadingPattern.")}getPattern(){I("Abstract method `getPattern` called.")}}class fe extends pe{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,n){let s;if(n===de.STROKE||n===de.FILL){const r=e.current.getClippedPathBoundingBox(n,Rt(t))||[0,0,0,0],a=Math.ceil(r[2]-r[0])||1,o=Math.ceil(r[3]-r[1])||1,l=e.cachedCanvases.getCanvas("pattern",a,o,!0),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-r[0],-r[1]),i=Y.transform(i,[1,0,0,1,r[0],r[1]]),c.transform(...e.baseTransform),this.matrix&&c.transform(...this.matrix),ue(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),s=t.createPattern(l.canvas,"no-repeat");const h=new DOMMatrix(i);s.setTransform(h)}else ue(t,this._bbox),s=this._createGradient(t);return s}}function ge(t,e,i,n,s,r,a,o){const l=e.coords,c=e.colors,h=t.data,d=4*t.width;let u;l[i+1]>l[n+1]&&(u=i,i=n,n=u,u=r,r=a,a=u),l[n+1]>l[s+1]&&(u=n,n=s,s=u,u=a,a=o,o=u),l[i+1]>l[n+1]&&(u=i,i=n,n=u,u=r,r=a,a=u);const p=(l[i]+e.offsetX)*e.scaleX,f=(l[i+1]+e.offsetY)*e.scaleY,g=(l[n]+e.offsetX)*e.scaleX,m=(l[n+1]+e.offsetY)*e.scaleY,v=(l[s]+e.offsetX)*e.scaleX,b=(l[s+1]+e.offsetY)*e.scaleY;if(f>=b)return;const y=c[r],A=c[r+1],_=c[r+2],E=c[a],w=c[a+1],x=c[a+2],C=c[o],S=c[o+1],T=c[o+2],k=Math.round(f),I=Math.round(b);let M,L,R,D,P,O,F,N;for(let B=k;B<=I;B++){if(B<m){const t=B<f?0:(f-B)/(f-m);M=p-(p-g)*t,L=y-(y-E)*t,R=A-(A-w)*t,D=_-(_-x)*t}else{let t;t=B>b?1:m===b?0:(m-B)/(m-b),M=g-(g-v)*t,L=E-(E-C)*t,R=w-(w-S)*t,D=x-(x-T)*t}let t;t=B<f?0:B>b?1:(f-B)/(f-b),P=p-(p-v)*t,O=y-(y-C)*t,F=A-(A-S)*t,N=_-(_-T)*t;const e=Math.round(Math.min(M,P)),i=Math.round(Math.max(M,P));let n=d*B+4*e;for(let s=e;s<=i;s++)t=(M-s)/(M-P),t<0?t=0:t>1&&(t=1),h[n++]=L-(L-O)*t|0,h[n++]=R-(R-F)*t|0,h[n++]=D-(D-N)*t|0,h[n++]=255}}function me(t,e,i){const n=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(n.length/o)-1,c=o-1;for(r=0;r<l;r++){let e=r*o;for(let r=0;r<c;r++,e++)ge(t,i,n[e],n[e+1],n[e+o],s[e],s[e+1],s[e+o]),ge(t,i,n[e+o+1],n[e+1],n[e+o],s[e+o+1],s[e+1],s[e+o])}break;case"triangles":for(r=0,a=n.length;r<a;r+=3)ge(t,i,n[r],n[r+1],n[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class ve extends pe{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const n=1.1,s=3e3,r=2,a=Math.floor(this._bounds[0]),o=Math.floor(this._bounds[1]),l=Math.ceil(this._bounds[2])-a,c=Math.ceil(this._bounds[3])-o,h=Math.min(Math.ceil(Math.abs(l*t[0]*n)),s),d=Math.min(Math.ceil(Math.abs(c*t[1]*n)),s),u=l/h,p=c/d,f={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-o,scaleX:1/u,scaleY:1/p},g=h+2*r,m=d+2*r,v=i.getCanvas("mesh",g,m,!1),b=v.context,y=b.createImageData(h,d);if(e){const t=y.data;for(let i=0,n=t.length;i<n;i+=4)t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=255}for(const _ of this._figures)me(y,_,f);b.putImageData(y,r,r);const A=v.canvas;return{canvas:A,offsetX:a-r*u,offsetY:o-r*p,scaleX:u,scaleY:p}}getPattern(t,e,i,n){let s;if(ue(t,this._bbox),n===de.SHADING)s=Y.singularValueDecompose2dScale(Rt(t));else if(s=Y.singularValueDecompose2dScale(e.baseTransform),this.matrix){const t=Y.singularValueDecompose2dScale(this.matrix);s=[s[0]*t[0],s[1]*t[1]]}const r=this._createMeshCanvas(s,n===de.SHADING?null:this._background,e.cachedCanvases);return n!==de.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(r.offsetX,r.offsetY),t.scale(r.scaleX,r.scaleY),t.createPattern(r.canvas,"no-repeat")}}class be extends pe{getPattern(){return"hotpink"}}function ye(t){switch(t[0]){case"RadialAxial":return new fe(t);case"Mesh":return new ve(t);case"Dummy":return new be}throw new Error(`Unknown IR type: ${t[0]}`)}const Ae={COLORED:1,UNCOLORED:2};class _e{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,n,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(t){const e=this.operatorList,i=this.bbox,n=this.xstep,s=this.ystep,r=this.paintType,a=this.tilingType,o=this.color,l=this.canvasGraphicsFactory;T("TilingType: "+a);const c=i[0],h=i[1],d=i[2],u=i[3],p=Y.singularValueDecompose2dScale(this.matrix),f=Y.singularValueDecompose2dScale(this.baseTransform),g=[p[0]*f[0],p[1]*f[1]],m=this.getSizeAndScale(n,this.ctx.canvas.width,g[0]),v=this.getSizeAndScale(s,this.ctx.canvas.height,g[1]),b=t.cachedCanvases.getCanvas("pattern",m.size,v.size,!0),y=b.context,A=l.createCanvasGraphics(y);A.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(A,r,o);let _=c,E=h,w=d,x=u;return c<0&&(_=0,w+=Math.abs(c)),h<0&&(E=0,x+=Math.abs(h)),y.translate(-m.scale*_,-v.scale*E),A.transform(m.scale,0,0,v.scale,0,0),y.save(),this.clipBbox(A,_,E,w,x),A.baseTransform=Rt(A.ctx),A.executeOperatorList(e),A.endDrawing(),{canvas:b.canvas,scaleX:m.scale,scaleY:v.scale,offsetX:_,offsetY:E}}getSizeAndScale(t,e,i){t=Math.abs(t);const n=Math.max(_e.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*i);return s>=n?s=n:i=s/t,{scale:i,size:s}}clipBbox(t,e,i,n,s){const r=n-e,a=s-i;t.ctx.rect(e,i,r,a),t.current.updateRectMinMax(Rt(t.ctx),[e,i,n,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,s=t.current;switch(e){case Ae.COLORED:const t=this.ctx;n.fillStyle=t.fillStyle,n.strokeStyle=t.strokeStyle,s.fillColor=t.fillStyle,s.strokeColor=t.strokeStyle;break;case Ae.UNCOLORED:const r=Y.makeHexColor(i[0],i[1],i[2]);n.fillStyle=r,n.strokeStyle=r,s.fillColor=r,s.strokeColor=r;break;default:throw new j(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,n){let s=i;n!==de.SHADING&&(s=Y.transform(s,e.baseTransform),this.matrix&&(s=Y.transform(s,this.matrix)));const r=this.createPatternCanvas(e);let a=new DOMMatrix(s);a=a.translate(r.offsetX,r.offsetY),a=a.scale(1/r.scaleX,1/r.scaleY);const o=t.createPattern(r.canvas,"repeat");return o.setTransform(a),o}}function Ee({src:t,srcPos:e=0,dest:i,width:n,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=q.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],h=n>>3,d=7&n,u=t.length;i=new Uint32Array(i.buffer);let p=0;for(let f=0;f<s;f++){for(const s=e+h;e<s;e++){const n=e<u?t[e]:255;i[p++]=128&n?c:l,i[p++]=64&n?c:l,i[p++]=32&n?c:l,i[p++]=16&n?c:l,i[p++]=8&n?c:l,i[p++]=4&n?c:l,i[p++]=2&n?c:l,i[p++]=1&n?c:l}if(0===d)continue;const n=e<u?t[e++]:255;for(let t=0;t<d;t++)i[p++]=n&1<<7-t?c:l}return{srcPos:e,destPos:p}}const we=16,xe=100,Ce=15,Se=10,Te=1e3,ke=16;function Ie(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},t.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},t.transform=function(t,i,n,s,r,a){e.transform(t,i,n,s,r,a),this.__originalTransform(t,i,n,s,r,a)},t.setTransform=function(t,i,n,s,r,a){e.setTransform(t,i,n,s,r,a),this.__originalSetTransform(t,i,n,s,r,a)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},t.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},t.bezierCurveTo=function(t,i,n,s,r,a){e.bezierCurveTo(t,i,n,s,r,a),this.__originalBezierCurveTo(t,i,n,s,r,a)},t.rect=function(t,i,n,s){e.rect(t,i,n,s),this.__originalRect(t,i,n,s)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Me{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return void 0!==this.cache[t]?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Le(t,e,i,n,s,r,a,o,l,c){const[h,d,u,p,f,g]=Rt(t);if(0===d&&0===u){const m=a*h+f,v=Math.round(m),b=o*p+g,y=Math.round(b),A=(a+l)*h+f,_=Math.abs(Math.round(A)-v)||1,E=(o+c)*p+g,w=Math.abs(Math.round(E)-y)||1;return t.setTransform(Math.sign(h),0,0,Math.sign(p),v,y),t.drawImage(e,i,n,s,r,0,0,_,w),t.setTransform(h,d,u,p,f,g),[_,w]}if(0===h&&0===p){const m=o*u+f,v=Math.round(m),b=a*d+g,y=Math.round(b),A=(o+c)*u+f,_=Math.abs(Math.round(A)-v)||1,E=(a+l)*d+g,w=Math.abs(Math.round(E)-y)||1;return t.setTransform(0,Math.sign(d),Math.sign(u),0,v,y),t.drawImage(e,i,n,s,r,0,0,w,_),t.setTransform(h,d,u,p,f,g),[w,_]}t.drawImage(e,i,n,s,r,a,o,l,c);const m=Math.hypot(h,d),v=Math.hypot(u,p);return[m*l,v*c]}function Re(t){const{width:e,height:i}=t;if(e>Te||i>Te)return null;const n=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a,o,l,c=new Uint8Array(r*(i+1));const h=e+7&-8;let d=new Uint8Array(h*i),u=0;for(const v of t.data){let t=128;while(t>0)d[u++]=v&t?0:255,t>>=1}let p=0;for(u=0,0!==d[u]&&(c[0]=1,++p),o=1;o<e;o++)d[u]!==d[u+1]&&(c[o]=d[u]?2:1,++p),u++;for(0!==d[u]&&(c[o]=2,++p),a=1;a<i;a++){u=a*h,l=a*r,d[u-h]!==d[u]&&(c[l]=d[u]?1:8,++p);let t=(d[u]?4:0)+(d[u-h]?8:0);for(o=1;o<e;o++)t=(t>>2)+(d[u+1]?4:0)+(d[u-h+1]?8:0),s[t]&&(c[l+o]=s[t],++p),u++;if(d[u-h]!==d[u]&&(c[l+o]=d[u]?2:4,++p),p>n)return null}for(u=h*(i-1),l=a*r,0!==d[u]&&(c[l]=8,++p),o=1;o<e;o++)d[u]!==d[u+1]&&(c[l+o]=d[u]?4:8,++p),u++;if(0!==d[u]&&(c[l+o]=4,++p),p>n)return null;const f=new Int32Array([0,r,-1,0,-r,0,0,0,1]),g=new Path2D;for(a=0;p&&a<=i;a++){let t=a*r;const i=t+e;while(t<i&&!c[t])t++;if(t===i)continue;g.moveTo(t%r,a);const n=t;let s=c[t];do{const e=f[s];do{t+=e}while(!c[t]);const i=c[t];5!==i&&10!==i?(s=i,c[t]=0):(s=i&51*s>>4,c[t]&=s>>2|s<<2),g.lineTo(t%r,t/r|0),c[t]||--p}while(n!==t);--a}d=null,c=null;const m=function(t){t.save(),t.scale(1/e,-1/i),t.translate(0,-i),t.fill(g),t.beginPath(),t.restore()};return m}class De{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a,this.textMatrixScale=1,this.fontMatrix=o,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=m.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=Y.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=Y.applyTransform(e,t),n=Y.applyTransform(e.slice(2),t),s=Y.applyTransform([e[0],e[3]],t),r=Y.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],n[0],s[0],r[0]),this.minY=Math.min(this.minY,i[1],n[1],s[1],r[1]),this.maxX=Math.max(this.maxX,i[0],n[0],s[0],r[0]),this.maxY=Math.max(this.maxY,i[1],n[1],s[1],r[1])}updateScalingPathMinMax(t,e){Y.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,n,s,r,a,o,l,c){const h=Y.bezierBoundingBox(e,i,n,s,r,a,o,l,c);c||this.updateRectMinMax(t,h)}getPathBoundingBox(t=de.FILL,e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(t===de.STROKE){e||I("Stroke bounding box must include transform.");const t=Y.singularValueDecompose2dScale(e),n=t[0]*this.lineWidth/2,s=t[1]*this.lineWidth/2;i[0]-=n,i[1]-=s,i[2]+=n,i[3]+=s}return i}updateClipFromPath(){const t=Y.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=de.FILL,e=null){return Y.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Pe(t,e){if("undefined"!==typeof ImageData&&e instanceof ImageData)return void t.putImageData(e,0,0);const i=e.height,n=e.width,s=i%ke,r=(i-s)/ke,a=0===s?r:r+1,o=t.createImageData(n,ke);let l,c=0;const h=e.data,d=o.data;let u,p,f,g;if(e.kind===v.GRAYSCALE_1BPP){const e=h.byteLength,i=new Uint32Array(d.buffer,0,d.byteLength>>2),g=i.length,m=n+7>>3,v=4294967295,b=q.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(f=u<r?ke:s,l=0,p=0;p<f;p++){const t=e-c;let s=0;const r=t>m?n:8*t-7,a=-8&r;let o=0,d=0;for(;s<a;s+=8)d=h[c++],i[l++]=128&d?v:b,i[l++]=64&d?v:b,i[l++]=32&d?v:b,i[l++]=16&d?v:b,i[l++]=8&d?v:b,i[l++]=4&d?v:b,i[l++]=2&d?v:b,i[l++]=1&d?v:b;for(;s<r;s++)0===o&&(d=h[c++],o=128),i[l++]=d&o?v:b,o>>=1}while(l<g)i[l++]=0;t.putImageData(o,0,u*ke)}}else if(e.kind===v.RGBA_32BPP){for(p=0,g=n*ke*4,u=0;u<r;u++)d.set(h.subarray(c,c+g)),c+=g,t.putImageData(o,0,p),p+=ke;u<a&&(g=n*s*4,d.set(h.subarray(c,c+g)),t.putImageData(o,0,p))}else{if(e.kind!==v.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);for(f=ke,g=n*f,u=0;u<a;u++){for(u>=r&&(f=s,g=n*f),l=0,p=g;p--;)d[l++]=h[c++],d[l++]=h[c++],d[l++]=h[c++],d[l++]=255;t.putImageData(o,0,u*ke)}}}function Oe(t,e){if(e.bitmap)return void t.drawImage(e.bitmap,0,0);const i=e.height,n=e.width,s=i%ke,r=(i-s)/ke,a=0===s?r:r+1,o=t.createImageData(n,ke);let l=0;const c=e.data,h=o.data;for(let d=0;d<a;d++){const e=d<r?ke:s;({srcPos:l}=Ee({src:c,srcPos:l,dest:h,width:n,height:e,nonBlackColor:0})),t.putImageData(o,0,d*ke)}}function Fe(t,e){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of i)void 0!==t[n]&&(e[n]=t[n]);void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function Ne(t){if(t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0),!r){const{filter:e}=t;"none"!==e&&""!==e&&(t.filter="none")}}function Be(t,e){if(e)return!0;const i=Y.singularValueDecompose2dScale(t);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*ht.PDF_TO_CSS_UNITS);return i[0]<=n&&i[1]<=n}const Ue=["butt","round","square"],je=["miter","round","bevel"],He={},$e={};class ze{constructor(t,e,i,n,s,{optionalContentConfig:r,markedContentStack:a=null},o,l){this.ctx=t,this.current=new De(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=r,this.cachedCanvases=new Me(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return"string"===typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const s=this.ctx.canvas.width,r=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,s,r),this.ctx.fillStyle=a,i){const t=this.cachedCanvases.getCanvas("transparent",s,r);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform(...Rt(this.compositeCtx))}this.ctx.save(),Ne(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Rt(this.ctx)}executeOperatorList(t,e,i,n){const s=t.argsArray,r=t.fnArray;let a=e||0;const o=s.length;if(o===a)return a;const l=o-a>Se&&"function"===typeof i,c=l?Date.now()+Ce:0;let h=0;const d=this.commonObjs,u=this.objs;let p;while(1){if(void 0!==n&&a===n.nextBreakPoint)return n.breakIt(a,i),a;if(p=r[a],p!==E.dependency)this[p].apply(this,s[a]);else for(const t of s[a]){const e=t.startsWith("g_")?d:u;if(!e.has(t))return e.get(t,i),a}if(a++,a===o)return a;if(l&&++h>Se){if(Date.now()>c)return i(),a;h=0}}}#Ve(){while(this.stateStack.length||this.inSMaskMode)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#Ve(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#Ge()}#Ge(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width,n=t.height;let s,r,a=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=i,c=n,h="prescale1";while(a>2&&l>1||o>2&&c>1){let e=l,i=c;a>2&&l>1&&(e=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),a/=l/e),o>2&&c>1&&(i=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/i),s=this.cachedCanvases.getCanvas(h,e,i),r=s.context,r.clearRect(0,0,e,i),r.drawImage(t,0,0,l,c,0,0,e,i),t=s.canvas,l=e,c=i,h="prescale1"===h?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:n}=t,s=this.current.fillColor,r=this.current.patternFill,a=Rt(e);let o,l,c,h;if((t.bitmap||t.data)&&t.count>1){const e=t.bitmap||t.data.buffer;l=JSON.stringify(r?a:[a.slice(0,4),s]),o=this._cachedBitmapsMap.get(e),o||(o=new Map,this._cachedBitmapsMap.set(e,o));const i=o.get(l);if(i&&!r){const t=Math.round(Math.min(a[0],a[2])+a[4]),e=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:i,offsetX:t,offsetY:e}}c=i}c||(h=this.cachedCanvases.getCanvas("maskCanvas",i,n),Oe(h.context,t));let d=Y.transform(a,[1/i,0,0,-1/n,0,0]);d=Y.transform(d,[1,0,0,1,0,-n]);const[u,p,f,g]=Y.getAxialAlignedBoundingBox([0,0,i,n],d),m=Math.round(f-u)||1,v=Math.round(g-p)||1,b=this.cachedCanvases.getCanvas("fillCanvas",m,v),y=b.context,A=u,_=p;y.translate(-A,-_),y.transform(...d),c||(c=this._scaleImage(h.canvas,Dt(y)),c=c.img,o&&r&&o.set(l,c)),y.imageSmoothingEnabled=Be(Rt(y),t.interpolate),Le(y,c,0,0,c.width,c.height,0,0,i,n),y.globalCompositeOperation="source-in";const E=Y.transform(Dt(y),[1,0,0,1,-A,-_]);return y.fillStyle=r?s.getPattern(e,this,E,de.FILL):s,y.fillRect(0,0,i,n),o&&!r&&(this.cachedCanvases.delete("fillCanvas"),o.set(l,b.canvas)),{canvas:b.canvas,offsetX:Math.round(A),offsetY:Math.round(_)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Ue[t]}setLineJoin(t){this.ctx.lineJoin=je[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx,this.ctx=n.context;const s=this.ctx;s.setTransform(...Rt(this.suspendedCtx)),Fe(this.suspendedCtx,s),Ie(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Fe(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const s=n[0],r=n[1],a=n[2]-s,o=n[3]-r;0!==a&&0!==o&&(this.genericComposeSMask(e.context,i,a,o,e.subtype,e.backdrop,e.transferMap,s,r,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,s,r,a,o,l,c,h){let d=t.canvas,u=o-c,p=l-h;if(r)if(u<0||p<0||u+i>d.width||p+n>d.height){const t=this.cachedCanvases.getCanvas("maskExtension",i,n),e=t.context;e.drawImage(d,-u,-p),r.some((t=>0!==t))&&(e.globalCompositeOperation="destination-atop",e.fillStyle=Y.makeHexColor(...r),e.fillRect(0,0,i,n),e.globalCompositeOperation="source-over"),d=t.canvas,u=p=0}else if(r.some((t=>0!==t))){t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const e=new Path2D;e.rect(u,p,i,n),t.clip(e),t.globalCompositeOperation="destination-atop",t.fillStyle=Y.makeHexColor(...r),t.fillRect(u,p,i,n),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===s&&a?e.filter=this.filterFactory.addAlphaFilter(a):"Luminosity"===s&&(e.filter=this.filterFactory.addLuminosityFilter(a));const f=new Path2D;f.rect(o,l,i,n),e.clip(f),e.globalCompositeOperation="destination-in",e.drawImage(d,u,p,i,n,o,l,i,n),e.restore()}save(){this.inSMaskMode?(Fe(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Fe(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,n,s,r){this.ctx.transform(t,e,i,n,s,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const n=this.ctx,s=this.current;let r,a,o=s.x,l=s.y;const c=Rt(n),h=0===c[0]&&0===c[3]||0===c[1]&&0===c[2],d=h?i.slice(0):null;for(let u=0,p=0,f=t.length;u<f;u++)switch(0|t[u]){case E.rectangle:o=e[p++],l=e[p++];const t=e[p++],i=e[p++],u=o+t,f=l+i;n.moveTo(o,l),0===t||0===i?n.lineTo(u,f):(n.lineTo(u,l),n.lineTo(u,f),n.lineTo(o,f)),h||s.updateRectMinMax(c,[o,l,u,f]),n.closePath();break;case E.moveTo:o=e[p++],l=e[p++],n.moveTo(o,l),h||s.updatePathMinMax(c,o,l);break;case E.lineTo:o=e[p++],l=e[p++],n.lineTo(o,l),h||s.updatePathMinMax(c,o,l);break;case E.curveTo:r=o,a=l,o=e[p+4],l=e[p+5],n.bezierCurveTo(e[p],e[p+1],e[p+2],e[p+3],o,l),s.updateCurvePathMinMax(c,r,a,e[p],e[p+1],e[p+2],e[p+3],o,l,d),p+=6;break;case E.curveTo2:r=o,a=l,n.bezierCurveTo(o,l,e[p],e[p+1],e[p+2],e[p+3]),s.updateCurvePathMinMax(c,r,a,o,l,e[p],e[p+1],e[p+2],e[p+3],d),o=e[p+2],l=e[p+3],p+=4;break;case E.curveTo3:r=o,a=l,o=e[p+2],l=e[p+3],n.bezierCurveTo(e[p],e[p+1],o,l,o,l),s.updateCurvePathMinMax(c,r,a,e[p],e[p+1],o,l,o,l,d),p+=4;break;case E.closePath:n.closePath();break}h&&s.updateScalingPathMinMax(c,d),s.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"===typeof i&&i?.getPattern?(e.save(),e.strokeStyle=i.getPattern(e,this,Dt(e),de.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor,n=this.current.patternFill;let s=!1;n&&(e.save(),e.fillStyle=i.getPattern(e,this,Dt(e),de.FILL),s=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==r&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=He}eoClip(){this.pendingClip=$e}beginText(){this.current.textMatrix=a,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}else e.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const i=this.commonObjs.get(t),n=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(n.fontMatrix=i.fontMatrix||o,0!==n.fontMatrix[0]&&0!==n.fontMatrix[3]||k("Invalid font matrix for font "+t),e<0?(e=-e,n.fontDirection=-1):n.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const s=i.loadedName||"sans-serif",r=i.systemFontInfo?.css||`"${s}", ${i.fallbackName}`;let a="normal";i.black?a="900":i.bold&&(a="bold");const l=i.italic?"italic":"normal";let c=e;e<we?c=we:e>xe&&(c=xe),this.current.fontSizeScale=e/c,this.ctx.font=`${l} ${a} ${c}px ${r}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,n,s,r){this.current.textMatrix=[t,e,i,n,s,r],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,n){const s=this.ctx,r=this.current,a=r.font,o=r.textRenderingMode,l=r.fontSize/r.fontSizeScale,c=o&m.FILL_STROKE_MASK,h=!!(o&m.ADD_TO_PATH_FLAG),d=r.patternFill&&!a.missingFile;let u;if((a.disableFontFace||h||d)&&(u=a.getPathGenerator(this.commonObjs,t)),a.disableFontFace||d?(s.save(),s.translate(e,i),s.beginPath(),u(s,l),n&&s.setTransform(...n),c!==m.FILL&&c!==m.FILL_STROKE||s.fill(),c!==m.STROKE&&c!==m.FILL_STROKE||s.stroke(),s.restore()):(c!==m.FILL&&c!==m.FILL_STROKE||s.fillText(t,e,i),c!==m.STROKE&&c!==m.FILL_STROKE||s.strokeText(t,e,i)),h){const t=this.pendingTextPaths||=[];t.push({transform:Rt(s),x:e,y:i,fontSize:l,addToPath:u})}}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return D(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const n=e.fontSize;if(0===n)return;const s=this.ctx,r=e.fontSizeScale,a=e.charSpacing,o=e.wordSpacing,l=e.fontDirection,c=e.textHScale*l,h=t.length,d=i.vertical,u=d?1:-1,p=i.defaultVMetrics,f=n*e.fontMatrix[0],g=e.textRenderingMode===m.FILL&&!i.disableFontFace&&!e.patternFill;let v;if(s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),l>0?s.scale(c,-1):s.scale(c,1),e.patternFill){s.save();const t=e.fillColor.getPattern(s,this,Dt(s),de.FILL);v=Rt(s),s.restore(),s.fillStyle=t}let b=e.lineWidth;const y=e.textMatrixScale;if(0===y||0===b){const t=e.textRenderingMode&m.FILL_STROKE_MASK;t!==m.STROKE&&t!==m.FILL_STROKE||(b=this.getSinglePixelWidth())}else b/=y;if(1!==r&&(s.scale(r,r),b/=r),s.lineWidth=b,i.isInvalidPDFjsFont){const i=[];let n=0;for(const e of t)i.push(e.unicode),n+=e.width;return s.fillText(i.join(""),0,0),e.x+=n*f*c,s.restore(),void this.compose()}let A,_=0;for(A=0;A<h;++A){const e=t[A];if("number"===typeof e){_+=u*e*n/1e3;continue}let c=!1;const h=(e.isSpace?o:0)+a,m=e.fontChar,b=e.accent;let y,E,w=e.width;if(d){const t=e.vmetric||p,i=-(e.vmetric?t[1]:.5*w)*f,n=t[2]*f;w=t?-t[0]:w,y=i/r,E=(_+n)/r}else y=_/r,E=0;if(i.remeasure&&w>0){const t=1e3*s.measureText(m).width/n*r;if(w<t&&this.isFontSubpixelAAEnabled){const e=w/t;c=!0,s.save(),s.scale(e,1),y/=e}else w!==t&&(y+=(w-t)/2e3*n/r)}if(this.contentVisible&&(e.isInFont||i.missingFile))if(g&&!b)s.fillText(m,y,E);else if(this.paintChar(m,y,E,v),b){const t=y+n*b.offset.x/r,e=E-n*b.offset.y/r;this.paintChar(b.fontChar,t,e,v)}const x=d?w*f-h*l:w*f+h*l;_+=x,c&&s.restore()}d?e.y-=_:e.x+=_*c,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,n=i.font,s=i.fontSize,r=i.fontDirection,a=n.vertical?1:-1,l=i.charSpacing,c=i.wordSpacing,h=i.textHScale*r,d=i.fontMatrix||o,u=t.length,p=i.textRenderingMode===m.INVISIBLE;let f,g,v,b;if(!p&&0!==s){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(h,r),f=0;f<u;++f){if(g=t[f],"number"===typeof g){b=a*g*s/1e3,this.ctx.translate(b,0),i.x+=b*h;continue}const r=(g.isSpace?c:0)+l,o=n.charProcOperatorList[g.operatorListId];if(!o){k(`Type3 character "${g.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=g,this.save(),e.scale(s,s),e.transform(...d),this.executeOperatorList(o),this.restore());const u=Y.applyTransform([g.width,0],d);v=u[0]*s+r,e.translate(v,0),i.x+=v*h}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,n,s,r){this.ctx.rect(i,n,s-i,r-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const i=t[1],n=this.baseTransform||Rt(this.ctx),s={createCanvasGraphics:t=>new ze(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new _e(t,i,this.ctx,s,n)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){const n=Y.makeHexColor(t,e,i);this.ctx.strokeStyle=n,this.current.strokeColor=n}setFillRGBColor(t,e,i){const n=Y.makeHexColor(t,e,i);this.ctx.fillStyle=n,this.current.fillColor=n,this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=ye(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,Dt(e),de.SHADING);const n=Dt(e);if(n){const{width:t,height:i}=e.canvas,[s,r,a,o]=Y.getAxialAlignedBoundingBox([0,0,t,i],n);this.ctx.fillRect(s,r,a-s,o-r)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){I("Should not call beginInlineImage")}beginImageData(){I("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Rt(this.ctx),e)){const t=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],t,i),this.current.updateRectMinMax(Rt(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||T("TODO: Support non-isolated groups."),t.knockout&&k("Knockout groups not supported.");const i=Rt(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let n=Y.getAxialAlignedBoundingBox(t.bbox,Rt(e));const s=[0,0,e.canvas.width,e.canvas.height];n=Y.intersect(n,s)||[0,0,0,0];const r=Math.floor(n[0]),a=Math.floor(n[1]),o=Math.max(Math.ceil(n[2])-r,1),l=Math.max(Math.ceil(n[3])-a,1);this.current.startNewPathAndClipBox([0,0,o,l]);let c="groupAt"+this.groupLevel;t.smask&&(c+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(c,o,l),d=h.context;d.translate(-r,-a),d.transform(...i),t.smask?this.smaskStack.push({canvas:h.canvas,context:d,offsetX:r,offsetY:a,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(r,a),e.save()),Fe(e,d),this.ctx=d,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const t=Rt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...t);const i=Y.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],t);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(t,e,i,n,s){if(this.#Ve(),Ne(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const n=e[2]-e[0],r=e[3]-e[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=n,e[3]=r;const[s,a]=Y.singularValueDecompose2dScale(Rt(this.ctx)),{viewportScale:o}=this,l=Math.ceil(n*this.outputScaleX*o),c=Math.ceil(r*this.outputScaleY*o);this.annotationCanvas=this.canvasFactory.create(l,c);const{canvas:h,context:d}=this.annotationCanvas;this.annotationCanvasMap.set(t,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=d,this.ctx.save(),this.ctx.setTransform(s,0,0,-a,0,r*a),Ne(this.ctx)}else Ne(this.ctx),this.ctx.rect(e[0],e[1],n,r),this.ctx.clip(),this.endPath()}this.current=new De(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#Ge(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,n=this.processingType3;if(n&&(void 0===n.compiled&&(n.compiled=Re(t)),n.compiled))return void n.compiled(i);const s=this._createMaskCanvas(t),r=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(r,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,n=0,s,r){if(!this.contentVisible)return;t=this.getObject(t.data,t);const a=this.ctx;a.save();const o=Rt(a);a.transform(e,i,n,s,0,0);const l=this._createMaskCanvas(t);a.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(let c=0,h=r.length;c<h;c+=2){const t=Y.transform(o,[e,i,n,s,r[c],r[c+1]]),[h,d]=Y.applyTransform([0,0],t);a.drawImage(l.canvas,h,d)}a.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,n=this.current.patternFill;for(const s of t){const{data:t,width:r,height:a,transform:o}=s,l=this.cachedCanvases.getCanvas("maskCanvas",r,a),c=l.context;c.save();const h=this.getObject(t,s);Oe(c,h),c.globalCompositeOperation="source-in",c.fillStyle=n?i.getPattern(c,this,Dt(e),de.FILL):i,c.fillRect(0,0,r,a),c.restore(),e.save(),e.transform(...o),e.scale(1,-1),Le(e,l.canvas,0,0,r,a,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):k("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,i,n){if(!this.contentVisible)return;const s=this.getObject(t);if(!s)return void k("Dependent image isn't ready yet");const r=s.width,a=s.height,o=[];for(let l=0,c=n.length;l<c;l+=2)o.push({transform:[e,0,0,i,n[l],n[l+1]],x:0,y:0,w:r,h:a});this.paintInlineImageXObjectGroup(s,o)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:i,height:n}=t,s=this.cachedCanvases.getCanvas("inlineImage",i,n),r=s.context;return r.filter=this.current.transferMaps,r.drawImage(e,0,0),r.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,n=this.ctx;if(this.save(),!r){const{filter:t}=n;"none"!==t&&""!==t&&(n.filter="none")}let s;if(n.scale(1/e,-1/i),t.bitmap)s=this.applyTransferMapsToBitmap(t);else if("function"===typeof HTMLElement&&t instanceof HTMLElement||!t.data)s=t;else{const n=this.cachedCanvases.getCanvas("inlineImage",e,i),r=n.context;Pe(r,t),s=this.applyTransferMapsToCanvas(r)}const a=this._scaleImage(s,Dt(n));n.imageSmoothingEnabled=Be(Rt(n),t.interpolate),Le(n,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let n;if(t.bitmap)n=t.bitmap;else{const e=t.width,i=t.height,s=this.cachedCanvases.getCanvas("inlineImage",e,i),r=s.context;Pe(r,t),n=this.applyTransferMapsToCanvas(r)}for(const s of e)i.save(),i.transform(...s.transform),i.scale(1,-1),Le(i,n,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){"OC"===t?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===$e?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Rt(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:s}=this.ctx.getTransform();let r,a;if(0===i&&0===n){const i=Math.abs(e),n=Math.abs(s);if(i===n)if(0===t)r=a=1/i;else{const e=i*t;r=a=e<1?1/e:1}else if(0===t)r=1/i,a=1/n;else{const e=i*t,s=n*t;r=e<1?1/e:1,a=s<1?1/s:1}}else{const o=Math.abs(e*s-i*n),l=Math.hypot(e,i),c=Math.hypot(n,s);if(0===t)r=c/o,a=l/o;else{const e=t*o;r=c>e?c/e:1,a=l>e?l/e:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[n,s]=this.getScaleForStroking();if(e.lineWidth=i||1,1===n&&1===s)return void e.stroke();const r=e.getLineDash();if(t&&e.save(),e.scale(n,s),r.length>0){const t=Math.max(n,s);e.setLineDash(r.map((e=>e/t))),e.lineDashOffset/=t}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const as in E)void 0!==ze.prototype[as]&&(ze.prototype[E[as]]=ze.prototype[as]);class Ve{static#Ke=null;static#We="";static get workerPort(){return this.#Ke}static set workerPort(t){if(!("undefined"!==typeof Worker&&t instanceof Worker)&&null!==t)throw new Error("Invalid `workerPort` type.");this.#Ke=t}static get workerSrc(){return this.#We}static set workerSrc(t){if("string"!==typeof t)throw new Error("Invalid `workerSrc` type.");this.#We=t}}const Ge={UNKNOWN:0,DATA:1,ERROR:2},Ke={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function We(t){switch(t instanceof Error||"object"===typeof t&&null!==t||I('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new H(t.message);case"MissingPDFException":return new B(t.message);case"PasswordException":return new O(t.message,t.code);case"UnexpectedResponseException":return new U(t.message,t.status);case"UnknownErrorException":return new F(t.message,t.details);default:return new F(t.message,t.toString())}}class qe{constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=t=>{const e=t.data;if(e.targetName!==this.sourceName)return;if(e.stream)return void this.#qe(e);if(e.callback){const t=e.callbackId,i=this.callbackCapabilities[t];if(!i)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],e.callback===Ge.DATA)i.resolve(e.data);else{if(e.callback!==Ge.ERROR)throw new Error("Unexpected callback case");i.reject(We(e.reason))}return}const n=this.actionHandler[e.action];if(!n)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const t=this.sourceName,s=e.sourceName;new Promise((function(t){t(n(e.data))})).then((function(n){i.postMessage({sourceName:t,targetName:s,callback:Ge.DATA,callbackId:e.callbackId,data:n})}),(function(n){i.postMessage({sourceName:t,targetName:s,callback:Ge.ERROR,callbackId:e.callbackId,reason:We(n)})}))}else e.streamId?this.#Xe(e):n(e.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[n]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(r){s.reject(r)}return s.promise}sendWithStream(t,e,i,n){const s=this.streamId++,r=this.sourceName,a=this.targetName,o=this.comObj;return new ReadableStream({start:i=>{const l=Promise.withResolvers();return this.streamControllers[s]={controller:i,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:r,targetName:a,action:t,streamId:s,data:e,desiredSize:i.desiredSize},n),l.promise},pull:t=>{const e=Promise.withResolvers();return this.streamControllers[s].pullCall=e,o.postMessage({sourceName:r,targetName:a,stream:Ke.PULL,streamId:s,desiredSize:t.desiredSize}),e.promise},cancel:t=>{M(t instanceof Error,"cancel must have a valid reason");const e=Promise.withResolvers();return this.streamControllers[s].cancelCall=e,this.streamControllers[s].isClosed=!0,o.postMessage({sourceName:r,targetName:a,stream:Ke.CANCEL,streamId:s,reason:We(t)}),e.promise}},i)}#Xe(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,r=this,a=this.actionHandler[t.action],o={enqueue(t,r=1,a){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=r,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:n,stream:Ke.ENQUEUE,streamId:e,chunk:t},a)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:Ke.CLOSE,streamId:e}),delete r.streamSinks[e])},error(t){M(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:Ke.ERROR,streamId:e,reason:We(t)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[e]=o,new Promise((function(e){e(a(t.data,o))})).then((function(){s.postMessage({sourceName:i,targetName:n,stream:Ke.START_COMPLETE,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:i,targetName:n,stream:Ke.START_COMPLETE,streamId:e,reason:We(t)})}))}#qe(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,r=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case Ke.START_COMPLETE:t.success?r.startCall.resolve():r.startCall.reject(We(t.reason));break;case Ke.PULL_COMPLETE:t.success?r.pullCall.resolve():r.pullCall.reject(We(t.reason));break;case Ke.PULL:if(!a){s.postMessage({sourceName:i,targetName:n,stream:Ke.PULL_COMPLETE,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,new Promise((function(t){t(a.onPull?.())})).then((function(){s.postMessage({sourceName:i,targetName:n,stream:Ke.PULL_COMPLETE,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:i,targetName:n,stream:Ke.PULL_COMPLETE,streamId:e,reason:We(t)})}));break;case Ke.ENQUEUE:if(M(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(t.chunk);break;case Ke.CLOSE:if(M(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),this.#Ye(r,e);break;case Ke.ERROR:M(r,"error should have stream controller"),r.controller.error(We(t.reason)),this.#Ye(r,e);break;case Ke.CANCEL_COMPLETE:t.success?r.cancelCall.resolve():r.cancelCall.reject(We(t.reason)),this.#Ye(r,e);break;case Ke.CANCEL:if(!a)break;new Promise((function(e){e(a.onCancel?.(We(t.reason)))})).then((function(){s.postMessage({sourceName:i,targetName:n,stream:Ke.CANCEL_COMPLETE,streamId:e,success:!0})}),(function(t){s.postMessage({sourceName:i,targetName:n,stream:Ke.CANCEL_COMPLETE,streamId:e,reason:We(t)})})),a.sinkCapability.reject(We(t.reason)),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#Ye(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}class Xe{#Qe;#Je;constructor({parsedData:t,rawData:e}){this.#Qe=t,this.#Je=e}getRaw(){return this.#Je}get(t){return this.#Qe.get(t)??null}getAll(){return G(this.#Qe)}has(t){return this.#Qe.has(t)}}const Ye=Symbol("INTERNAL");class Qe{#Ze=!1;#ti=!1;#ei=!1;#ii=!0;constructor(t,{name:e,intent:i,usage:n}){this.#Ze=!!(t&h.DISPLAY),this.#ti=!!(t&h.PRINT),this.name=e,this.intent=i,this.usage=n}get visible(){if(this.#ei)return this.#ii;if(!this.#ii)return!1;const{print:t,view:e}=this.usage;return this.#Ze?"OFF"!==e?.viewState:!this.#ti||"OFF"!==t?.printState}_setVisible(t,e,i=!1){t!==Ye&&I("Internal method `_setVisible` called."),this.#ei=i,this.#ii=e}}class Je{#ni=null;#si=new Map;#ri=null;#ai=null;constructor(t,e=h.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,this.#ai=t.order;for(const i of t.groups)this.#si.set(i.id,new Qe(e,i));if("OFF"===t.baseState)for(const t of this.#si.values())t._setVisible(Ye,!1);for(const e of t.on)this.#si.get(e)._setVisible(Ye,!0);for(const e of t.off)this.#si.get(e)._setVisible(Ye,!1);this.#ri=this.getHash()}}#oi(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const e=t[n];let s;if(Array.isArray(e))s=this.#oi(e);else{if(!this.#si.has(e))return k(`Optional content group not found: ${e}`),!0;s=this.#si.get(e).visible}switch(i){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===i}isVisible(t){if(0===this.#si.size)return!0;if(!t)return T("Optional content group not defined."),!0;if("OCG"===t.type)return this.#si.has(t.id)?this.#si.get(t.id).visible:(k(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return this.#oi(t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!this.#si.has(e))return k(`Optional content group not found: ${e}`),!0;if(this.#si.get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!this.#si.has(e))return k(`Optional content group not found: ${e}`),!0;if(!this.#si.get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!this.#si.has(e))return k(`Optional content group not found: ${e}`),!0;if(!this.#si.get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!this.#si.has(e))return k(`Optional content group not found: ${e}`),!0;if(this.#si.get(e).visible)return!1}return!0}return k(`Unknown optional content policy ${t.policy}.`),!0}return k(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0){const i=this.#si.get(t);i?(i._setVisible(Ye,!!e,!0),this.#ni=null):k(`Optional content group not found: ${t}`)}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const t=this.#si.get(n);if(t)switch(i){case"ON":t._setVisible(Ye,!0);break;case"OFF":t._setVisible(Ye,!1);break;case"Toggle":t._setVisible(Ye,!t.visible);break}}this.#ni=null}get hasInitialVisibility(){return null===this.#ri||this.getHash()===this.#ri}getOrder(){return this.#si.size?this.#ai?this.#ai.slice():[...this.#si.keys()]:null}getGroups(){return this.#si.size>0?G(this.#si):null}getGroup(t){return this.#si.get(t)||null}getHash(){if(null!==this.#ni)return this.#ni;const t=new Qt;for(const[e,i]of this.#si)t.update(`${e}:${i.visible}`);return this.#ni=t.hexdigest()}}class Ze{constructor(t,{disableRange:e=!1,disableStream:i=!1}){M(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:s,progressiveDone:r,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=a,s?.length>0){const t=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener(((t,e)=>{this._onReceiveData({begin:t,chunk:e})})),t.addProgressListener(((t,e)=>{this._onProgress({loaded:t,total:e})})),t.addProgressiveReadListener((t=>{this._onReceiveData({chunk:t})})),t.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const e=this._rangeReaders.some((function(e){return e._begin===t&&(e._enqueue(i),!0)}));M(e,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){M(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new ti(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new ei(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class ti{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=At(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length>0){const e=this._requests.shift();e.resolve({value:t,done:!1})}else this._queuedChunks.push(t);this._loaded+=t.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){const t=this._queuedChunks.shift();return{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ei{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{const e=this._requests.shift();e.resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function ii(t){let e=!0,i=n("filename\\*","i").exec(t);if(i){i=i[1];let t=o(i);return t=unescape(t),t=l(t),t=c(t),r(t)}if(i=a(t),i){const t=c(i);return r(t)}if(i=n("filename","i").exec(t),i){i=i[1];let t=o(i);return t=c(t),r(t)}function n(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function s(t,i){if(t){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const n=new TextDecoder(t,{fatal:!0}),s=z(i);i=n.decode(s),e=!1}catch{}}return i}function r(t){return e&&/[\x80-\xff]/.test(t)&&(t=s("utf-8",t),e&&(t=s("iso-8859-1",t))),t}function a(t){const e=[];let i;const s=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");while(null!==(i=s.exec(t))){let[,t,n,s]=i;if(t=parseInt(t,10),t in e){if(0===t)break}else e[t]=[n,s]}const r=[];for(let n=0;n<e.length;++n){if(!(n in e))break;let[t,i]=e[n];i=o(i),t&&(i=unescape(i),0===n&&(i=l(i))),r.push(i)}return r.join("")}function o(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const i=e[t].indexOf('"');-1!==i&&(e[t]=e[t].slice(0,i),e.length=t+1),e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function l(t){const e=t.indexOf("'");if(-1===e)return t;const i=t.slice(0,e),n=t.slice(e+1),r=n.replace(/^[^']*'/,"");return s(i,r)}function c(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(t,e,i,n){if("q"===i||"Q"===i)return n=n.replaceAll("_"," "),n=n.replaceAll(/=([0-9a-fA-F]{2})/g,(function(t,e){return String.fromCharCode(parseInt(e,16))})),s(e,n);try{n=atob(n)}catch{}return s(e,n)}))}return""}function ni({getResponseHeader:t,isHttp:e,rangeChunkSize:i,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(t("Content-Length"),10);if(!Number.isInteger(r))return s;if(s.suggestedLength=r,r<=2*i)return s;if(n||!e)return s;if("bytes"!==t("Accept-Ranges"))return s;const a=t("Content-Encoding")||"identity";return"identity"!==a||(s.allowRangeRequests=!0),s}function si(t){const e=t("Content-Disposition");if(e){let t=ii(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(At(t))return t}return null}function ri(t,e){return 404===t||0===t&&e.startsWith("file:")?new B('Missing PDF "'+e+'".'):new U(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t)}function ai(t){return 200===t||206===t}function oi(t,e,i){return{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function li(t){const e=new Headers;for(const i in t){const n=t[i];void 0!==n&&e.append(i,n)}return e}function ci(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(k(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class hi{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return M(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new di(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new ui(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class di{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._headers=li(this._stream.httpHeaders);const i=e.url;fetch(i,oi(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!ai(t.status))throw ri(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const e=e=>t.headers.get(e),{allowRangeRequests:n,suggestedLength:s}=ni({getResponseHeader:e,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=s||this._contentLength,this._filename=si(e),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new H("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:ci(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class ui{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController,this._headers=li(this._stream.httpHeaders),this._headers.append("Range",`bytes=${e}-${i-1}`);const s=n.url;fetch(s,oi(this._headers,this._withCredentials,this._abortController)).then((t=>{if(!ai(t.status))throw ri(t.status,s);this._readCapability.resolve(),this._reader=t.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:ci(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const pi=200,fi=206;function gi(t){const e=t.response;return"string"!==typeof e?e:z(e).buffer}class mi{constructor(t,e={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const n={begin:t,end:e};for(const s in i)n[s]=i[s];return this.request(n)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const s in this.httpHeaders){const t=this.httpHeaders[s];void 0!==t&&e.setRequestHeader(s,t)}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=fi):n.expectedStatus=pi,e.responseType="arraybuffer",t.onError&&(e.onerror=function(i){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),4!==n.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===n.status&&this.isHttp)return void i.onError?.(n.status);const s=n.status||pi,r=s===pi&&i.expectedStatus===fi;if(!r&&s!==i.expectedStatus)return void i.onError?.(n.status);const a=gi(n);if(s===fi){const t=n.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);i.onDone({begin:parseInt(e[1],10),chunk:a})}else a?i.onDone({begin:0,chunk:a}):i.onError?.(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class vi{constructor(t){this._source=t,this._manager=new mi(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return M(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new bi(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new yi(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class bi{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=t=>e.getResponseHeader(t),{allowRangeRequests:n,suggestedLength:s}=ni({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=si(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t)if(this._requests.length>0){const e=this._requests.shift();e.resolve({value:t.chunk,done:!1})}else this._cachedChunks.push(t.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=ri(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){const t=this._cachedChunks.shift();return{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class yi{constructor(t,e,i){this._manager=t;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;if(this._requests.length>0){const t=this._requests.shift();t.resolve({value:e,done:!1})}else this._queuedChunk=e;this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=ri(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Ai=/^file:\/\/\/[a-zA-Z]:\//;function _i(t){const e=re.get("url"),i=e.parse(t);return"file:"===i.protocol||i.host?i:/^[a-z]:[/\\]/i.test(t)?e.parse(`file:///${t}`):(i.host||(i.protocol="file:"),i)}class Ei{constructor(t){this.source=t,this.url=_i(t.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return M(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new ki(this):new Si(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new Ii(this,t,e):new Ti(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class wi{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength});const e=new Uint8Array(t).buffer;return{value:e,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new H("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class xi{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const e=t.source;this._isStreamingSupported=!e.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();if(null===t)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=t.length,this.onProgress?.({loaded:this._loaded});const e=new Uint8Array(t).buffer;return{value:e,done:!1}}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",(()=>{this._readCapability.resolve()})),t.on("end",(()=>{t.destroy(),this._done=!0,this._readCapability.resolve()})),t.on("error",(t=>{this._error(t)})),this._storedError&&this._readableStream.destroy(this._storedError)}}function Ci(t,e){return{protocol:t.protocol,auth:t.auth,host:t.hostname,port:t.port,path:t.path,method:"GET",headers:e}}class Si extends wi{constructor(t){super(t);const e=e=>{if(404===e.statusCode){const t=new B(`Missing PDF "${this._url}".`);return this._storedError=t,void this._headersCapability.reject(t)}this._headersCapability.resolve(),this._setReadableStream(e);const i=t=>this._readableStream.headers[t.toLowerCase()],{allowRangeRequests:n,suggestedLength:s}=ni({getResponseHeader:i,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=s||this._contentLength,this._filename=si(i)};if(this._request=null,"http:"===this._url.protocol){const i=re.get("http");this._request=i.request(Ci(this._url,t.httpHeaders),e)}else{const i=re.get("https");this._request=i.request(Ci(this._url,t.httpHeaders),e)}this._request.on("error",(t=>{this._storedError=t,this._headersCapability.reject(t)})),this._request.end()}}class Ti extends xi{constructor(t,e,i){super(t),this._httpHeaders={};for(const s in t.httpHeaders){const e=t.httpHeaders[s];void 0!==e&&(this._httpHeaders[s]=e)}this._httpHeaders.Range=`bytes=${e}-${i-1}`;const n=t=>{if(404!==t.statusCode)this._setReadableStream(t);else{const t=new B(`Missing PDF "${this._url}".`);this._storedError=t}};if(this._request=null,"http:"===this._url.protocol){const t=re.get("http");this._request=t.request(Ci(this._url,this._httpHeaders),n)}else{const t=re.get("https");this._request=t.request(Ci(this._url,this._httpHeaders),n)}this._request.on("error",(t=>{this._storedError=t})),this._request.end()}}class ki extends wi{constructor(t){super(t);let e=decodeURIComponent(this._url.path);Ai.test(this._url.href)&&(e=e.replace(/^\//,""));const i=re.get("fs");i.promises.lstat(e).then((t=>{this._contentLength=t.size,this._setReadableStream(i.createReadStream(e)),this._headersCapability.resolve()}),(t=>{"ENOENT"===t.code&&(t=new B(`Missing PDF "${e}".`)),this._storedError=t,this._headersCapability.reject(t)}))}}class Ii extends xi{constructor(t,e,i){super(t);let n=decodeURIComponent(this._url.path);Ai.test(this._url.href)&&(n=n.replace(/^\//,""));const s=re.get("fs");this._setReadableStream(s.createReadStream(n,{start:e,end:i-1}))}}const Mi=1e5,Li=30,Ri=.8;class Di{#li=Promise.withResolvers();#Lt=null;#ci=!1;#hi=!!globalThis.FontInspector?.enabled;#di=null;#ui=null;#pi=0;#fi=0;#gi=null;#mi=null;#vi=0;#bi=0;#yi=Object.create(null);#Ai=[];#_i=null;#Ei=[];#wi=new WeakMap;#xi=null;static#Ci=new Map;static#Si=new Map;static#Ti=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#_i=t;else{if("object"!==typeof t)throw new Error('No "textContentSource" parameter specified.');this.#_i=new ReadableStream({start(e){e.enqueue(t),e.close()}})}this.#Lt=this.#mi=e,this.#bi=i.scale*(globalThis.devicePixelRatio||1),this.#vi=i.rotation,this.#ui={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:s,pageX:r,pageY:a}=i.rawDims;this.#xi=[1,0,0,-1,-r,a+s],this.#fi=n,this.#pi=s,Pt(e,i),this.#li.promise.catch((()=>{})).then((()=>{Di.#Ti.delete(this),this.#ui=null,this.#yi=null}))}render(){const t=()=>{this.#gi.read().then((({value:e,done:i})=>{i?this.#li.resolve():(this.#di??=e.lang,Object.assign(this.#yi,e.styles),this.#ki(e.items),t())}),this.#li.reject)};return this.#gi=this.#_i.getReader(),Di.#Ti.add(this),t(),this.#li.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==this.#vi&&(e?.(),this.#vi=n,Pt(this.#mi,{rotation:n})),i!==this.#bi){e?.(),this.#bi=i;const t={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:Di.#Ii(this.#di)};for(const e of this.#Ei)t.properties=this.#wi.get(e),t.div=e,this.#Mi(t)}}cancel(){const t=new H("TextLayer task cancelled.");this.#gi?.cancel(t).catch((()=>{})),this.#gi=null,this.#li.reject(t)}get textDivs(){return this.#Ei}get textContentItemsStr(){return this.#Ai}#ki(t){if(this.#ci)return;this.#ui.ctx||=Di.#Ii(this.#di);const e=this.#Ei,i=this.#Ai;for(const n of t){if(e.length>Mi)return k("Ignoring additional textDivs for performance reasons."),void(this.#ci=!0);if(void 0!==n.str)i.push(n.str),this.#Li(n);else if("beginMarkedContentProps"===n.type||"beginMarkedContent"===n.type){const t=this.#Lt;this.#Lt=document.createElement("span"),this.#Lt.classList.add("markedContent"),null!==n.id&&this.#Lt.setAttribute("id",`${n.id}`),t.append(this.#Lt)}else"endMarkedContent"===n.type&&(this.#Lt=this.#Lt.parentNode)}}#Li(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};this.#Ei.push(e);const n=Y.transform(this.#xi,t.transform);let s=Math.atan2(n[1],n[0]);const r=this.#yi[t.fontName];r.vertical&&(s+=Math.PI/2);const a=this.#hi&&r.fontSubstitution||r.fontFamily,o=Math.hypot(n[2],n[3]),l=o*Di.#Ri(a,this.#di);let c,h;0===s?(c=n[4],h=n[5]-l):(c=n[4]+l*Math.sin(s),h=n[5]-l*Math.cos(s));const d="calc(var(--scale-factor)*",u=e.style;this.#Lt===this.#mi?(u.left=`${(100*c/this.#fi).toFixed(2)}%`,u.top=`${(100*h/this.#pi).toFixed(2)}%`):(u.left=`${d}${c.toFixed(2)}px)`,u.top=`${d}${h.toFixed(2)}px)`),u.fontSize=`${d}${o.toFixed(2)}px)`,u.fontFamily=a,i.fontSize=o,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#hi&&(e.dataset.fontName=r.fontSubstitutionLoadedName||t.fontName),0!==s&&(i.angle=s*(180/Math.PI));let p=!1;if(t.str.length>1)p=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),i=Math.abs(t.transform[3]);e!==i&&Math.max(e,i)/Math.min(e,i)>1.5&&(p=!0)}if(p&&(i.canvasWidth=r.vertical?t.height:t.width),this.#wi.set(e,i),this.#ui.div=e,this.#ui.properties=i,this.#Mi(this.#ui),i.hasText&&this.#Lt.append(e),i.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),this.#Lt.append(t)}}#Mi(t){const{div:e,properties:i,ctx:n,prevFontSize:s,prevFontFamily:r}=t,{style:a}=e;let o="";if(0!==i.canvasWidth&&i.hasText){const{fontFamily:l}=a,{canvasWidth:c,fontSize:h}=i;s===h&&r===l||(n.font=`${h*this.#bi}px ${l}`,t.prevFontSize=h,t.prevFontFamily=l);const{width:d}=n.measureText(e.textContent);d>0&&(o=`scaleX(${c*this.#bi/d})`)}0!==i.angle&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(a.transform=o)}static cleanup(){if(!(this.#Ti.size>0)){this.#Ci.clear();for(const{canvas:t}of this.#Si.values())t.remove();this.#Si.clear()}}static#Ii(t=null){let e=this.#Si.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1}),this.#Si.set(t,e)}return e}static#Ri(t,e){const i=this.#Ci.get(t);if(i)return i;const n=this.#Ii(e),s=n.font;n.canvas.width=n.canvas.height=Li,n.font=`${Li}px ${t}`;const r=n.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const e=a/(a+o);return this.#Ci.set(t,e),n.canvas.width=n.canvas.height=0,n.font=s,e}n.strokeStyle="red",n.clearRect(0,0,Li,Li),n.strokeText("g",0,0);let l=n.getImageData(0,0,Li,Li).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/Li);break}n.clearRect(0,0,Li,Li),n.strokeText("A",0,Li),l=n.getImageData(0,0,Li,Li).data,a=0;for(let h=0,d=l.length;h<d;h+=4)if(l[h]>0){a=Li-Math.floor(h/4/Li);break}n.canvas.width=n.canvas.height=0,n.font=s;const c=a?a/(a+o):Ri;return this.#Ci.set(t,c),c}}function Pi(){St("`renderTextLayer`, please use `TextLayer` instead.");const{textContentSource:t,container:e,viewport:i,...n}=arguments[0],s=Object.keys(n);s.length>0&&k("Ignoring `renderTextLayer` parameters: "+s.join(", "));const r=new Di({textContentSource:t,container:e,viewport:i}),{textDivs:a,textContentItemsStr:o}=r,l=r.render();return{promise:l,textDivs:a,textContentItemsStr:o}}function Oi(){St("`updateTextLayer`, please use `TextLayer` instead.")}class Fi{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function n(t){if(!t)return;let i=null;const s=t.name;if("#text"===s)i=t.value;else{if(!Fi.shouldBuildText(s))return;t?.attributes?.textContent?i=t.attributes.textContent:t.value&&(i=t.value)}if(null!==i&&e.push({str:i}),t.children)for(const e of t.children)n(e)}return n(t),i}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}const Ni=65536,Bi=100,Ui=5e3,ji=r?le:ut,Hi=r?ce:ft,$i=r?oe:dt,zi=r?he:gt;function Vi(t){if("string"===typeof t||t instanceof URL?t={url:t}:(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t}),"object"!==typeof t)throw new Error("Invalid parameter in getDocument, need parameter object.");if(!t.url&&!t.data&&!t.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new qi,{docId:i}=e,n=t.url?Gi(t.url):null,s=t.data?Ki(t.data):null,a=t.httpHeaders||null,o=!0===t.withCredentials,l=t.password??null,c=t.range instanceof Xi?t.range:null,h=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:Ni;let d=t.worker instanceof tn?t.worker:null;const u=t.verbosity,p="string"!==typeof t.docBaseUrl||yt(t.docBaseUrl)?null:t.docBaseUrl,f="string"===typeof t.cMapUrl?t.cMapUrl:null,g=!1!==t.cMapPacked,m=t.CMapReaderFactory||Hi,v="string"===typeof t.standardFontDataUrl?t.standardFontDataUrl:null,b=t.StandardFontDataFactory||zi,y=!0!==t.stopAtErrors,A=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,_=!1!==t.isEvalSupported,E="boolean"===typeof t.isOffscreenCanvasSupported?t.isOffscreenCanvasSupported:!r,w=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,x="boolean"===typeof t.disableFontFace?t.disableFontFace:r,S=!0===t.fontExtraProperties,T=!0===t.enableXfa,k=t.ownerDocument||globalThis.document,I=!0===t.disableRange,M=!0===t.disableStream,L=!0===t.disableAutoFetch,R=!0===t.pdfBug,D=c?c.length:t.length??NaN,P="boolean"===typeof t.useSystemFonts?t.useSystemFonts:!r&&!x,O="boolean"===typeof t.useWorkerFetch?t.useWorkerFetch:m===ft&&b===gt&&f&&v&&xt(f,document.baseURI)&&xt(v,document.baseURI),F=t.canvasFactory||new ji({ownerDocument:k}),N=t.filterFactory||new $i({docId:i,ownerDocument:k}),B=null;C(u);const U={canvasFactory:F,filterFactory:N};if(O||(U.cMapReaderFactory=new m({baseUrl:f,isCompressed:g}),U.standardFontDataFactory=new b({baseUrl:v})),!d){const t={verbosity:u,port:Ve.workerPort};d=t.port?tn.fromPort(t):new tn(t),e._worker=d}const j={docId:i,apiVersion:"4.3.136",data:s,password:l,disableAutoFetch:L,rangeChunkSize:h,length:D,docBaseUrl:p,enableXfa:T,evaluatorOptions:{maxImageSize:A,disableFontFace:x,ignoreErrors:y,isEvalSupported:_,isOffscreenCanvasSupported:E,canvasMaxAreaInBytes:w,fontExtraProperties:S,useSystemFonts:P,cMapUrl:O?f:null,standardFontDataUrl:O?v:null}},H={disableFontFace:x,fontExtraProperties:S,ownerDocument:k,pdfBug:R,styleElement:B,loadingParams:{disableAutoFetch:L,enableXfa:T}};return d.promise.then((function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const t=d.messageHandler.sendWithPromise("GetDocRequest",j,s?[s.buffer]:null);let l;if(c)l=new Ze(c,{disableRange:I,disableStream:M});else if(!s){const t=t=>{if(r){const e=function(){return"undefined"!==typeof fetch&&"undefined"!==typeof Response&&"body"in Response.prototype};return e()&&xt(t.url)?new hi(t):new Ei(t)}return xt(t.url)?new hi(t):new vi(t)};l=t({url:n,length:D,httpHeaders:a,withCredentials:o,rangeChunkSize:h,disableRange:I,disableStream:M})}return t.then((t=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const n=new qe(i,t,d.port),s=new en(n,e,l,H,U);e._transport=s,n.send("Ready",null)}))})).catch(e._capability.reject),e}function Gi(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(r&&"string"===typeof t)return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Ki(t){if(r&&"undefined"!==typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"===typeof t)return z(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||"object"===typeof t&&!isNaN(t?.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Wi(t){return"object"===typeof t&&Number.isInteger(t?.num)&&t.num>=0&&Number.isInteger(t?.gen)&&t.gen>=0}class qi{static#s=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+qi.#s++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}class Xi{constructor(t,e,i=!1,n=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then((()=>{for(const i of this._progressListeners)i(t,e)}))}onDataProgressiveRead(t){this._readyCapability.promise.then((()=>{for(const e of this._progressiveReadListeners)e(t)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const t of this._progressiveDoneListeners)t()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){I("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Yi{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return D(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Qi{#Di=null;#Pi=!1;constructor(t,e,i,n=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new wt:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new sn,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:s=!1}={}){return new vt({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return D(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:n=d.ENABLE,transform:s=null,background:r=null,optionalContentConfigPromise:a=null,annotationCanvasMap:o=null,pageColors:l=null,printAnnotationStorage:c=null}){this._stats?.time("Overall");const u=this._transport.getRenderingIntent(i,n,c),{renderingIntent:p,cacheKey:f}=u;this.#Pi=!1,this.#Oi(),a||=this._transport.getOptionalContentConfig(p);let g=this._intentStates.get(f);g||(g=Object.create(null),this._intentStates.set(f,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const m=!!(p&h.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(u));const v=t=>{g.renderTasks.delete(b),(this._maybeCleanupAfterRender||m)&&(this.#Pi=!0),this.#Fi(!m),t?(b.capability.reject(t),this._abortOperatorList({intentState:g,reason:t instanceof Error?t:new Error(t)})):b.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},b=new an({callback:v,params:{canvasContext:t,viewport:e,transform:s,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:o,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!m,pdfBug:this._pdfBug,pageColors:l});(g.renderTasks||=new Set).add(b);const y=b.task;return Promise.all([g.displayReadyCapability.promise,a]).then((([t,e])=>{if(this.destroyed)v();else{if(this._stats?.time("Rendering"),!(e.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");b.initializeGraphics({transparency:t,optionalContentConfig:e}),b.operatorListChanged()}})).catch(v),y}getOperatorList({intent:t="display",annotationMode:e=d.ENABLE,printAnnotationStorage:i=null}={}){function n(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(r))}const s=this._transport.getRenderingIntent(t,e,i,!0);let r,a=this._intentStates.get(s.cacheKey);return a||(a=Object.create(null),this._intentStates.set(s.cacheKey,a)),a.opListReadCapability||(r=Object.create(null),r.operatorListChanged=n,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(r),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){const i=100;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:i,size(t){return t.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then((t=>Fi.textContent(t)));const e=this.streamTextContent(t);return new Promise((function(t,i){function n(){s.read().then((function({value:e,done:i}){i?t(r):(r.lang??=e.lang,Object.assign(r.styles,e.styles),r.items.push(...e.items),n())}),i)}const s=e.getReader(),r={items:[],styles:Object.create(null),lang:null};n()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#Pi=!1,this.#Oi(),Promise.all(t)}cleanup(t=!1){this.#Pi=!0;const e=this.#Fi(!1);return t&&e&&(this._stats&&=new wt),e}#Fi(t=!1){if(this.#Oi(),!this.#Pi||this.destroyed)return!1;if(t)return this.#Di=setTimeout((()=>{this.#Di=null,this.#Fi(!1)}),Ui),!1;for(const{renderTasks:e,operatorList:i}of this._intentStates.values())if(e.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#Pi=!1,!0}#Oi(){this.#Di&&(clearTimeout(this.#Di),this.#Di=null)}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#Fi(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i}){const{map:n,transfer:s}=i,r=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n},s),a=r.getReader(),o=this._intentStates.get(e);o.streamReader=a;const l=()=>{a.read().then((({value:t,done:e})=>{e?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,o),l())}),(t=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const t of o.renderTasks)t.operatorListChanged();this.#Fi(!0)}if(o.displayReadyCapability)o.displayReadyCapability.reject(t);else{if(!o.opListReadCapability)throw t;o.opListReadCapability.reject(t)}}}))};l()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof bt){let i=Bi;return e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),void(t.streamReaderCancelTimeout=setTimeout((()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})}),i))}}if(t.streamReader.cancel(new H(e.message)).catch((()=>{})),t.streamReader=null,!this._transport.destroyed){for(const[e,i]of this._intentStates)if(i===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}class Ji{#Ni=new Set;#Bi=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#Bi.then((()=>{for(const t of this.#Ni)t.call(this,i)}))}addEventListener(t,e){this.#Ni.add(e)}removeEventListener(t,e){this.#Ni.delete(e)}terminate(){this.#Ni.clear()}}const Zi={isWorkerDisabled:!1,fakeWorkerId:0};r&&(Zi.isWorkerDisabled=!0,Ve.workerSrc||="./pdf.worker.mjs"),Zi.isSameOrigin=function(t,e){let i;try{if(i=new URL(t),!i.origin||"null"===i.origin)return!1}catch{return!1}const n=new URL(e,i);return i.origin===n.origin},Zi.createCDNWrapper=function(t){const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};class tn{static#Ui;constructor({name:t=null,port:e=null,verbosity:i=S()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(tn.#Ui?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");return(tn.#Ui||=new WeakMap).set(e,this),void this._initializeFromPort(e)}this._initialize()}get promise(){return r?Promise.all([re.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new qe("main","worker",t),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!Zi.isWorkerDisabled&&!tn.#ji){let{workerSrc:t}=tn;try{Zi.isSameOrigin(window.location.href,t)||(t=Zi.createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new qe("main","worker",e),n=()=>{e.removeEventListener("error",s),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=()=>{this._webWorker||n()};e.addEventListener("error",s),i.on("test",(t=>{e.removeEventListener("error",s),this.destroyed?n():t?(this._messageHandler=i,this._port=e,this._webWorker=e,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),i.destroy(),e.terminate())})),i.on("ready",(t=>{if(e.removeEventListener("error",s),this.destroyed)n();else try{r()}catch{this._setupFakeWorker()}}));const r=()=>{const t=new Uint8Array;i.send("test",t,[t.buffer])};return void r()}catch{T("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){Zi.isWorkerDisabled||(k("Setting up fake worker."),Zi.isWorkerDisabled=!0),tn._setupFakeWorkerGlobal.then((t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new Ji;this._port=e;const i="fake"+Zi.fakeWorkerId++,n=new qe(i+"_worker",i,e);t.setup(n,e);const s=new qe(i,i+"_worker",e);this._messageHandler=s,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})})).catch((t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),tn.#Ui?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=this.#Ui?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new tn(t)}static get workerSrc(){if(Ve.workerSrc)return Ve.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#ji(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const t=async()=>{if(this.#ji)return this.#ji;const t=await import(this.workerSrc);return t.WorkerMessageHandler};return D(this,"_setupFakeWorkerGlobal",t())}}class en{#Hi=new Map;#$i=new Map;#zi=new Map;#Vi=new Map;#Gi=null;constructor(t,e,i,n,s){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new sn,this.fontLoader=new ee({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#Ki(t,e=null){const i=this.#Hi.get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return this.#Hi.set(t,n),n}get annotationStorage(){return D(this,"annotationStorage",new Zt)}getRenderingIntent(t,e=d.ENABLE,i=null,n=!1){let s=h.DISPLAY,r=Jt;switch(t){case"any":s=h.ANY;break;case"display":break;case"print":s=h.PRINT;break;default:k(`getRenderingIntent - invalid intent: ${t}`)}switch(e){case d.DISABLE:s+=h.ANNOTATIONS_DISABLE;break;case d.ENABLE:break;case d.ENABLE_FORMS:s+=h.ANNOTATIONS_FORMS;break;case d.ENABLE_STORAGE:s+=h.ANNOTATIONS_STORAGE;const t=s&h.PRINT&&i instanceof te?i:this.annotationStorage;r=t.serializable;break;default:k(`getRenderingIntent - invalid annotationMode: ${e}`)}return n&&(s+=h.OPLIST),{renderingIntent:s,cacheKey:`${s}_${r.hash}`,annotationStorageSerializable:r}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#Gi?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#$i.values())t.push(i._destroy());this.#$i.clear(),this.#zi.clear(),this.#Vi.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#Hi.clear(),this.filterFactory.destroy(),Di.cleanup(),this._networkStream?.cancelAllRequests(new H("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",((t,e)=>{M(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=()=>{this._fullReader.read().then((function({value:t,done:i}){i?e.close():(M(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{this._fullReader.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}})),t.on("ReaderHeadersReady",(t=>{const i=Promise.withResolvers(),n=this._fullReader;return n.headersReady.then((()=>{n.isStreamingSupported&&n.isRangeSupported||(this._lastProgress&&e.onProgress?.(this._lastProgress),n.onProgress=t=>{e.onProgress?.({loaded:t.loaded,total:t.total})}),i.resolve({isStreamingSupported:n.isStreamingSupported,isRangeSupported:n.isRangeSupported,contentLength:n.contentLength})}),i.reject),i.promise})),t.on("GetRangeReader",((t,e)=>{M(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(t.begin,t.end);i?(e.onPull=()=>{i.read().then((function({value:t,done:i}){i?e.close():(M(t instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))})).catch((t=>{e.error(t)}))},e.onCancel=t=>{i.cancel(t),e.ready.catch((t=>{if(!this.destroyed)throw t}))}):e.close()})),t.on("GetDoc",(({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,e._capability.resolve(new Yi(t,this))})),t.on("DocException",(function(t){let i;switch(t.name){case"PasswordException":i=new O(t.message,t.code);break;case"InvalidPDFException":i=new N(t.message);break;case"MissingPDFException":i=new B(t.message);break;case"UnexpectedResponseException":i=new U(t.message,t.status);break;case"UnknownErrorException":i=new F(t.message,t.details);break;default:I("DocException - expected a valid Error.")}e._capability.reject(i)})),t.on("PasswordRequest",(t=>{if(this.#Gi=Promise.withResolvers(),e.onPassword){const n=t=>{t instanceof Error?this.#Gi.reject(t):this.#Gi.resolve({password:t})};try{e.onPassword(n,t.code)}catch(i){this.#Gi.reject(i)}}else this.#Gi.reject(new O(t.message,t.code));return this.#Gi.promise})),t.on("DataLoaded",(t=>{e.onProgress?.({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(t=>{if(this.destroyed)return;const e=this.#$i.get(t.pageIndex);e._startRenderPage(t.transparency,t.cacheKey)})),t.on("commonobj",(([e,i,n])=>{if(this.destroyed)return null;if(this.commonObjs.has(e))return null;switch(i){case"Font":const{disableFontFace:s,fontExtraProperties:r,pdfBug:a}=this._params;if("error"in n){const t=n.error;k(`Error during font loading: ${t}`),this.commonObjs.resolve(e,t);break}const o=a&&globalThis.FontInspector?.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,l=new ie(n,{disableFontFace:s,inspectFont:o});this.fontLoader.bind(l).catch((()=>t.sendWithPromise("FontFallback",{id:e}))).finally((()=>{!r&&l.data&&(l.data=null),this.commonObjs.resolve(e,l)}));break;case"CopyLocalImage":const{imageRef:c}=n;M(c,"The imageRef must be defined.");for(const t of this.#$i.values())for(const[,i]of t.objs)if(i?.ref===c)return i.dataLen?(this.commonObjs.resolve(e,structuredClone(i)),i.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,n);break;default:throw new Error(`Got unknown common object type ${i}`)}return null})),t.on("obj",(([t,e,i,n])=>{if(this.destroyed)return;const s=this.#$i.get(e);if(!s.objs.has(t))if(0!==s._intentStates.size)switch(i){case"Image":s.objs.resolve(t,n),n?.dataLen>l&&(s._maybeCleanupAfterRender=!0);break;case"Pattern":s.objs.resolve(t,n);break;default:throw new Error(`Got unknown object type ${i}`)}else n?.bitmap?.close()})),t.on("DocProgress",(t=>{this.destroyed||e.onProgress?.({loaded:t.loaded,total:t.total})})),t.on("FetchBuiltInCMap",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(t):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.")))),t.on("FetchStandardFontData",(t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(t):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter."))))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&k("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally((()=>{this.annotationStorage.resetModified()}))}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#zi.get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then((i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&this.#Vi.set(i.refStr,t);const n=new Qi(e,i,this,this._params.pdfBug);return this.#$i.set(e,n),n}));return this.#zi.set(e,n),n}getPageIndex(t){return Wi(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#Ki("GetFieldObjects")}hasJSActions(){return this.#Ki("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!==typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#Ki("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#Ki("GetOptionalContentConfig").then((e=>new Je(e,t)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#Hi.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then((t=>({info:t[0],metadata:t[1]?new Xe(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));return this.#Hi.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#$i.values()){const e=t.cleanup();if(!e)throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`)}this.commonObjs.clear(),t||this.fontLoader.clear(),this.#Hi.clear(),this.filterFactory.destroy(!0),Di.cleanup()}}cachedPageNumber(t){if(!Wi(t))return null;const e=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return this.#Vi.get(e)??null}}const nn=Symbol("INITIAL_DATA");class sn{#Wi=Object.create(null);#qi(t){return this.#Wi[t]||={...Promise.withResolvers(),data:nn}}get(t,e=null){if(e){const i=this.#qi(t);return i.promise.then((()=>e(i.data))),null}const i=this.#Wi[t];if(!i||i.data===nn)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#Wi[t];return!!e&&e.data!==nn}resolve(t,e=null){const i=this.#qi(t);i.data=e,i.resolve()}clear(){for(const t in this.#Wi){const{data:e}=this.#Wi[t];e?.bitmap?.close()}this.#Wi=Object.create(null)}*[Symbol.iterator](){for(const t in this.#Wi){const{data:e}=this.#Wi[t];e!==nn&&(yield[t,e])}}}class rn{#Xi=null;constructor(t){this.#Xi=t,this.onContinue=null}get promise(){return this.#Xi.capability.promise}cancel(t=0){this.#Xi.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#Xi.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#Xi;return t.form||t.canvas&&e?.size>0}}class an{static#Yi=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:s,operatorList:r,pageIndex:a,canvasFactory:o,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:h=!1,pageColors:d=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=a,this.canvasFactory=o,this.filterFactory=l,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===c&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new rn(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(an.#Yi.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");an.#Yi.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:n,transform:s,background:r}=this.params;this.gfx=new ze(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:n,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),an.#Yi.delete(this._canvas),this.callback(t||new bt(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame((()=>{this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),an.#Yi.delete(this._canvas),this.callback())))}}const on="4.3.136",ln="0cec64437";function cn(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function hn(t){return Math.max(0,Math.min(255,255*t))}class dn{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=hn(t),[t,t,t]}static G_HTML([t]){const e=cn(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(hn)}static RGB_HTML(t){return`#${t.map(cn).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[hn(1-Math.min(1,t+n)),hn(1-Math.min(1,i+n)),hn(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,s=1-e,r=1-i,a=Math.min(n,s,r);return["CMYK",n,s,r,a]}}class un{static setupStorage(t,e,i,n,s){const r=n.getValue(e,{value:null});switch(i.name){case"textarea":if(null!==r.value&&(t.textContent=r.value),"print"===s)break;t.addEventListener("input",(t=>{n.setValue(e,{value:t.target.value})}));break;case"input":if("radio"===i.attributes.type||"checkbox"===i.attributes.type){if(r.value===i.attributes.xfaOn?t.setAttribute("checked",!0):r.value===i.attributes.xfaOff&&t.removeAttribute("checked"),"print"===s)break;t.addEventListener("change",(t=>{n.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})}))}else{if(null!==r.value&&t.setAttribute("value",r.value),"print"===s)break;t.addEventListener("input",(t=>{n.setValue(e,{value:t.target.value})}))}break;case"select":if(null!==r.value){t.setAttribute("value",r.value);for(const t of i.children)t.attributes.value===r.value?t.attributes.selected=!0:t.attributes.hasOwnProperty("selected")&&delete t.attributes.selected}t.addEventListener("input",(t=>{const i=t.target.options,s=-1===i.selectedIndex?"":i[i.selectedIndex].value;n.setValue(e,{value:s})}));break}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:s}){const{attributes:r}=e,a=t instanceof HTMLAnchorElement;"radio"===r.type&&(r.name=`${r.name}-${n}`);for(const[o,l]of Object.entries(r))if(null!==l&&void 0!==l)switch(o){case"class":l.length&&t.setAttribute(o,l.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",l);break;case"style":Object.assign(t.style,l);break;case"textContent":t.textContent=l;break;default:(!a||"href"!==o&&"newWindow"!==o)&&t.setAttribute(o,l)}a&&s.addLinkAttributes(t,r.href,r.newWindow),i&&r.dataId&&this.setupStorage(t,r.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,s=t.intent||"display",r=document.createElement(n.name);n.attributes&&this.setAttributes({html:r,element:n,intent:s,linkService:i});const a="richText"!==s,o=t.div;if(o.append(r),t.viewport){const e=`matrix(${t.viewport.transform.join(",")})`;o.style.transform=e}a&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===n.children.length){if(n.value){const t=document.createTextNode(n.value);r.append(t),a&&Fi.shouldBuildText(n.name)&&l.push(t)}return{textDivs:l}}const c=[[n,-1,r]];while(c.length>0){const[t,n,r]=c.at(-1);if(n+1===t.children.length){c.pop();continue}const o=t.children[++c.at(-1)[1]];if(null===o)continue;const{name:h}=o;if("#text"===h){const t=document.createTextNode(o.value);l.push(t),r.append(t);continue}const d=o?.attributes?.xmlns?document.createElementNS(o.attributes.xmlns,h):document.createElement(h);if(r.append(d),o.attributes&&this.setAttributes({html:d,element:o,storage:e,intent:s,linkService:i}),o.children?.length>0)c.push([o,-1,d]);else if(o.value){const t=document.createTextNode(o.value);a&&Fi.shouldBuildText(h)&&l.push(t),d.append(t)}}for(const h of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:l}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const pn=1e3,fn=9,gn=new WeakSet;function mn(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class vn{static create(t){const e=t.data.annotationType;switch(e){case b.LINK:return new yn(t);case b.TEXT:return new An(t);case b.WIDGET:const e=t.data.fieldType;switch(e){case"Tx":return new En(t);case"Btn":return t.data.radioButton?new Cn(t):t.data.checkBox?new xn(t):new Sn(t);case"Ch":return new Tn(t);case"Sig":return new wn(t)}return new _n(t);case b.POPUP:return new kn(t);case b.FREETEXT:return new Mn(t);case b.LINE:return new Ln(t);case b.SQUARE:return new Rn(t);case b.CIRCLE:return new Dn(t);case b.POLYLINE:return new Pn(t);case b.CARET:return new Fn(t);case b.INK:return new Nn(t);case b.POLYGON:return new On(t);case b.HIGHLIGHT:return new Bn(t);case b.UNDERLINE:return new Un(t);case b.SQUIGGLY:return new jn(t);case b.STRIKEOUT:return new Hn(t);case b.STAMP:return new $n(t);case b.FILEATTACHMENT:return new zn(t);default:return new bn(t)}}}class bn{#Qi=null;#Ji=!1;#Zi=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t?.str||e?.str||i?.str)}get hasPopupData(){return bn._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#Qi||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#tn(e),this.#Zi?.popup.updateEdited(t)}resetEdited(){this.#Qi&&(this.#tn(this.#Qi.rect),this.#Zi?.popup.resetEdited(),this.#Qi=null)}#tn(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:a,pageY:o}}}}=this;i?.splice(0,4,...t);const{width:l,height:c}=mn(t);e.left=100*(t[0]-a)/s+"%",e.top=100*(r-t[3]+o)/r+"%",0===n?(e.width=100*l/s+"%",e.height=100*c/r+"%"):this.setRotation(n)}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof _n||(s.tabIndex=pn);const{style:r}=s;if(r.zIndex=this.parent.zIndex++,e.popupRef&&s.setAttribute("aria-haspopup","dialog"),e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof kn){const{rotation:t}=e;return e.hasOwnCanvas||0===t||this.setRotation(t,s),s}const{width:a,height:o}=mn(e.rect);if(!t&&e.borderStyle.width>0){r.borderWidth=`${e.borderStyle.width}px`;const t=e.borderStyle.horizontalCornerRadius,i=e.borderStyle.verticalCornerRadius;if(t>0||i>0){const e=`calc(${t}px * var(--scale-factor)) / calc(${i}px * var(--scale-factor))`;r.borderRadius=e}else if(this instanceof Cn){const t=`calc(${a}px * var(--scale-factor)) / calc(${o}px * var(--scale-factor))`;r.borderRadius=t}switch(e.borderStyle.style){case y.SOLID:r.borderStyle="solid";break;case y.DASHED:r.borderStyle="dashed";break;case y.BEVELED:k("Unimplemented border style: beveled");break;case y.INSET:k("Unimplemented border style: inset");break;case y.UNDERLINE:r.borderBottomStyle="solid";break;default:break}const n=e.borderColor||null;n?(this.#Ji=!0,r.borderColor=Y.makeHexColor(0|n[0],0|n[1],0|n[2])):r.borderWidth=0}const l=Y.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:c,pageHeight:h,pageX:d,pageY:u}=n.rawDims;r.left=100*(l[0]-d)/c+"%",r.top=100*(l[1]-u)/h+"%";const{rotation:p}=e;return e.hasOwnCanvas||0===p?(r.width=100*a/c+"%",r.height=100*o/h+"%"):this.setRotation(p,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims,{width:s,height:r}=mn(this.data.rect);let a,o;t%180===0?(a=100*s/i,o=100*r/n):(a=100*r/i,o=100*s/n),e.style.width=`${a}%`,e.style.height=`${o}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(t,e,i)=>{const n=i.detail[t],s=n[0],r=n.slice(1);i.target.style[e]=dn[`${s}_HTML`](r),this.annotationStorage.setValue(this.data.id,{[e]:dn[`${s}_rgb`](r)})};return D(this,"_commonActions",{display:t=>{const{display:e}=t.detail,i=e%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:1===e||2===e})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:e}=t.detail;this.container.style.visibility=e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:e,noView:e})},focus:t=>{setTimeout((()=>t.target.focus({preventScroll:!1})),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e),this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail)){const s=t[n]||i[n];s?.(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,s]of Object.entries(e)){const r=i[n];if(r){const i={detail:{[n]:s},target:t};r(i),delete e[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,s]=this.data.rect;if(1===t.length){const[,{x:r,y:a},{x:o,y:l}]=t[0];if(n===r&&s===a&&e===o&&i===l)return}const{style:r}=this.container;let a;if(this.#Ji){const{borderColor:t,borderWidth:e}=r;r.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${t}" stroke-width="${e}">`],this.container.classList.add("hasBorder")}const o=n-e,l=s-i,{svgFactory:c}=this,h=c.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const d=c.createElement("defs");h.append(d);const u=c.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),d.append(u);for(const[,{x:f,y:g},{x:m,y:v}]of t){const t=c.createElement("rect"),i=(m-e)/o,n=(s-g)/l,r=(f-m)/o,h=(g-v)/l;t.setAttribute("x",i),t.setAttribute("y",n),t.setAttribute("width",r),t.setAttribute("height",h),u.append(t),a?.push(`<rect vector-effect="non-scaling-stroke" x="${i}" y="${n}" width="${r}" height="${h}"/>`)}this.#Ji&&(a.push("</g></svg>')"),r.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const i=this.#Zi=new kn({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(i.render())}render(){I("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:t,id:s,exportValues:r}of n){if(-1===t)continue;if(s===e)continue;const n="string"===typeof r?r:null,a=document.querySelector(`[data-element-id="${s}"]`);!a||gn.has(a)?i.push({id:s,exportValue:n,domElement:a}):k(`_getElementsByName - element not allowed: ${s}`)}return i}for(const n of document.getElementsByName(t)){const{exportValue:t}=n,s=n.getAttribute("data-element-id");s!==e&&(gn.has(n)&&i.push({id:s,exportValue:t,domElement:n}))}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",(()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})}))}}class yn extends bn{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action),n=!0):t.attachment?(this.#en(i,t.attachment,t.attachmentDest),n=!0):t.setOCGState?(this.#in(i,t.setOCGState),n=!0):t.dest?(this._bindLink(i,t.dest),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}#nn(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||""===e)&&this.#nn()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#nn()}#en(t,e,i=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,i),!1),this.#nn()}#in(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#nn()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const s=i.get(n);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}}),!1))}t.onclick||(t.onclick=()=>!1),this.#nn()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#nn(),!this._fieldObjects)return k('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(i||(t.onclick=()=>!1));t.onclick=()=>{i?.();const{fields:t,refs:n,include:s}=e,r=[];if(0!==t.length||0!==n.length){const e=new Set(n);for(const i of t){const t=this._fieldObjects[i]||[];for(const{id:i}of t)e.add(i)}for(const t of Object.values(this._fieldObjects))for(const i of t)e.has(i.id)===s&&r.push(i)}else for(const e of Object.values(this._fieldObjects))r.push(...e);const a=this.annotationStorage,o=[];for(const e of r){const{id:t}=e;switch(o.push(t),e.type){case"text":{const i=e.defaultValue||"";a.setValue(t,{value:i});break}case"checkbox":case"radiobutton":{const i=e.defaultValue===e.exportValues;a.setValue(t,{value:i});break}case"combobox":case"listbox":{const i=e.defaultValue||"";a.setValue(t,{value:i});break}default:continue}const i=document.querySelector(`[data-element-id="${t}"]`);i&&(gn.has(i)?i.dispatchEvent(new Event("resetform")):k(`_bindResetFormAction - element not allowed: ${t}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}),!1}}}class An extends bn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class _n extends bn{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&("CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return q.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,s){i.includes("mouse")?t.addEventListener(i,(t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})})):t.addEventListener(i,(t=>{if("blur"===i){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===i){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(t)}})}))}_setEventListeners(t,e,i,n){for(const[s,r]of i)("Action"===r||this.data.actions?.[r])&&("Focus"!==r&&"Blur"!==r||(e||={focused:!1}),this._setEventListener(t,e,s,r,n),"Focus"!==r||this.data.actions?.Blur?"Blur"!==r||this.data.actions?.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":Y.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||fn,s=t.style;let r;const a=2,o=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-a),e=Math.round(t/(c*n))||1,i=t/e;r=Math.min(n,o(i/c))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-a);r=Math.min(n,o(t/c))}s.fontSize=`calc(${r}px * var(--scale-factor))`,s.color=Y.makeHexColor(i[0],i[1],i[2]),null!==this.data.textAlignment&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class En extends _n{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,n){const s=this.annotationStorage;for(const r of this._getElementsByName(t.name,t.id))r.domElement&&(r.domElement[e]=i),s.setValue(r.id,{[n]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let s=n.value||"";const r=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;r&&s.length>r&&(s=s.slice(0,r));let a=n.formattedValue||this.data.textContent?.join("\n")||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const o={userValue:s,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=a??s,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",a??s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),gn.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=pn,this._setRequired(i,this.data.required),r&&(i.maxLength=r),i.addEventListener("input",(n=>{t.setValue(e,{value:n.target.value}),this.setPropertyOnSiblings(i,"value",n.target.value,"value"),o.formattedValue=null})),i.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue??"";i.value=o.userValue=e,o.formattedValue=null}));let l=t=>{const{formattedValue:e}=o;null!==e&&void 0!==e&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",(t=>{if(o.focused)return;const{target:e}=t;o.userValue&&(e.value=o.userValue),o.lastCommittedValue=e.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)})),i.addEventListener("updatefromsandbox",(i=>{this.showElementAndHideCanvas(i.target);const n={value(i){o.userValue=i.detail.value??"",t.setValue(e,{value:o.userValue.toString()}),i.target.value=o.userValue},formattedValue(i){const{formattedValue:n}=i.detail;o.formattedValue=n,null!==n&&void 0!==n&&i.target!==document.activeElement&&(i.target.value=n),t.setValue(e,{formattedValue:n})},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:i=>{const{charLimit:n}=i.detail,{target:s}=i;if(0===n)return void s.removeAttribute("maxLength");s.setAttribute("maxLength",n);let r=o.userValue;!r||r.length<=n||(r=r.slice(0,n),s.value=o.userValue=r,t.setValue(e,{value:r}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:r,willCommit:!0,commitKey:1,selStart:s.selectionStart,selEnd:s.selectionEnd}}))}};this._dispatchEventFromSandbox(n,i)})),i.addEventListener("keydown",(t=>{o.commitKey=1;let i=-1;if("Escape"===t.key?i=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(o.commitKey=3):i=2,-1===i)return;const{value:n}=t.target;o.lastCommittedValue!==n&&(o.lastCommittedValue=n,o.userValue=n,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:n,willCommit:!0,commitKey:i,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))}));const n=l;l=null,i.addEventListener("blur",(t=>{if(!o.focused||!t.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{value:i}=t.target;o.userValue=i,o.lastCommittedValue!==i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:i,willCommit:!0,commitKey:o.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}),n(t)})),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",(t=>{o.lastCommittedValue=null;const{data:i,target:n}=t,{value:s,selectionStart:r,selectionEnd:a}=n;let l=r,c=a;switch(t.inputType){case"deleteWordBackward":{const t=s.substring(0,r).match(/\w*[^\w]*$/);t&&(l-=t[0].length);break}case"deleteWordForward":{const t=s.substring(r).match(/^[^\w]*\w*/);t&&(c+=t[0].length);break}case"deleteContentBackward":r===a&&(l-=1);break;case"deleteContentForward":r===a&&(c+=1);break}t.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,change:i||"",willCommit:!1,selStart:l,selEnd:c}})})),this._setEventListeners(i,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.value))}if(l&&i.addEventListener("blur",l),this.data.comb){const t=this.data.rect[2]-this.data.rect[0],e=t/r;i.classList.add("comb"),i.style.letterSpacing=`calc(${e}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class wn extends _n{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class xn extends _n{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;"string"===typeof n&&(n="Off"!==n,t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return gn.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=pn,s.addEventListener("change",(n=>{const{name:s,checked:r}=n.target;for(const a of this._getElementsByName(s,i)){const i=r&&a.exportValue===e.exportValue;a.domElement&&(a.domElement.checked=i),t.setValue(a.id,{value:i})}t.setValue(i,{value:r})})),s.addEventListener("resetform",(t=>{const i=e.defaultFieldValue||"Off";t.target.checked=i===e.exportValue})),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",(e=>{const n={value(e){e.target.checked="Off"!==e.detail.value,t.setValue(i,{value:e.target.checked})}};this._dispatchEventFromSandbox(n,e)})),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Cn extends _n{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if("string"===typeof n&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const r of this._getElementsByName(e.fieldName,i))t.setValue(r.id,{value:!1});const s=document.createElement("input");if(gn.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.tabIndex=pn,s.addEventListener("change",(e=>{const{name:n,checked:s}=e.target;for(const r of this._getElementsByName(n,i))t.setValue(r.id,{value:!1});t.setValue(i,{value:s})})),s.addEventListener("resetform",(t=>{const i=e.defaultFieldValue;t.target.checked=null!==i&&void 0!==i&&i===e.buttonValue})),this.enableScripting&&this.hasJSActions){const n=e.buttonValue;s.addEventListener("updatefromsandbox",(e=>{const s={value:e=>{const s=n===e.detail.value;for(const n of this._getElementsByName(e.target.name)){const e=s&&n.id===i;n.domElement&&(n.domElement.checked=e),t.setValue(n.id,{value:e})}}};this._dispatchEventFromSandbox(s,e)})),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(t=>t.target.checked))}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Sn extends yn{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",(t=>{this._dispatchEventFromSandbox({},t)}))),t}}class Tn extends _n{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");gn.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=pn;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",(t=>{const e=this.data.defaultFieldValue;for(const i of n.options)i.selected=i.value===e}));for(const c of this.data.options){const t=document.createElement("option");t.textContent=c.displayValue,t.value=c.exportValue,i.value.includes(c.exportValue)&&(t.setAttribute("selected",!0),s=!1),n.append(t)}let r=null;if(s){const t=document.createElement("option");t.value=" ",t.setAttribute("hidden",!0),t.setAttribute("selected",!0),n.prepend(t),r=()=>{t.remove(),n.removeEventListener("input",r),r=null},n.addEventListener("input",r)}const a=t=>{const e=t?"value":"textContent",{options:i,multiple:s}=n;return s?Array.prototype.filter.call(i,(t=>t.selected)).map((t=>t[e])):-1===i.selectedIndex?null:i[i.selectedIndex][e]};let o=a(!1);const l=t=>{const e=t.target.options;return Array.prototype.map.call(e,(t=>({displayValue:t.textContent,exportValue:t.value})))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",(i=>{const s={value(i){r?.();const s=i.detail.value,l=new Set(Array.isArray(s)?s:[s]);for(const t of n.options)t.selected=l.has(t.value);t.setValue(e,{value:a(!0)}),o=a(!1)},multipleSelection(t){n.multiple=!0},remove(i){const s=n.options,r=i.detail.remove;if(s[r].selected=!1,n.remove(r),s.length>0){const t=Array.prototype.findIndex.call(s,(t=>t.selected));-1===t&&(s[0].selected=!0)}t.setValue(e,{value:a(!0),items:l(i)}),o=a(!1)},clear(i){while(0!==n.length)n.remove(0);t.setValue(e,{value:null,items:[]}),o=a(!1)},insert(i){const{index:s,displayValue:r,exportValue:c}=i.detail.insert,h=n.children[s],d=document.createElement("option");d.textContent=r,d.value=c,h?h.before(d):n.append(d),t.setValue(e,{value:a(!0),items:l(i)}),o=a(!1)},items(i){const{items:s}=i.detail;while(0!==n.length)n.remove(0);for(const t of s){const{displayValue:e,exportValue:i}=t,s=document.createElement("option");s.textContent=e,s.value=i,n.append(s)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:a(!0),items:l(i)}),o=a(!1)},indices(i){const n=new Set(i.detail.indices);for(const t of i.target.options)t.selected=n.has(t.index);t.setValue(e,{value:a(!0)}),o=a(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(s,i)})),n.addEventListener("input",(i=>{const n=a(!0),s=a(!1);t.setValue(e,{value:n}),i.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:o,change:s,changeEx:n,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(t=>t.target.value))):n.addEventListener("input",(function(i){t.setValue(e,{value:a(!0)})})),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class kn extends bn{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:bn._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new In({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map((t=>`${it}${t}`)).join(",")),this.container}}class In{#sn=this.#rn.bind(this);#an=this.#on.bind(this);#ln=this.#cn.bind(this);#hn=this.#dn.bind(this);#un=null;#Lt=null;#pn=null;#fn=null;#gn=null;#mn=null;#vn=null;#bn=!1;#yn=null;#B=null;#An=null;#_n=null;#En=null;#Qi=null;#wn=!1;constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:s,contentsObj:r,richText:a,parent:o,rect:l,parentRect:c,open:h}){this.#Lt=t,this.#En=n,this.#pn=r,this.#_n=a,this.#mn=o,this.#un=e,this.#An=l,this.#vn=c,this.#gn=i,this.#fn=kt.toDateObject(s),this.trigger=i.flatMap((t=>t.getElementsToTriggerPopup()));for(const d of this.trigger)d.addEventListener("click",this.#hn),d.addEventListener("mouseenter",this.#ln),d.addEventListener("mouseleave",this.#an),d.classList.add("popupTriggerArea");for(const d of i)d.container?.addEventListener("keydown",this.#sn);this.#Lt.hidden=!0,h&&this.#dn()}render(){if(this.#yn)return;const t=this.#yn=document.createElement("div");if(t.className="popup",this.#un){const e=t.style.outlineColor=Y.makeHexColor(...this.#un);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))t.style.backgroundColor=`color-mix(in srgb, ${e} 30%, white)`;else{const e=.7;t.style.backgroundColor=Y.makeHexColor(...this.#un.map((t=>Math.floor(e*(255-t)+t))))}}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),({dir:i.dir,str:i.textContent}=this.#En),t.append(e),this.#fn){const t=document.createElement("span");t.classList.add("popupDate"),t.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),t.setAttribute("data-l10n-args",JSON.stringify({date:this.#fn.toLocaleDateString(),time:this.#fn.toLocaleTimeString()})),e.append(t)}const n=this.#xn;if(n)un.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const e=this._formatContents(this.#pn);t.append(e)}this.#Lt.append(t)}get#xn(){const t=this.#_n,e=this.#pn;return!t?.str||e?.str&&e.str!==t.str?null:this.#_n.html||null}get#Cn(){return this.#xn?.attributes?.style?.fontSize||0}get#Sn(){return this.#xn?.attributes?.style?.color||null}#Tn(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:this.#Sn,fontSize:this.#Cn?`calc(${this.#Cn}px * var(--scale-factor))`:""}};for(const s of t.split("\n"))e.push({name:"span",value:s,attributes:n});return i}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const n=t.split(/(?:\r\n?|\n)/);for(let s=0,r=n.length;s<r;++s){const t=n[s];i.append(document.createTextNode(t)),s<r-1&&i.append(document.createElement("br"))}return i}#rn(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&this.#bn)&&this.#dn()}updateEdited({rect:t,popupContent:e}){this.#Qi||={contentsObj:this.#pn,richText:this.#_n},t&&(this.#B=null),e&&(this.#_n=this.#Tn(e),this.#pn=null),this.#yn?.remove(),this.#yn=null}resetEdited(){this.#Qi&&(({contentsObj:this.#pn,richText:this.#_n}=this.#Qi),this.#Qi=null,this.#yn?.remove(),this.#yn=null,this.#B=null)}#kn(){if(null!==this.#B)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:s}}}=this.#mn;let r=!!this.#vn,a=r?this.#vn:this.#An;for(const p of this.#gn)if(!a||null!==Y.intersect(p.data.rect,a)){a=p.data.rect,r=!0;break}const o=Y.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),l=5,c=r?a[2]-a[0]+l:0,h=o[0]+c,d=o[1];this.#B=[100*(h-n)/e,100*(d-s)/i];const{style:u}=this.#Lt;u.left=`${this.#B[0]}%`,u.top=`${this.#B[1]}%`}#dn(){this.#bn=!this.#bn,this.#bn?(this.#cn(),this.#Lt.addEventListener("click",this.#hn),this.#Lt.addEventListener("keydown",this.#sn)):(this.#on(),this.#Lt.removeEventListener("click",this.#hn),this.#Lt.removeEventListener("keydown",this.#sn))}#cn(){this.#yn||this.render(),this.isVisible?this.#bn&&this.#Lt.classList.add("focused"):(this.#kn(),this.#Lt.hidden=!1,this.#Lt.style.zIndex=parseInt(this.#Lt.style.zIndex)+1e3)}#on(){this.#Lt.classList.remove("focused"),!this.#bn&&this.isVisible&&(this.#Lt.hidden=!0,this.#Lt.style.zIndex=parseInt(this.#Lt.style.zIndex)-1e3)}forceHide(){this.#wn=this.isVisible,this.#wn&&(this.#Lt.hidden=!0)}maybeShow(){this.#wn&&(this.#yn||this.#cn(),this.#wn=!1,this.#Lt.hidden=!1)}get isVisible(){return!1===this.#Lt.hidden}}class Mn extends bn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=p.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class Ln extends bn{#In=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:i}=mn(t.rect),n=this.svgFactory.create(e,i,!0),s=this.#In=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),n.append(s),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#In}addHighlightArea(){this.container.classList.add("highlightArea")}}class Rn extends bn{#Mn=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:i}=mn(t.rect),n=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,r=this.#Mn=this.svgFactory.createElement("svg:rect");return r.setAttribute("x",s/2),r.setAttribute("y",s/2),r.setAttribute("width",e-s),r.setAttribute("height",i-s),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Mn}addHighlightArea(){this.container.classList.add("highlightArea")}}class Dn extends bn{#Ln=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:i}=mn(t.rect),n=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,r=this.#Ln=this.svgFactory.createElement("svg:ellipse");return r.setAttribute("cx",e/2),r.setAttribute("cy",i/2),r.setAttribute("rx",e/2-s/2),r.setAttribute("ry",i/2-s/2),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Ln}addHighlightArea(){this.container.classList.add("highlightArea")}}class Pn extends bn{#Rn=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=mn(t.rect),n=this.svgFactory.create(e,i,!0);let s=[];for(const a of t.vertices){const e=a.x-t.rect[0],i=t.rect[3]-a.y;s.push(e+","+i)}s=s.join(" ");const r=this.#Rn=this.svgFactory.createElement(this.svgElementName);return r.setAttribute("points",s),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Rn}addHighlightArea(){this.container.classList.add("highlightArea")}}class On extends Pn{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Fn extends bn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Nn extends bn{#Dn=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=p.INK}render(){this.container.classList.add(this.containerClassName);const t=this.data,{width:e,height:i}=mn(t.rect),n=this.svgFactory.create(e,i,!0);for(const s of t.inkLists){let e=[];for(const n of s){const i=n.x-t.rect[0],s=t.rect[3]-n.y;e.push(`${i},${s}`)}e=e.join(" ");const i=this.svgFactory.createElement(this.svgElementName);this.#Dn.push(i),i.setAttribute("points",e),i.setAttribute("stroke-width",t.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),!t.popupRef&&this.hasPopupData&&this._createPopup(),n.append(i)}return this.container.append(n),this.container}getElementsToTriggerPopup(){return this.#Dn}addHighlightArea(){this.container.classList.add("highlightArea")}}class Bn extends bn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Un extends bn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class jn extends bn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Hn extends bn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class $n extends bn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class zn extends bn{#Pn=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||0===e.fillAlpha?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(100*e.fillAlpha)}%);`)),i.addEventListener("dblclick",this.#On.bind(this)),this.#Pn=i;const{isMac:n}=q.platform;return t.addEventListener("keydown",(t=>{"Enter"===t.key&&(n?t.metaKey:t.ctrlKey)&&this.#On()})),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#Pn}addHighlightArea(){this.container.classList.add("highlightArea")}#On(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Vn{#Fn=null;#Nn=null;#Bn=new Map;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:s,viewport:r}){this.div=t,this.#Fn=e,this.#Nn=i,this.page=s,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=n}#Un(t,e){const i=t.firstChild||t;i.id=`${it}${e}`,this.div.append(t),this.#Fn?.moveElementInDOM(this.div,t,i,!1)}async render(t){const{annotations:e}=t,i=this.div;Pt(i,this.viewport);const n=new Map,s={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new mt,annotationStorage:t.annotationStorage||new Zt,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const r of e){if(r.noHTML)continue;const t=r.annotationType===b.POPUP;if(t){const t=n.get(r.id);if(!t)continue;s.elements=t}else{const{width:t,height:e}=mn(r.rect);if(t<=0||e<=0)continue}s.data=r;const e=vn.create(s);if(!e.isRenderable)continue;if(!t&&r.popupRef){const t=n.get(r.popupRef);t?t.push(e):n.set(r.popupRef,[e])}const i=e.render();r.hidden&&(i.style.visibility="hidden"),this.#Un(i,r.id),e.annotationEditorType>0&&(this.#Bn.set(e.data.id,e),this._annotationEditorUIManager?.renderAnnotationElement(e))}this.#jn()}update({viewport:t}){const e=this.div;this.viewport=t,Pt(e,{rotation:t.rotation}),this.#jn(),e.hidden=!1}#jn(){if(!this.#Nn)return;const t=this.div;for(const[e,i]of this.#Nn){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;i.className="annotationContent";const{firstChild:s}=n;s?"CANVAS"===s.nodeName?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):n.append(i)}this.#Nn.clear()}getEditableAnnotations(){return Array.from(this.#Bn.values())}getEditableAnnotation(t){return this.#Bn.get(t)}}const Gn=/\r\n?|\n/g;class Kn extends Kt{#Hn=this.editorDivBlur.bind(this);#$n=this.editorDivFocus.bind(this);#zn=this.editorDivInput.bind(this);#Vn=this.editorDivKeydown.bind(this);#Gn=this.editorDivPaste.bind(this);#un;#Kn="";#Wn=`${this.id}-editor`;#Cn;#qn=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Kn.prototype,e=t=>t.isEmpty(),i=Vt.TRANSLATE_SMALL,n=Vt.TRANSLATE_BIG;return D(this,"_keyboardManager",new $t([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}]]))}static _type="freetext";static _editorType=p.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#un=t.color||Kn._defaultColor||Kt._defaultLineColor,this.#Cn=t.fontSize||Kn._defaultFontSize}static initialize(t,e){Kt.initialize(t,e,{strings:["pdfjs-free-text-default-content"]});const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case f.FREETEXT_SIZE:Kn._defaultFontSize=e;break;case f.FREETEXT_COLOR:Kn._defaultColor=e;break}}updateParams(t,e){switch(t){case f.FREETEXT_SIZE:this.#Xn(e);break;case f.FREETEXT_COLOR:this.#Yn(e);break}}static get defaultPropertiesToUpdate(){return[[f.FREETEXT_SIZE,Kn._defaultFontSize],[f.FREETEXT_COLOR,Kn._defaultColor||Kt._defaultLineColor]]}get propertiesToUpdate(){return[[f.FREETEXT_SIZE,this.#Cn],[f.FREETEXT_COLOR,this.#un]]}#Xn(t){const e=t=>{this.editorDiv.style.fontSize=`calc(${t}px * var(--scale-factor))`,this.translate(0,-(t-this.#Cn)*this.parentScale),this.#Cn=t,this.#Qn()},i=this.#Cn;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:f.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#Yn(t){const e=t=>{this.#un=this.editorDiv.style.color=t},i=this.#un;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:f.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Kn._internalPadding*t,-(Kn._internalPadding+this.#Cn)*t]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(p.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#Vn),this.editorDiv.addEventListener("focus",this.#$n),this.editorDiv.addEventListener("blur",this.#Hn),this.editorDiv.addEventListener("input",this.#zn),this.editorDiv.addEventListener("paste",this.#Gn))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#Wn),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#Vn),this.editorDiv.removeEventListener("focus",this.#$n),this.editorDiv.removeEventListener("blur",this.#Hn),this.editorDiv.removeEventListener("input",this.#zn),this.editorDiv.removeEventListener("paste",this.#Gn),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#Jn(){const t=[];this.editorDiv.normalize();for(const e of this.editorDiv.childNodes)t.push(Kn.#Zn(e));return t.join("\n")}#Qn(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,n=e.style.display,s=e.classList.contains("hidden");e.classList.remove("hidden"),e.style.display="hidden",t.div.append(this.div),i=e.getBoundingClientRect(),e.remove(),e.style.display=n,e.classList.toggle("hidden",s)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#Kn,e=this.#Kn=this.#Jn().trimEnd();if(t===e)return;const i=t=>{this.#Kn=t,t?(this.#ts(),this._uiManager.rebuild(this),this.#Qn()):this.remove()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#Qn()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Kn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#Wn),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),Kt._l10nPromise.get("pdfjs-free-text-default-content").then((t=>this.editorDiv?.setAttribute("default-content",t))),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#Cn}px * var(--scale-factor))`,i.color=this.#un,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Nt(this,this.div,["dblclick","keydown"]),this.width){const[i,n]=this.parentDimensions;if(this.annotationElementId){const{position:s}=this.#qn;let[r,a]=this.getInitialTranslation();[r,a]=this.pageTranslationToScreen(r,a);const[o,l]=this.pageDimensions,[c,h]=this.pageTranslation;let d,u;switch(this.rotation){case 0:d=t+(s[0]-c)/o,u=e+this.height-(s[1]-h)/l;break;case 90:d=t+(s[0]-c)/o,u=e-(s[1]-h)/l,[r,a]=[a,-r];break;case 180:d=t-this.width+(s[0]-c)/o,u=e-(s[1]-h)/l,[r,a]=[-r,-a];break;case 270:d=t+(s[0]-c-this.height*l)/o,u=e+(s[1]-h-this.width*o)/l,[r,a]=[-a,r];break}this.setAt(d*i,u*n,r,a)}else this.setAt(t*i,e*n,this.width*i,this.height*n);this.#ts(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#Zn(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Gn,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(1===i.length&&"text/plain"===i[0])return;t.preventDefault();const n=Kn.#es(e.getData("text")||"").replaceAll(Gn,"\n");if(!n)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const r=s.getRangeAt(0);if(!n.includes("\n"))return r.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),void s.collapseToStart();const{startContainer:a,startOffset:o}=r,l=[],c=[];if(a.nodeType===Node.TEXT_NODE){const t=a.parentElement;if(c.push(a.nodeValue.slice(o).replaceAll(Gn,"")),t!==this.editorDiv){let e=l;for(const i of this.editorDiv.childNodes)i!==t?e.push(Kn.#Zn(i)):e=c}l.push(a.nodeValue.slice(0,o).replaceAll(Gn,""))}else if(a===this.editorDiv){let t=l,e=0;for(const i of this.editorDiv.childNodes)e++===o&&(t=c),t.push(Kn.#Zn(i))}this.#Kn=`${l.join("\n")}${n}${c.join("\n")}`,this.#ts();const h=new Range;let d=l.reduce(((t,e)=>t+e.length),0);for(const{firstChild:u}of this.editorDiv.childNodes)if(u.nodeType===Node.TEXT_NODE){const t=u.nodeValue.length;if(d<=t){h.setStart(u,d),h.setEnd(u,d);break}d-=t}s.removeAllRanges(),s.addRange(h)}#ts(){if(this.editorDiv.replaceChildren(),this.#Kn)for(const t of this.#Kn.split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#is(){return this.#Kn.replaceAll(""," ")}static#es(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static deserialize(t,e,i){let n=null;if(t instanceof Mn){const{data:{defaultAppearanceData:{fontSize:e,fontColor:i},rect:s,rotation:r,id:a},textContent:o,textPosition:l,parent:{page:{pageNumber:c}}}=t;if(!o||0===o.length)return null;n=t={annotationType:p.FREETEXT,color:Array.from(i),fontSize:e,value:o.join("\n"),position:l,pageIndex:c-1,rect:s.slice(0),rotation:r,id:a,deleted:!1}}const s=super.deserialize(t,e,i);return s.#Cn=t.fontSize,s.#un=Y.makeHexColor(...t.color),s.#Kn=Kn.#es(t.value),s.annotationElementId=t.id||null,s.#qn=n,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const e=Kn._internalPadding*this.parentScale,i=this.getRect(e,e),n=Kt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#un),s={annotationType:p.FREETEXT,color:n,fontSize:this.#Cn,value:this.#is(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?s:this.annotationElementId&&!this.#ns(s)?null:(s.id=this.annotationElementId,s)}#ns(t){const{value:e,fontSize:i,color:n,pageIndex:s}=this.#qn;return this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some(((t,e)=>t!==n[e]))||t.pageIndex!==s}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:i}=e;i.fontSize=`calc(${this.#Cn}px * var(--scale-factor))`,i.color=this.#un,e.replaceChildren();for(const s of this.#Kn.split("\n")){const t=document.createElement("div");t.append(s?document.createTextNode(s):document.createElement("br")),e.append(t)}const n=Kn._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(n,n),popupContent:this.#Kn}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Wn{#ss;#rs=[];#as=[];constructor(t,e=0,i=0,n=!0){let s=1/0,r=-1/0,a=1/0,o=-1/0;const l=4,c=10**-l;for(const{x:m,y:v,width:b,height:y}of t){const t=Math.floor((m-e)/c)*c,i=Math.ceil((m+b+e)/c)*c,n=Math.floor((v-e)/c)*c,l=Math.ceil((v+y+e)/c)*c,h=[t,n,l,!0],d=[i,n,l,!1];this.#rs.push(h,d),s=Math.min(s,t),r=Math.max(r,i),a=Math.min(a,n),o=Math.max(o,l)}const h=r-s+2*i,d=o-a+2*i,u=s-i,p=a-i,f=this.#rs.at(n?-1:-2),g=[f[0],f[2]];for(const m of this.#rs){const[t,e,i]=m;m[0]=(t-u)/h,m[1]=(e-p)/d,m[2]=(i-p)/d}this.#ss={x:u,y:p,width:h,height:d,lastPoint:g}}getOutlines(){this.#rs.sort(((t,e)=>t[0]-e[0]||t[1]-e[1]||t[2]-e[2]));const t=[];for(const e of this.#rs)e[3]?(t.push(...this.#os(e)),this.#ls(e)):(this.#cs(e),t.push(...this.#os(e)));return this.#hs(t)}#hs(t){const e=[],i=new Set;for(const r of t){const[t,i,n]=r;e.push([t,i,r],[t,n,r])}e.sort(((t,e)=>t[1]-e[1]||t[0]-e[0]));for(let r=0,a=e.length;r<a;r+=2){const t=e[r][2],n=e[r+1][2];t.push(n),n.push(t),i.add(t),i.add(n)}const n=[];let s;while(i.size>0){const t=i.values().next().value;let[e,r,a,o,l]=t;i.delete(t);let c=e,h=r;s=[e,a],n.push(s);while(1){let t;if(i.has(o))t=o;else{if(!i.has(l))break;t=l}i.delete(t),[e,r,a,o,l]=t,c!==e&&(s.push(c,h,e,h===r?r:a),c=e),h=h===r?a:r}s.push(c,h)}return new Xn(n,this.#ss)}#ds(t){const e=this.#as;let i=0,n=e.length-1;while(i<=n){const s=i+n>>1,r=e[s][0];if(r===t)return s;r<t?i=s+1:n=s-1}return n+1}#ls([,t,e]){const i=this.#ds(t);this.#as.splice(i,0,[t,e])}#cs([,t,e]){const i=this.#ds(t);for(let n=i;n<this.#as.length;n++){const[i,s]=this.#as[n];if(i!==t)break;if(i===t&&s===e)return void this.#as.splice(n,1)}for(let n=i-1;n>=0;n--){const[i,s]=this.#as[n];if(i!==t)break;if(i===t&&s===e)return void this.#as.splice(n,1)}}#os(t){const[e,i,n]=t,s=[[e,i,n]],r=this.#ds(n);for(let a=0;a<r;a++){const[t,i]=this.#as[a];for(let n=0,r=s.length;n<r;n++){const[,a,o]=s[n];if(!(i<=a||o<=t))if(a>=t)if(o>i)s[n][1]=i;else{if(1===r)return[];s.splice(n,1),n--,r--}else s[n][2]=t,o>i&&s.push([e,i,o])}}return s}}class qn{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(t,e){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof Qn}}class Xn extends qn{#ss;#us;constructor(t,e){super(),this.#us=t,this.#ss=e}toSVGPath(){const t=[];for(const e of this.#us){let[i,n]=e;t.push(`M${i} ${n}`);for(let s=2;s<e.length;s+=2){const r=e[s],a=e[s+1];r===i?(t.push(`V${a}`),n=a):a===n&&(t.push(`H${r}`),i=r)}t.push("Z")}return t.join(" ")}serialize([t,e,i,n],s){const r=[],a=i-t,o=n-e;for(const l of this.#us){const e=new Array(l.length);for(let i=0;i<l.length;i+=2)e[i]=t+l[i]*a,e[i+1]=n-l[i+1]*o;r.push(e)}return r}get box(){return this.#ss}}class Yn{#ss;#ps=[];#fs;#gs;#ms=[];#vs=new Float64Array(18);#bs;#ys;#As;#_s;#Es;#ws;#xs=[];static#Cs=8;static#Ss=2;static#Ts=Yn.#Cs+Yn.#Ss;constructor({x:t,y:e},i,n,s,r,a=0){this.#ss=i,this.#ws=s*n,this.#gs=r,this.#vs.set([NaN,NaN,NaN,NaN,t,e],6),this.#fs=a,this.#_s=Yn.#Cs*n,this.#As=Yn.#Ts*n,this.#Es=n,this.#xs.push(t,e)}get free(){return!0}isEmpty(){return isNaN(this.#vs[8])}#ks(){const t=this.#vs.subarray(4,6),e=this.#vs.subarray(16,18),[i,n,s,r]=this.#ss;return[(this.#bs+(t[0]-e[0])/2-i)/s,(this.#ys+(t[1]-e[1])/2-n)/r,(this.#bs+(e[0]-t[0])/2-i)/s,(this.#ys+(e[1]-t[1])/2-n)/r]}add({x:t,y:e}){this.#bs=t,this.#ys=e;const[i,n,s,r]=this.#ss;let[a,o,l,c]=this.#vs.subarray(8,12);const h=t-l,d=e-c,u=Math.hypot(h,d);if(u<this.#As)return!1;const p=u-this.#_s,f=p/u,g=f*h,m=f*d;let v=a,b=o;a=l,o=c,l+=g,c+=m,this.#xs?.push(t,e);const y=-m/p,A=g/p,_=y*this.#ws,E=A*this.#ws;if(this.#vs.set(this.#vs.subarray(2,8),0),this.#vs.set([l+_,c+E],4),this.#vs.set(this.#vs.subarray(14,18),12),this.#vs.set([l-_,c-E],16),isNaN(this.#vs[6]))return 0===this.#ms.length&&(this.#vs.set([a+_,o+E],2),this.#ms.push(NaN,NaN,NaN,NaN,(a+_-i)/s,(o+E-n)/r),this.#vs.set([a-_,o-E],14),this.#ps.push(NaN,NaN,NaN,NaN,(a-_-i)/s,(o-E-n)/r)),this.#vs.set([v,b,a,o,l,c],6),!this.isEmpty();this.#vs.set([v,b,a,o,l,c],6);const w=Math.abs(Math.atan2(b-o,v-a)-Math.atan2(m,g));return w<Math.PI/2?([a,o,l,c]=this.#vs.subarray(2,6),this.#ms.push(NaN,NaN,NaN,NaN,((a+l)/2-i)/s,((o+c)/2-n)/r),[a,o,v,b]=this.#vs.subarray(14,18),this.#ps.push(NaN,NaN,NaN,NaN,((v+a)/2-i)/s,((b+o)/2-n)/r),!0):([v,b,a,o,l,c]=this.#vs.subarray(0,6),this.#ms.push(((v+5*a)/6-i)/s,((b+5*o)/6-n)/r,((5*a+l)/6-i)/s,((5*o+c)/6-n)/r,((a+l)/2-i)/s,((o+c)/2-n)/r),[l,c,a,o,v,b]=this.#vs.subarray(12,18),this.#ps.push(((v+5*a)/6-i)/s,((b+5*o)/6-n)/r,((5*a+l)/6-i)/s,((5*o+c)/6-n)/r,((a+l)/2-i)/s,((o+c)/2-n)/r),!0)}toSVGPath(){if(this.isEmpty())return"";const t=this.#ms,e=this.#ps,i=this.#vs.subarray(4,6),n=this.#vs.subarray(16,18),[s,r,a,o]=this.#ss,[l,c,h,d]=this.#ks();if(isNaN(this.#vs[6])&&!this.isEmpty())return`M${(this.#vs[2]-s)/a} ${(this.#vs[3]-r)/o} L${(this.#vs[4]-s)/a} ${(this.#vs[5]-r)/o} L${l} ${c} L${h} ${d} L${(this.#vs[16]-s)/a} ${(this.#vs[17]-r)/o} L${(this.#vs[14]-s)/a} ${(this.#vs[15]-r)/o} Z`;const u=[];u.push(`M${t[4]} ${t[5]}`);for(let p=6;p<t.length;p+=6)isNaN(t[p])?u.push(`L${t[p+4]} ${t[p+5]}`):u.push(`C${t[p]} ${t[p+1]} ${t[p+2]} ${t[p+3]} ${t[p+4]} ${t[p+5]}`);u.push(`L${(i[0]-s)/a} ${(i[1]-r)/o} L${l} ${c} L${h} ${d} L${(n[0]-s)/a} ${(n[1]-r)/o}`);for(let p=e.length-6;p>=6;p-=6)isNaN(e[p])?u.push(`L${e[p+4]} ${e[p+5]}`):u.push(`C${e[p]} ${e[p+1]} ${e[p+2]} ${e[p+3]} ${e[p+4]} ${e[p+5]}`);return u.push(`L${e[4]} ${e[5]} Z`),u.join(" ")}getOutlines(){const t=this.#ms,e=this.#ps,i=this.#vs,n=i.subarray(4,6),s=i.subarray(16,18),[r,a,o,l]=this.#ss,c=new Float64Array((this.#xs?.length??0)+2);for(let m=0,v=c.length-2;m<v;m+=2)c[m]=(this.#xs[m]-r)/o,c[m+1]=(this.#xs[m+1]-a)/l;c[c.length-2]=(this.#bs-r)/o,c[c.length-1]=(this.#ys-a)/l;const[h,d,u,p]=this.#ks();if(isNaN(i[6])&&!this.isEmpty()){const t=new Float64Array(36);return t.set([NaN,NaN,NaN,NaN,(i[2]-r)/o,(i[3]-a)/l,NaN,NaN,NaN,NaN,(i[4]-r)/o,(i[5]-a)/l,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,u,p,NaN,NaN,NaN,NaN,(i[16]-r)/o,(i[17]-a)/l,NaN,NaN,NaN,NaN,(i[14]-r)/o,(i[15]-a)/l],0),new Qn(t,c,this.#ss,this.#Es,this.#fs,this.#gs)}const f=new Float64Array(this.#ms.length+24+this.#ps.length);let g=t.length;for(let m=0;m<g;m+=2)isNaN(t[m])?f[m]=f[m+1]=NaN:(f[m]=t[m],f[m+1]=t[m+1]);f.set([NaN,NaN,NaN,NaN,(n[0]-r)/o,(n[1]-a)/l,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,u,p,NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l],g),g+=24;for(let m=e.length-6;m>=6;m-=6)for(let t=0;t<6;t+=2)isNaN(e[m+t])?(f[g]=f[g+1]=NaN,g+=2):(f[g]=e[m+t],f[g+1]=e[m+t+1],g+=2);return f.set([NaN,NaN,NaN,NaN,e[4],e[5]],g),new Qn(f,c,this.#ss,this.#Es,this.#fs,this.#gs)}}class Qn extends qn{#ss;#Is=null;#fs;#gs;#xs;#Es;#Ms;constructor(t,e,i,n,s,r){super(),this.#Ms=t,this.#xs=e,this.#ss=i,this.#Es=n,this.#fs=s,this.#gs=r,this.#Ls(r);const{x:a,y:o,width:l,height:c}=this.#Is;for(let h=0,d=t.length;h<d;h+=2)t[h]=(t[h]-a)/l,t[h+1]=(t[h+1]-o)/c;for(let h=0,d=e.length;h<d;h+=2)e[h]=(e[h]-a)/l,e[h+1]=(e[h+1]-o)/c}toSVGPath(){const t=[`M${this.#Ms[4]} ${this.#Ms[5]}`];for(let e=6,i=this.#Ms.length;e<i;e+=6)isNaN(this.#Ms[e])?t.push(`L${this.#Ms[e+4]} ${this.#Ms[e+5]}`):t.push(`C${this.#Ms[e]} ${this.#Ms[e+1]} ${this.#Ms[e+2]} ${this.#Ms[e+3]} ${this.#Ms[e+4]} ${this.#Ms[e+5]}`);return t.push("Z"),t.join(" ")}serialize([t,e,i,n],s){const r=i-t,a=n-e;let o,l;switch(s){case 0:o=this.#Rs(this.#Ms,t,n,r,-a),l=this.#Rs(this.#xs,t,n,r,-a);break;case 90:o=this.#Ds(this.#Ms,t,e,r,a),l=this.#Ds(this.#xs,t,e,r,a);break;case 180:o=this.#Rs(this.#Ms,i,e,-r,a),l=this.#Rs(this.#xs,i,e,-r,a);break;case 270:o=this.#Ds(this.#Ms,i,n,-r,-a),l=this.#Ds(this.#xs,i,n,-r,-a);break}return{outline:Array.from(o),points:[Array.from(l)]}}#Rs(t,e,i,n,s){const r=new Float64Array(t.length);for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a]*n,r[a+1]=i+t[a+1]*s;return r}#Ds(t,e,i,n,s){const r=new Float64Array(t.length);for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a+1]*n,r[a+1]=i+t[a]*s;return r}#Ls(t){const e=this.#Ms;let i=e[4],n=e[5],s=i,r=n,a=i,o=n,l=i,c=n;const h=t?Math.max:Math.min;for(let g=6,m=e.length;g<m;g+=6){if(isNaN(e[g]))s=Math.min(s,e[g+4]),r=Math.min(r,e[g+5]),a=Math.max(a,e[g+4]),o=Math.max(o,e[g+5]),c<e[g+5]?(l=e[g+4],c=e[g+5]):c===e[g+5]&&(l=h(l,e[g+4]));else{const t=Y.bezierBoundingBox(i,n,...e.slice(g,g+6));s=Math.min(s,t[0]),r=Math.min(r,t[1]),a=Math.max(a,t[2]),o=Math.max(o,t[3]),c<t[3]?(l=t[2],c=t[3]):c===t[3]&&(l=h(l,t[2]))}i=e[g+4],n=e[g+5]}const d=s-this.#fs,u=r-this.#fs,p=a-s+2*this.#fs,f=o-r+2*this.#fs;this.#Is={x:d,y:u,width:p,height:f,lastPoint:[l,c]}}get box(){return this.#Is}getNewOutline(t,e){const{x:i,y:n,width:s,height:r}=this.#Is,[a,o,l,c]=this.#ss,h=s*l,d=r*c,u=i*l+a,p=n*c+o,f=new Yn({x:this.#xs[0]*h+u,y:this.#xs[1]*d+p},this.#ss,this.#Es,t,this.#gs,e??this.#fs);for(let g=2;g<this.#xs.length;g+=2)f.add({x:this.#xs[g]*h+u,y:this.#xs[g+1]*d+p});return f.getOutlines()}}class Jn{#sn=this.#rn.bind(this);#Ps=this.#w.bind(this);#Os=null;#Fs=null;#Ns;#Bs=null;#Us=!1;#js=!1;#_=null;#Hs;#I=null;#$s;static get _keyboardManager(){return D(this,"_keyboardManager",new $t([[["Escape","mac+Escape"],Jn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Jn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Jn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Jn.prototype._moveToPrevious],[["Home","mac+Home"],Jn.prototype._moveToBeginning],[["End","mac+End"],Jn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#js=!1,this.#$s=f.HIGHLIGHT_COLOR,this.#_=t):(this.#js=!0,this.#$s=f.HIGHLIGHT_DEFAULT_COLOR),this.#I=t?._uiManager||e,this.#Hs=this.#I._eventBus,this.#Ns=t?.color||this.#I?.highlightColors.values().next().value||"#FFFF98"}renderButton(){const t=this.#Os=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0),t.addEventListener("click",this.#zs.bind(this)),t.addEventListener("keydown",this.#sn);const e=this.#Fs=document.createElement("span");return e.className="swatch",e.setAttribute("aria-hidden",!0),e.style.backgroundColor=this.#Ns,t.append(e),t}renderMainDropdown(){const t=this.#Bs=this.#Vs();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#Vs(){const t=document.createElement("div");t.addEventListener("contextmenu",Ct),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[e,i]of this.#I.highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",i),n.title=e,n.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${e}`);const s=document.createElement("span");n.append(s),s.className="swatch",s.style.backgroundColor=i,n.setAttribute("aria-selected",i===this.#Ns),n.addEventListener("click",this.#Gs.bind(this,i)),t.append(n)}return t.addEventListener("keydown",this.#sn),t}#Gs(t,e){e.stopPropagation(),this.#Hs.dispatch("switchannotationeditorparams",{source:this,type:this.#$s,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#Os)return void this.#zs(t);const e=t.target.getAttribute("data-color");e&&this.#Gs(e,t)}_moveToNext(t){this.#Ks?t.target!==this.#Os?t.target.nextSibling?.focus():this.#Bs.firstChild?.focus():this.#zs(t)}_moveToPrevious(t){t.target!==this.#Bs?.firstChild&&t.target!==this.#Os?(this.#Ks||this.#zs(t),t.target.previousSibling?.focus()):this.#Ks&&this._hideDropdownFromKeyboard()}_moveToBeginning(t){this.#Ks?this.#Bs.firstChild?.focus():this.#zs(t)}_moveToEnd(t){this.#Ks?this.#Bs.lastChild?.focus():this.#zs(t)}#rn(t){Jn._keyboardManager.exec(this,t)}#zs(t){if(this.#Ks)return void this.hideDropdown();if(this.#Us=0===t.detail,window.addEventListener("pointerdown",this.#Ps),this.#Bs)return void this.#Bs.classList.remove("hidden");const e=this.#Bs=this.#Vs();this.#Os.append(e)}#w(t){this.#Bs?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#Bs?.classList.add("hidden"),window.removeEventListener("pointerdown",this.#Ps)}get#Ks(){return this.#Bs&&!this.#Bs.classList.contains("hidden")}_hideDropdownFromKeyboard(){this.#js||(this.#Ks?(this.hideDropdown(),this.#Os.focus({preventScroll:!0,focusVisible:this.#Us})):this.#_?.unselect())}updateColor(t){if(this.#Fs&&(this.#Fs.style.backgroundColor=t),!this.#Bs)return;const e=this.#I.highlightColors.values();for(const i of this.#Bs.children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#Os?.remove(),this.#Os=null,this.#Fs=null,this.#Bs?.remove(),this.#Bs=null}}class Zn extends Kt{#Ws=null;#qs=0;#Xs;#Ys=null;#A=null;#Qs=null;#Js=null;#Zs=0;#tr=null;#er=null;#o=null;#ir=!1;#At=this.#nr.bind(this);#sr=null;#rr;#ar=null;#or="";#ws;#lr="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _l10nPromise;static _type="highlight";static _editorType=p.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Zn.prototype;return D(this,"_keyboardManager",new $t([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Zn._defaultColor,this.#ws=t.thickness||Zn._defaultThickness,this.#rr=t.opacity||Zn._defaultOpacity,this.#Xs=t.boxes||null,this.#lr=t.methodOfCreation||"",this.#or=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#ir=!0,this.#cr(t),this.#hr()):(this.#Ws=t.anchorNode,this.#qs=t.anchorOffset,this.#Js=t.focusNode,this.#Zs=t.focusOffset,this.#dr(),this.#hr(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#ir?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#ws,methodOfCreation:this.#lr}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#dr(){const t=new Wn(this.#Xs,.001);this.#er=t.getOutlines(),({x:this.x,y:this.y,width:this.width,height:this.height}=this.#er.box);const e=new Wn(this.#Xs,.0025,.001,"ltr"===this._uiManager.direction);this.#Qs=e.getOutlines();const{lastPoint:i}=this.#Qs.box;this.#sr=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#cr({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#er=t;const n=1.5;if(this.#Qs=t.getNewOutline(this.#ws/2+n,.0025),e>=0)this.#o=e,this.#Ys=i,this.parent.drawLayer.finalizeLine(e,t),this.#ar=this.parent.drawLayer.highlightOutline(this.#Qs);else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(this.#o,t),this.parent.drawLayer.updateBox(this.#o,Zn.#ur(this.#er.box,(e-this.rotation+360)%360)),this.parent.drawLayer.updateLine(this.#ar,this.#Qs),this.parent.drawLayer.updateBox(this.#ar,Zn.#ur(this.#Qs.box,e))}const{x:s,y:r,width:a,height:o}=t.box;switch(this.rotation){case 0:this.x=s,this.y=r,this.width=a,this.height=o;break;case 90:{const[t,e]=this.parentDimensions;this.x=r,this.y=1-s,this.width=a*e/t,this.height=o*t/e;break}case 180:this.x=1-s,this.y=1-r,this.width=a,this.height=o;break;case 270:{const[t,e]=this.parentDimensions;this.x=1-r,this.y=s,this.width=a*e/t,this.height=o*t/e;break}}const{lastPoint:l}=this.#Qs.box;this.#sr=[(l[0]-s)/a,(l[1]-r)/o]}static initialize(t,e){Kt.initialize(t,e),Zn._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case f.HIGHLIGHT_DEFAULT_COLOR:Zn._defaultColor=e;break;case f.HIGHLIGHT_THICKNESS:Zn._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#sr}updateParams(t,e){switch(t){case f.HIGHLIGHT_COLOR:this.#Yn(e);break;case f.HIGHLIGHT_THICKNESS:this.#pr(e);break}}static get defaultPropertiesToUpdate(){return[[f.HIGHLIGHT_DEFAULT_COLOR,Zn._defaultColor],[f.HIGHLIGHT_THICKNESS,Zn._defaultThickness]]}get propertiesToUpdate(){return[[f.HIGHLIGHT_COLOR,this.color||Zn._defaultColor],[f.HIGHLIGHT_THICKNESS,this.#ws||Zn._defaultThickness],[f.HIGHLIGHT_FREE,this.#ir]]}#Yn(t){const e=t=>{this.color=t,this.parent?.drawLayer.changeColor(this.#o,t),this.#A?.updateColor(t)},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:f.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#pr(t){const e=this.#ws,i=t=>{this.#ws=t,this.#fr(t)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:f.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#A=new Jn({editor:this}),t.addColorPicker(this.#A)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#gr())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#gr())}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){this.#mr(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#hr(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#mr():t&&(this.#hr(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#fr(t){if(!this.#ir)return;this.#cr({highlightOutlines:this.#er.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}#mr(){null!==this.#o&&this.parent&&(this.parent.drawLayer.remove(this.#o),this.#o=null,this.parent.drawLayer.remove(this.#ar),this.#ar=null)}#hr(t=this.parent){null===this.#o&&(({id:this.#o,clipPathId:this.#Ys}=t.drawLayer.highlight(this.#er,this.color,this.#rr)),this.#ar=t.drawLayer.highlightOutline(this.#Qs),this.#tr&&(this.#tr.style.clipPath=this.#Ys))}static#ur({x:t,y:e,width:i,height:n},s){switch(s){case 90:return{x:1-e-n,y:t,width:n,height:i};case 180:return{x:1-t-i,y:1-e-n,width:i,height:n};case 270:return{x:e,y:1-t-i,width:n,height:i}}return{x:t,y:e,width:i,height:n}}rotate(t){const{drawLayer:e}=this.parent;let i;this.#ir?(t=(t-this.rotation+360)%360,i=Zn.#ur(this.#er.box,t)):i=Zn.#ur(this,t),e.rotate(this.#o,t),e.rotate(this.#ar,t),e.updateBox(this.#o,i),e.updateBox(this.#ar,Zn.#ur(this.#Qs.box,t))}render(){if(this.div)return this.div;const t=super.render();this.#or&&(t.setAttribute("aria-label",this.#or),t.setAttribute("role","mark")),this.#ir?t.classList.add("free"):this.div.addEventListener("keydown",this.#At);const e=this.#tr=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#Ys;const[i,n]=this.parentDimensions;return this.setDims(this.width*i,this.height*n),Nt(this,this.#tr,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.parent.drawLayer.addClass(this.#ar,"hovered")}pointerleave(){this.parent.drawLayer.removeClass(this.#ar,"hovered")}#nr(t){Zn._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#vr(!0);break;case 1:case 3:this.#vr(!1);break}}#vr(t){if(!this.#Ws)return;const e=window.getSelection();t?e.setPosition(this.#Ws,this.#qs):e.setPosition(this.#Js,this.#Zs)}select(){super.select(),this.#ar&&(this.parent?.drawLayer.removeClass(this.#ar,"hovered"),this.parent?.drawLayer.addClass(this.#ar,"selected"))}unselect(){super.unselect(),this.#ar&&(this.parent?.drawLayer.removeClass(this.#ar,"selected"),this.#ir||this.#vr(!1))}get _mustFixPosition(){return!this.#ir}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.show(this.#o,t),this.parent.drawLayer.show(this.#ar,t))}#gr(){return this.#ir?this.rotation:0}#br(){if(this.#ir)return null;const[t,e]=this.pageDimensions,i=this.#Xs,n=new Array(8*i.length);let s=0;for(const{x:r,y:a,width:o,height:l}of i){const i=r*t,c=(1-a-l)*e;n[s]=n[s+4]=i,n[s+1]=n[s+3]=c,n[s+2]=n[s+6]=i+o*t,n[s+5]=n[s+7]=c+l*e,s+=8}return n}#yr(t){return this.#er.serialize(t,this.#gr())}static startHighlighting(t,e,{target:i,x:n,y:s}){const{x:r,y:a,width:o,height:l}=i.getBoundingClientRect(),c=e=>{this.#Ar(t,e)},h={capture:!0,passive:!1},d=t=>{t.preventDefault(),t.stopPropagation()},u=e=>{i.removeEventListener("pointermove",c),window.removeEventListener("blur",u),window.removeEventListener("pointerup",u),window.removeEventListener("pointerdown",d,h),window.removeEventListener("contextmenu",Ct),this.#_r(t,e)};window.addEventListener("blur",u),window.addEventListener("pointerup",u),window.addEventListener("pointerdown",d,h),window.addEventListener("contextmenu",Ct),i.addEventListener("pointermove",c),this._freeHighlight=new Yn({x:n,y:s},[r,a,o,l],t.scale,this._defaultThickness/2,e,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0))}static#Ar(t,e){this._freeHighlight.add(e)&&t.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)}static#_r(t,e){this._freeHighlight.isEmpty()?t.drawLayer.removeFreeHighlight(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(t,e,i){const n=super.deserialize(t,e,i),{rect:[s,r,a,o],color:l,quadPoints:c}=t;n.color=Y.makeHexColor(...l),n.#rr=t.opacity;const[h,d]=n.pageDimensions;n.width=(a-s)/h,n.height=(o-r)/d;const u=n.#Xs=[];for(let p=0;p<c.length;p+=8)u.push({x:(c[4]-a)/h,y:(o-(1-c[p+5]))/d,width:(c[p+2]-c[p])/h,height:(c[p+5]-c[p+1])/d});return n.#dr(),n}serialize(t=!1){if(this.isEmpty()||t)return null;const e=this.getRect(0,0),i=Kt._colorManager.convert(this.color);return{annotationType:p.HIGHLIGHT,color:i,opacity:this.#rr,thickness:this.#ws,quadPoints:this.#br(),outlines:this.#yr(e),pageIndex:this.pageIndex,rect:e,rotation:this.#gr(),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}}class ts extends Kt{#Er=0;#wr=0;#xr=this.canvasPointermove.bind(this);#Cr=this.canvasPointerleave.bind(this);#Sr=this.canvasPointerup.bind(this);#Tr=this.canvasPointerdown.bind(this);#kr=null;#Ir=new Path2D;#Mr=!1;#Lr=!1;#Rr=!1;#Dr=null;#Pr=0;#Or=0;#Fr=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";static _editorType=p.INK;constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t,e){Kt.initialize(t,e)}static updateDefaultParams(t,e){switch(t){case f.INK_THICKNESS:ts._defaultThickness=e;break;case f.INK_COLOR:ts._defaultColor=e;break;case f.INK_OPACITY:ts._defaultOpacity=e/100;break}}updateParams(t,e){switch(t){case f.INK_THICKNESS:this.#pr(e);break;case f.INK_COLOR:this.#Yn(e);break;case f.INK_OPACITY:this.#Nr(e);break}}static get defaultPropertiesToUpdate(){return[[f.INK_THICKNESS,ts._defaultThickness],[f.INK_COLOR,ts._defaultColor||Kt._defaultLineColor],[f.INK_OPACITY,Math.round(100*ts._defaultOpacity)]]}get propertiesToUpdate(){return[[f.INK_THICKNESS,this.thickness||ts._defaultThickness],[f.INK_COLOR,this.color||ts._defaultColor||Kt._defaultLineColor],[f.INK_OPACITY,Math.round(100*(this.opacity??ts._defaultOpacity))]]}#pr(t){const e=t=>{this.thickness=t,this.#Br()},i=this.thickness;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:f.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#Yn(t){const e=t=>{this.color=t,this.#Ur()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:f.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#Nr(t){const e=t=>{this.opacity=t,this.#Ur()};t/=100;const i=this.opacity;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:f.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||(this.#jr(),this.#Hr()),this.isAttachedToDOM||(this.parent.add(this),this.#$r()),this.#Br()))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#kr&&(clearTimeout(this.#kr),this.#kr=null),this.#Dr.disconnect(),this.#Dr=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&null===t&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,e]=this.parentDimensions,i=this.width*t,n=this.height*e;this.setDimensions(i,n)}enableEditMode(){this.#Mr||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#Tr))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#Tr))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#zr(){const{parentRotation:t,parentDimensions:[e,i]}=this;switch(t){case 90:return[0,i,i,e];case 180:return[e,i,e,i];case 270:return[e,0,i,e];default:return[0,0,e,i]}}#Vr(){const{ctx:t,color:e,opacity:i,thickness:n,parentScale:s,scaleFactor:r}=this;t.lineWidth=n*s/r,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${e}${Bt(i)}`}#Gr(t,e){this.canvas.addEventListener("contextmenu",Ct),this.canvas.addEventListener("pointerleave",this.#Cr),this.canvas.addEventListener("pointermove",this.#xr),this.canvas.addEventListener("pointerup",this.#Sr),this.canvas.removeEventListener("pointerdown",this.#Tr),this.isEditing=!0,this.#Rr||(this.#Rr=!0,this.#$r(),this.thickness||=ts._defaultThickness,this.color||=ts._defaultColor||Kt._defaultLineColor,this.opacity??=ts._defaultOpacity),this.currentPath.push([t,e]),this.#Lr=!1,this.#Vr(),this.#Fr=()=>{this.#Kr(),this.#Fr&&window.requestAnimationFrame(this.#Fr)},window.requestAnimationFrame(this.#Fr)}#Wr(t,e){const[i,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===i&&e===n)return;const s=this.currentPath;let r=this.#Ir;if(s.push([t,e]),this.#Lr=!0,s.length<=2)return r.moveTo(...s[0]),void r.lineTo(t,e);3===s.length&&(this.#Ir=r=new Path2D,r.moveTo(...s[0])),this.#qr(r,...s.at(-3),...s.at(-2),t,e)}#Xr(){if(0===this.currentPath.length)return;const t=this.currentPath.at(-1);this.#Ir.lineTo(...t)}#Yr(t,e){let i;if(this.#Fr=null,t=Math.min(Math.max(t,0),this.canvas.width),e=Math.min(Math.max(e,0),this.canvas.height),this.#Wr(t,e),this.#Xr(),1!==this.currentPath.length)i=this.#Qr();else{const n=[t,e];i=[[n,n.slice(),n.slice(),n]]}const n=this.#Ir,s=this.currentPath;this.currentPath=[],this.#Ir=new Path2D;const r=()=>{this.allRawPaths.push(s),this.paths.push(i),this.bezierPath2D.push(n),this._uiManager.rebuild(this)},a=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#jr(),this.#Hr()),this.#Br())};this.addCommands({cmd:r,undo:a,mustExec:!0})}#Kr(){if(!this.#Lr)return;this.#Lr=!1;const t=Math.ceil(this.thickness*this.parentScale),e=this.currentPath.slice(-3),i=e.map((t=>t[0])),n=e.map((t=>t[1])),{ctx:s}=(Math.min(...i),Math.max(...i),Math.min(...n),Math.max(...n),this);s.save(),s.clearRect(0,0,this.canvas.width,this.canvas.height);for(const r of this.bezierPath2D)s.stroke(r);s.stroke(this.#Ir),s.restore()}#qr(t,e,i,n,s,r,a){const o=(e+n)/2,l=(i+s)/2,c=(n+r)/2,h=(s+a)/2;t.bezierCurveTo(o+2*(n-o)/3,l+2*(s-l)/3,c+2*(n-c)/3,h+2*(s-h)/3,c,h)}#Qr(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const e=[];let i,[n,s]=t[0];for(i=1;i<t.length-2;i++){const[r,a]=t[i],[o,l]=t[i+1],c=(r+o)/2,h=(a+l)/2,d=[n+2*(r-n)/3,s+2*(a-s)/3],u=[c+2*(r-c)/3,h+2*(a-h)/3];e.push([[n,s],d,u,[c,h]]),[n,s]=[c,h]}const[r,a]=t[i],[o,l]=t[i+1],c=[n+2*(r-n)/3,s+2*(a-s)/3],h=[o+2*(r-o)/3,l+2*(a-l)/3];return e.push([[n,s],c,h,[o,l]]),e}#Ur(){if(this.isEmpty())return void this.#Jr();this.#Vr();const{canvas:t,ctx:e}=this;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height),this.#Jr();for(const i of this.bezierPath2D)e.stroke(i)}commit(){this.#Mr||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#Mr=!0,this.div.classList.add("disabled"),this.#Br(!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){0===t.button&&this.isInEditMode()&&!this.#Mr&&(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),this.#Gr(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#Wr(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#Zr(t)}canvasPointerleave(t){this.#Zr(t)}#Zr(t){this.canvas.removeEventListener("pointerleave",this.#Cr),this.canvas.removeEventListener("pointermove",this.#xr),this.canvas.removeEventListener("pointerup",this.#Sr),this.canvas.addEventListener("pointerdown",this.#Tr),this.#kr&&clearTimeout(this.#kr),this.#kr=setTimeout((()=>{this.#kr=null,this.canvas.removeEventListener("contextmenu",Ct)}),10),this.#Yr(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#jr(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#Hr(){this.#Dr=new ResizeObserver((t=>{const e=t[0].contentRect;e.width&&e.height&&this.setDimensions(e.width,e.height)})),this.#Dr.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#Mr}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,n,s,r]=this.#zr();if(this.setAt(i,n,0,0),this.setDims(s,r),this.#jr(),this.width){const[i,n]=this.parentDimensions;this.setAspectRatio(this.width*i,this.height*n),this.setAt(t*i,e*n,this.width*i,this.height*n),this.#Rr=!0,this.#$r(),this.setDims(this.width*i,this.height*n),this.#Ur(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#Hr(),this.div}#$r(){if(!this.#Rr)return;const[t,e]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*e),this.#Jr()}setDimensions(t,e){const i=Math.round(t),n=Math.round(e);if(this.#Pr===i&&this.#Or===n)return;this.#Pr=i,this.#Or=n,this.canvas.style.visibility="hidden";const[s,r]=this.parentDimensions;this.width=t/s,this.height=e/r,this.fixAndSetPosition(),this.#Mr&&this.#ta(t,e),this.#$r(),this.#Ur(),this.canvas.style.visibility="visible",this.fixDims()}#ta(t,e){const i=this.#ea(),n=(t-i)/this.#wr,s=(e-i)/this.#Er;this.scaleFactor=Math.min(n,s)}#Jr(){const t=this.#ea()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#ia(t){const e=new Path2D;for(let i=0,n=t.length;i<n;i++){const[n,s,r,a]=t[i];0===i&&e.moveTo(...n),e.bezierCurveTo(s[0],s[1],r[0],r[1],a[0],a[1])}return e}static#na(t,e,i){const[n,s,r,a]=e;switch(i){case 0:for(let e=0,i=t.length;e<i;e+=2)t[e]+=n,t[e+1]=a-t[e+1];break;case 90:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=t[e+1]+n,t[e+1]=i+s}break;case 180:for(let e=0,i=t.length;e<i;e+=2)t[e]=r-t[e],t[e+1]+=s;break;case 270:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=r-t[e+1],t[e+1]=a-i}break;default:throw new Error("Invalid rotation")}return t}static#sa(t,e,i){const[n,s,r,a]=e;switch(i){case 0:for(let e=0,i=t.length;e<i;e+=2)t[e]-=n,t[e+1]=a-t[e+1];break;case 90:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=t[e+1]-s,t[e+1]=i-n}break;case 180:for(let e=0,i=t.length;e<i;e+=2)t[e]=r-t[e],t[e+1]-=s;break;case 270:for(let e=0,i=t.length;e<i;e+=2){const i=t[e];t[e]=a-t[e+1],t[e+1]=r-i}break;default:throw new Error("Invalid rotation")}return t}#ra(t,e,i,n){const s=[],r=this.thickness/2,a=t*e+r,o=t*i+r;for(const l of this.paths){const e=[],i=[];for(let n=0,s=l.length;n<s;n++){const[r,c,h,d]=l[n];if(r[0]===d[0]&&r[1]===d[1]&&1===s){const n=t*r[0]+a,s=t*r[1]+o;e.push(n,s),i.push(n,s);break}const u=t*r[0]+a,p=t*r[1]+o,f=t*c[0]+a,g=t*c[1]+o,m=t*h[0]+a,v=t*h[1]+o,b=t*d[0]+a,y=t*d[1]+o;0===n&&(e.push(u,p),i.push(u,p)),e.push(f,g,m,v,b,y),i.push(f,g),n===s-1&&i.push(b,y)}s.push({bezier:ts.#na(e,n,this.rotation),points:ts.#na(i,n,this.rotation)})}return s}#aa(){let t=1/0,e=-1/0,i=1/0,n=-1/0;for(const s of this.paths)for(const[r,a,o,l]of s){const s=Y.bezierBoundingBox(...r,...a,...o,...l);t=Math.min(t,s[0]),i=Math.min(i,s[1]),e=Math.max(e,s[2]),n=Math.max(n,s[3])}return[t,i,e,n]}#ea(){return this.#Mr?Math.ceil(this.thickness*this.parentScale):0}#Br(t=!1){if(this.isEmpty())return;if(!this.#Mr)return void this.#Ur();const e=this.#aa(),i=this.#ea();this.#wr=Math.max(Kt.MIN_SIZE,e[2]-e[0]),this.#Er=Math.max(Kt.MIN_SIZE,e[3]-e[1]);const n=Math.ceil(i+this.#wr*this.scaleFactor),s=Math.ceil(i+this.#Er*this.scaleFactor),[r,a]=this.parentDimensions;this.width=n/r,this.height=s/a,this.setAspectRatio(n,s);const o=this.translationX,l=this.translationY;this.translationX=-e[0],this.translationY=-e[1],this.#$r(),this.#Ur(),this.#Pr=n,this.#Or=s,this.setDims(n,s);const c=t?i/this.scaleFactor/2:0;this.translate(o-this.translationX-c,l-this.translationY-c)}static deserialize(t,e,i){if(t instanceof Nn)return null;const n=super.deserialize(t,e,i);n.thickness=t.thickness,n.color=Y.makeHexColor(...t.color),n.opacity=t.opacity;const[s,r]=n.pageDimensions,a=n.width*s,o=n.height*r,l=n.parentScale,c=t.thickness/2;n.#Mr=!0,n.#Pr=Math.round(a),n.#Or=Math.round(o);const{paths:h,rect:d,rotation:u}=t;for(let{bezier:f}of h){f=ts.#sa(f,d,u);const t=[];n.paths.push(t);let e=l*(f[0]-c),i=l*(f[1]-c);for(let n=2,r=f.length;n<r;n+=6){const s=l*(f[n]-c),r=l*(f[n+1]-c),a=l*(f[n+2]-c),o=l*(f[n+3]-c),h=l*(f[n+4]-c),d=l*(f[n+5]-c);t.push([[e,i],[s,r],[a,o],[h,d]]),e=h,i=d}const s=this.#ia(t);n.bezierPath2D.push(s)}const p=n.#aa();return n.#wr=Math.max(Kt.MIN_SIZE,p[2]-p[0]),n.#Er=Math.max(Kt.MIN_SIZE,p[3]-p[1]),n.#ta(a,o),n}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),e=Kt._colorManager.convert(this.ctx.strokeStyle);return{annotationType:p.INK,color:e,thickness:this.thickness,opacity:this.opacity,paths:this.#ra(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}class es extends Kt{#oa=null;#la=null;#ca=null;#ha=null;#da=null;#ua="";#pa=null;#Dr=null;#fa=null;#ga=!1;#ma=!1;static _type="stamp";static _editorType=p.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#ha=t.bitmapUrl,this.#da=t.bitmapFile}static initialize(t,e){Kt.initialize(t,e)}static get supportedTypes(){const t=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return D(this,"supportedTypes",t.map((t=>`image/${t}`)))}static get supportedTypesStr(){return D(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(p.STAMP,{bitmapFile:t.getAsFile()})}#va(t,e=!1){t?(this.#oa=t.bitmap,e||(this.#la=t.id,this.#ga=t.isSvg),t.file&&(this.#ua=t.file.name),this.#jr()):this.remove()}#ba(){this.#ca=null,this._uiManager.enableWaiting(!1),this.#pa&&this.div.focus()}#ya(){if(this.#la)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#la).then((t=>this.#va(t,!0))).finally((()=>this.#ba()));if(this.#ha){const t=this.#ha;return this.#ha=null,this._uiManager.enableWaiting(!0),void(this.#ca=this._uiManager.imageManager.getFromUrl(t).then((t=>this.#va(t))).finally((()=>this.#ba())))}if(this.#da){const t=this.#da;return this.#da=null,this._uiManager.enableWaiting(!0),void(this.#ca=this._uiManager.imageManager.getFromFile(t).then((t=>this.#va(t))).finally((()=>this.#ba())))}const t=document.createElement("input");t.type="file",t.accept=es.supportedTypesStr,this.#ca=new Promise((e=>{t.addEventListener("change",(async()=>{if(t.files&&0!==t.files.length){this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(t.files[0]);this.#va(e)}else this.remove();e()})),t.addEventListener("cancel",(()=>{this.remove(),e()}))})).finally((()=>this.#ba())),t.click()}remove(){this.#la&&(this.#oa=null,this._uiManager.imageManager.deleteId(this.#la),this.#pa?.remove(),this.#pa=null,this.#Dr?.disconnect(),this.#Dr=null,this.#fa&&(clearTimeout(this.#fa),this.#fa=null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#la&&null===this.#pa&&this.#ya(),this.isAttachedToDOM||this.parent.add(this))):this.#la&&this.#ya()}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#ca||this.#oa||this.#ha||this.#da||this.#la)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#oa?this.#jr():this.#ya(),this.width){const[i,n]=this.parentDimensions;this.setAt(t*i,e*n,this.width*i,this.height*n)}return this.div}#jr(){const{div:t}=this;let{width:e,height:i}=this.#oa;const[n,s]=this.pageDimensions,r=.75;if(this.width)e=this.width*n,i=this.height*s;else if(e>r*n||i>r*s){const t=Math.min(r*n/e,r*s/i);e*=t,i*=t}const[a,o]=this.parentDimensions;this.setDims(e*a/n,i*o/s),this._uiManager.enableWaiting(!1);const l=this.#pa=document.createElement("canvas");t.append(l),t.hidden=!1,this.#Aa(e,i),this.#Hr(),this.#ma||(this.parent.addUndoableEditor(this),this.#ma=!0),this._reportTelemetry({action:"inserted_image"}),this.#ua&&l.setAttribute("aria-label",this.#ua)}#_a(t,e){const[i,n]=this.parentDimensions;this.width=t/i,this.height=e/n,this.setDims(t,e),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==this.#fa&&clearTimeout(this.#fa);const s=200;this.#fa=setTimeout((()=>{this.#fa=null,this.#Aa(t,e)}),s)}#Ea(t,e){const{width:i,height:n}=this.#oa;let s=i,r=n,a=this.#oa;while(s>2*t||r>2*e){const i=s,n=r;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const o=new OffscreenCanvas(s,r),l=o.getContext("2d");l.drawImage(a,0,0,i,n,0,0,s,r),a=o.transferToImageBitmap()}return a}#Aa(t,e){t=Math.ceil(t),e=Math.ceil(e);const i=this.#pa;if(!i||i.width===t&&i.height===e)return;i.width=t,i.height=e;const n=this.#ga?this.#oa:this.#Ea(t,e);if(this._uiManager.hasMLManager&&!this.hasAltText()){const i=new OffscreenCanvas(t,e),s=i.getContext("2d");s.drawImage(n,0,0,n.width,n.height,0,0,t,e),this._uiManager.mlGuess({service:"image-to-text",request:{data:s.getImageData(0,0,t,e).data,width:t,height:e,channels:4}}).then((t=>{const e=t?.output||"";this.parent&&e&&!this.hasAltText()&&(this.altTextData={altText:e,decorative:!1})}))}const s=i.getContext("2d");s.filter=this._uiManager.hcmFilter,s.drawImage(n,0,0,n.width,n.height,0,0,t,e)}getImageForAltText(){return this.#pa}#wa(t){if(t){if(this.#ga){const t=this._uiManager.imageManager.getSvgUrl(this.#la);if(t)return t}const t=document.createElement("canvas");({width:t.width,height:t.height}=this.#oa);const e=t.getContext("2d");return e.drawImage(this.#oa,0,0),t.toDataURL()}if(this.#ga){const[t,e]=this.pageDimensions,i=Math.round(this.width*t*ht.PDF_TO_CSS_UNITS),n=Math.round(this.height*e*ht.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(i,n),r=s.getContext("2d");return r.drawImage(this.#oa,0,0,this.#oa.width,this.#oa.height,0,0,i,n),s.transferToImageBitmap()}return structuredClone(this.#oa)}#Hr(){this.#Dr=new ResizeObserver((t=>{const e=t[0].contentRect;e.width&&e.height&&this.#_a(e.width,e.height)})),this.#Dr.observe(this.div)}static deserialize(t,e,i){if(t instanceof $n)return null;const n=super.deserialize(t,e,i),{rect:s,bitmapUrl:r,bitmapId:a,isSvg:o,accessibilityData:l}=t;a&&i.imageManager.isValidId(a)?n.#la=a:n.#ha=r,n.#ga=o;const[c,h]=n.pageDimensions;return n.width=(s[2]-s[0])/c,n.height=(s[3]-s[1])/h,l&&(n.altTextData=l),n}serialize(t=!1,e=null){if(this.isEmpty())return null;const i={annotationType:p.STAMP,bitmapId:this.#la,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#ga,structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=this.#wa(!0),i.accessibilityData=this.altTextData,i;const{decorative:n,altText:s}=this.altTextData;if(!n&&s&&(i.accessibilityData={type:"Figure",alt:s}),null===e)return i;e.stamps||=new Map;const r=this.#ga?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(e.stamps.has(this.#la)){if(this.#ga){const t=e.stamps.get(this.#la);r>t.area&&(t.area=r,t.serialized.bitmap.close(),t.serialized.bitmap=this.#wa(!1))}}else e.stamps.set(this.#la,{area:r,serialized:i}),i.bitmap=this.#wa(!1);return i}}class is{#Fn;#xa=!1;#Ca=null;#Sa=null;#Ta=null;#ka=null;#Ia=null;#Ma=new Map;#La=!1;#Ra=!1;#Da=!1;#Pa=null;#I;static _initialized=!1;static#Y=new Map([Kn,ts,es,Zn].map((t=>[t._editorType,t])));constructor({uiManager:t,pageIndex:e,div:i,accessibilityManager:n,annotationLayer:s,drawLayer:r,textLayer:a,viewport:o,l10n:l}){const c=[...is.#Y.values()];if(!is._initialized){is._initialized=!0;for(const e of c)e.initialize(l,t)}t.registerEditorTypes(c),this.#I=t,this.pageIndex=e,this.div=i,this.#Fn=n,this.#Ca=s,this.viewport=o,this.#Pa=a,this.drawLayer=r,this.#I.addLayer(this)}get isEmpty(){return 0===this.#Ma.size}get isInvisible(){return this.isEmpty&&this.#I.getMode()===p.NONE}updateToolbar(t){this.#I.updateToolbar(t)}updateMode(t=this.#I.getMode()){switch(this.#Oa(),t){case p.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case p.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case p.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of is.#Y.values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#Pa?.div}addInkEditorIfNeeded(t){if(this.#I.getMode()!==p.INK)return;if(!t)for(const i of this.#Ma.values())if(i.isEmpty())return void i.setInBackground();const e=this.createAndAddNewEditor({offsetX:0,offsetY:0},!1);e.setInBackground()}setEditingState(t){this.#I.setEditingState(t)}addCommands(t){this.#I.addCommands(t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#Ca?.div.classList.toggle("disabled",!t)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of this.#Ma.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#I.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#Ca)return;const e=this.#Ca.getEditableAnnotations();for(const i of e){if(i.hide(),this.#I.isDeletedAnnotationElement(i.data.id))continue;if(t.has(i.data.id))continue;const e=this.deserialize(i);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#Da=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const n of this.#Ma.values())n.disableEditing(),n.annotationElementId&&(null===n.serialize()?(e.set(n.annotationElementId,n),this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()):t.set(n.annotationElementId,n));if(this.#Ca){const i=this.#Ca.getEditableAnnotations();for(const n of i){const{id:i}=n.data;if(this.#I.isDeletedAnnotationElement(i))continue;let s=e.get(i);s?(s.resetAnnotationElement(n),s.show(!1),n.show()):(s=t.get(i),s&&(this.#I.addChangedExistingAnnotation(s),s.renderAnnotationElement(n),s.show(!1)),n.show())}}this.#Oa(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const n of is.#Y.values())i.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#Da=!1}getEditableAnnotation(t){return this.#Ca?.getEditableAnnotation(t)||null}setActiveEditor(t){const e=this.#I.getActive();e!==t&&this.#I.setActiveEditor(t)}enableTextSelection(){this.div.tabIndex=-1,this.#Pa?.div&&!this.#ka&&(this.#ka=this.#Fa.bind(this),this.#Pa.div.addEventListener("pointerdown",this.#ka),this.#Pa.div.classList.add("highlighting"))}disableTextSelection(){this.div.tabIndex=0,this.#Pa?.div&&this.#ka&&(this.#Pa.div.removeEventListener("pointerdown",this.#ka),this.#ka=null,this.#Pa.div.classList.remove("highlighting"))}#Fa(t){if(this.#I.unselectAll(),t.target===this.#Pa.div){const{isMac:e}=q.platform;if(0!==t.button||t.ctrlKey&&e)return;this.#I.showAllEditors("highlight",!0,!0),this.#Pa.div.classList.add("free"),Zn.startHighlighting(this,"ltr"===this.#I.direction,t),this.#Pa.div.addEventListener("pointerup",(()=>{this.#Pa.div.classList.remove("free")}),{once:!0}),t.preventDefault()}}enableClick(){this.#Ta||(this.#Ta=this.pointerdown.bind(this),this.#Sa=this.pointerup.bind(this),this.div.addEventListener("pointerdown",this.#Ta),this.div.addEventListener("pointerup",this.#Sa))}disableClick(){this.#Ta&&(this.div.removeEventListener("pointerdown",this.#Ta),this.div.removeEventListener("pointerup",this.#Sa),this.#Ta=null,this.#Sa=null)}attach(t){this.#Ma.set(t.id,t);const{annotationElementId:e}=t;e&&this.#I.isDeletedAnnotationElement(e)&&this.#I.removeDeletedAnnotationElement(t)}detach(t){this.#Ma.delete(t.id),this.#Fn?.removePointerInTextLayer(t.contentDiv),!this.#Da&&t.annotationElementId&&this.#I.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#I.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,this.#Ra||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#I.addDeletedAnnotationElement(t.annotationElementId),Kt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),this.#I.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),this.#I.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#Ia&&(t._focusEventsAllowed=!1,this.#Ia=setTimeout((()=>{this.#Ia=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",(()=>{t._focusEventsAllowed=!0}),{once:!0}),e.focus())}),0)),t._structTreeParentId=this.#Fn?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return this.#I.getId()}get#Na(){return is.#Y.get(this.#I.getMode())}#Ba(t){const e=this.#Na;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#Na?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#I.updateToolbar(t),this.#I.updateMode(t);const{offsetX:i,offsetY:n}=this.#Ua(),s=this.getNextId(),r=this.#Ba({parent:this,id:s,x:i,y:n,uiManager:this.#I,isCentered:!0,...e});r&&this.add(r)}deserialize(t){return is.#Y.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#I)||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),s=this.#Ba({parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:this.#I,isCentered:e,...i});return s&&this.add(s),s}#Ua(){const{x:t,y:e,width:i,height:n}=this.div.getBoundingClientRect(),s=Math.max(0,t),r=Math.max(0,e),a=Math.min(window.innerWidth,t+i),o=Math.min(window.innerHeight,e+n),l=(s+a)/2-t,c=(r+o)/2-e,[h,d]=this.viewport.rotation%180===0?[l,c]:[c,l];return{offsetX:h,offsetY:d}}addNewEditor(){this.createAndAddNewEditor(this.#Ua(),!0)}setSelected(t){this.#I.setSelected(t)}toggleSelected(t){this.#I.toggleSelected(t)}isSelected(t){return this.#I.isSelected(t)}unselect(t){this.#I.unselect(t)}pointerup(t){const{isMac:e}=q.platform;0!==t.button||t.ctrlKey&&e||t.target===this.div&&this.#La&&(this.#La=!1,this.#xa?this.#I.getMode()!==p.STAMP?this.createAndAddNewEditor(t,!1):this.#I.unselectAll():this.#xa=!0)}pointerdown(t){if(this.#I.getMode()===p.HIGHLIGHT&&this.enableTextSelection(),this.#La)return void(this.#La=!1);const{isMac:e}=q.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;this.#La=!0;const i=this.#I.getActive();this.#xa=!i||i.isEmpty()}findNewParent(t,e,i){const n=this.#I.findParent(e,i);return null!==n&&n!==this&&(n.changeParent(t),!0)}destroy(){this.#I.getActive()?.parent===this&&(this.#I.commitOrRemove(),this.#I.setActiveEditor(null)),this.#Ia&&(clearTimeout(this.#Ia),this.#Ia=null);for(const t of this.#Ma.values())this.#Fn?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#Ma.clear(),this.#I.removeLayer(this)}#Oa(){this.#Ra=!0;for(const t of this.#Ma.values())t.isEmpty()&&t.remove();this.#Ra=!1}render({viewport:t}){this.viewport=t,Pt(this.div,t);for(const e of this.#I.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#I.commitOrRemove(),this.#Oa();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Pt(this.div,{rotation:i}),e!==i)for(const n of this.#Ma.values())n.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#I.viewParameters.realScale}}class ns{#mn=null;#o=0;#ja=new Map;#Ha=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(this.#mn){if(this.#mn!==t){if(this.#ja.size>0)for(const e of this.#ja.values())e.remove(),t.append(e);this.#mn=t}}else this.#mn=t}static get _svgFactory(){return D(this,"_svgFactory",new mt)}static#$a(t,{x:e=0,y:i=0,width:n=1,height:s=1}={}){const{style:r}=t;r.top=100*i+"%",r.left=100*e+"%",r.width=100*n+"%",r.height=100*s+"%"}#za(t){const e=ns._svgFactory.create(1,1,!0);return this.#mn.append(e),e.setAttribute("aria-hidden",!0),ns.#$a(e,t),e}#Va(t,e){const i=ns._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const s=ns._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),n}highlight(t,e,i,n=!1){const s=this.#o++,r=this.#za(t.box);r.classList.add("highlight"),t.free&&r.classList.add("free");const a=ns._svgFactory.createElement("defs");r.append(a);const o=ns._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("d",t.toSVGPath()),n&&this.#Ha.set(s,o);const c=this.#Va(a,l),h=ns._svgFactory.createElement("use");return r.append(h),r.setAttribute("fill",e),r.setAttribute("fill-opacity",i),h.setAttribute("href",`#${l}`),this.#ja.set(s,r),{id:s,clipPathId:`url(#${c})`}}highlightOutline(t){const e=this.#o++,i=this.#za(t.box);i.classList.add("highlightOutline");const n=ns._svgFactory.createElement("defs");i.append(n);const s=ns._svgFactory.createElement("path");n.append(s);const r=`path_p${this.pageIndex}_${e}`;let a;if(s.setAttribute("id",r),s.setAttribute("d",t.toSVGPath()),s.setAttribute("vector-effect","non-scaling-stroke"),t.free){i.classList.add("free");const t=ns._svgFactory.createElement("mask");n.append(t),a=`mask_p${this.pageIndex}_${e}`,t.setAttribute("id",a),t.setAttribute("maskUnits","objectBoundingBox");const s=ns._svgFactory.createElement("rect");t.append(s),s.setAttribute("width","1"),s.setAttribute("height","1"),s.setAttribute("fill","white");const o=ns._svgFactory.createElement("use");t.append(o),o.setAttribute("href",`#${r}`),o.setAttribute("stroke","none"),o.setAttribute("fill","black"),o.setAttribute("fill-rule","nonzero"),o.classList.add("mask")}const o=ns._svgFactory.createElement("use");i.append(o),o.setAttribute("href",`#${r}`),a&&o.setAttribute("mask",`url(#${a})`);const l=o.cloneNode();return i.append(l),o.classList.add("mainOutline"),l.classList.add("secondaryOutline"),this.#ja.set(e,i),e}finalizeLine(t,e){const i=this.#Ha.get(t);this.#Ha.delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){const i=this.#ja.get(t),n=i.firstChild,s=n.firstChild;s.setAttribute("d",e.toSVGPath())}removeFreeHighlight(t){this.remove(t),this.#Ha.delete(t)}updatePath(t,e){this.#Ha.get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){ns.#$a(this.#ja.get(t),e)}show(t,e){this.#ja.get(t).classList.toggle("hidden",!e)}rotate(t,e){this.#ja.get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){this.#ja.get(t).setAttribute("fill",e)}changeOpacity(t,e){this.#ja.get(t).setAttribute("fill-opacity",e)}addClass(t,e){this.#ja.get(t).classList.add(e)}removeClass(t,e){this.#ja.get(t).classList.remove(e)}remove(t){null!==this.#mn&&(this.#ja.get(t).remove(),this.#ja.delete(t))}destroy(){this.#mn=null;for(const t of this.#ja.values())t.remove();this.#ja.clear()}}s.AbortException,s.AnnotationEditorLayer,s.AnnotationEditorParamsType,s.AnnotationEditorType,s.AnnotationEditorUIManager,s.AnnotationLayer,s.AnnotationMode,s.CMapCompressionType,s.ColorPicker,s.DOMSVGFactory,s.DrawLayer,s.FeatureTest;var ss=s.GlobalWorkerOptions,rs=(s.ImageKind,s.InvalidPDFException,s.MissingPDFException,s.OPS,s.Outliner,s.PDFDataRangeTransport,s.PDFDateString,s.PDFWorker,s.PasswordResponses,s.PermissionFlag,s.PixelsPerInch,s.RenderingCancelledException,s.TextLayer,s.UnexpectedResponseException,s.Util,s.VerbosityLevel,s.XfaLayer,s.build,s.createValidAbsoluteUrl,s.fetchData,s.getDocument);s.getFilenameFromUrl,s.getPdfFilenameFromUrl,s.getXfaPageViewport,s.isDataScheme,s.isPdfFile,s.noContextMenu,s.normalizeUnicode,s.renderTextLayer,s.setLayerDimensions,s.shadow,s.updateTextLayer,s.version;"undefined"!==typeof window&&"Worker"in window&&(ss.workerPort=new Worker(new URL(i.p+i.u(332),i.b),{type:void 0}))},5220:function(t,e,i){i.d(e,{rd:function(){return _}});var n=i(641),s=i(953);Object.assign;const r=()=>{},a=Array.isArray;function o(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function l(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!c(t[i],e[i]))return!1;return!0}function c(t,e){return a(t)?h(t,e):a(e)?h(e,t):t===e}function h(t,e){return a(e)?t.length===e.length&&t.every(((t,i)=>t===e[i])):1===t.length&&t[0]===e}var d,u;(function(t){t["pop"]="pop",t["push"]="push"})(d||(d={})),function(t){t["back"]="back",t["forward"]="forward",t["unknown"]=""}(u||(u={}));new Map;Symbol("");var p;(function(t){t[t["aborted"]=4]="aborted",t[t["cancelled"]=8]="cancelled",t[t["duplicated"]=16]="duplicated"})(p||(p={}));Symbol(""),Symbol("");const f=Symbol(""),g=Symbol("");Symbol("");function m(t){const e=(0,n.WQ)(f),i=(0,n.WQ)(g);const a=(0,n.EW)((()=>{const i=(0,s.R1)(t.to);return e.resolve(i)})),c=(0,n.EW)((()=>{const{matched:t}=a.value,{length:e}=t,n=t[e-1],s=i.matched;if(!n||!s.length)return-1;const r=s.findIndex(o.bind(null,n));if(r>-1)return r;const l=y(t[e-2]);return e>1&&y(n)===l&&s[s.length-1].path!==l?s.findIndex(o.bind(null,t[e-2])):r})),h=(0,n.EW)((()=>c.value>-1&&b(i.params,a.value.params))),d=(0,n.EW)((()=>c.value>-1&&c.value===i.matched.length-1&&l(i.params,a.value.params)));function u(i={}){return v(i)?e[(0,s.R1)(t.replace)?"replace":"push"]((0,s.R1)(t.to)).catch(r):Promise.resolve()}return{route:a,href:(0,n.EW)((()=>a.value.href)),isActive:h,isExactActive:d,navigate:u}}Boolean,Boolean;function v(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&(void 0===t.button||0===t.button)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function b(t,e){for(const i in e){const n=e[i],s=t[i];if("string"===typeof n){if(n!==s)return!1}else if(!a(s)||s.length!==n.length||n.some(((t,e)=>t!==s[e])))return!1}return!0}function y(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const A=(t,e,i)=>null!=t?t:null!=e?e:i;function _(){return(0,n.WQ)(f)}}}]);
//# sourceMappingURL=chunk-vendors.638ada58.js.map